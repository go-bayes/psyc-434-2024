<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.523">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Joseph Bulbulia">

<title>PSYC 434 Conducting Research Across Cultures: Trimester 1, 2023 - Temporal Causal Diagrams: Unveiling Causal Order and Indexing Nodes by Time</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">PSYC 434 Conducting Research Across Cultures: Trimester 1, 2023</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-content" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Content</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-content">    
        <li>
    <a class="dropdown-item" href="../content/common_graphs.html">
 <span class="dropdown-text">Background: Causal Graphs</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/measurement_error.qmd">
 <span class="dropdown-text">Background: Causal Graphs: Measurement Error</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/index.html">
 <span class="dropdown-text">Preliminaries</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/01-content.html">
 <span class="dropdown-text">1: Asking questions in cross-cultural psychology</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/02-content.html">
 <span class="dropdown-text">2: Getting started with R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/03-content.html">
 <span class="dropdown-text">3: Lost in Translation? Measurement and Language</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/04-content.html">
 <span class="dropdown-text">4: Dealing with Data (Factor Analysis)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/05-content.html">
 <span class="dropdown-text">5: Dealing with Data (Multi-Group CFA)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/06-content.html">
 <span class="dropdown-text">6: Dealing with Data (Partial Invariance)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/07-content.html">
 <span class="dropdown-text">7: Causal Inference: Causal Graphs</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/08-content.html">
 <span class="dropdown-text">8: Causal Inference: Causal Effects</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/09-content.html">
 <span class="dropdown-text">9: Causal inference: Causal Estimation I</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/10-content.html">
 <span class="dropdown-text">10: Causal Inference: Causal Estimation II</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/11-content.html">
 <span class="dropdown-text">11: Reconsidering Measurement from a Causal Perspective</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/12-content.html">
 <span class="dropdown-text">12: Template for Report</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Temporal Causal Diagrams: Unveiling Causal Order and Indexing Nodes by Time</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Joseph Bulbulia </p>
            </div>
    </div>
      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#common-causal-graphs" id="toc-common-causal-graphs" class="nav-link active" data-scroll-target="#common-causal-graphs">Common Causal Graphs</a>
  <ul class="collapse">
  <li><a href="#elements-of-causal-dags" id="toc-elements-of-causal-dags" class="nav-link" data-scroll-target="#elements-of-causal-dags">Elements of causal DAGs:</a></li>
  <li><a href="#assumption-of-causal-diagrammes" id="toc-assumption-of-causal-diagrammes" class="nav-link" data-scroll-target="#assumption-of-causal-diagrammes">Assumption of causal diagrammes</a></li>
  </ul></li>
  <li><a href="#elemental-counfounds" id="toc-elemental-counfounds" class="nav-link" data-scroll-target="#elemental-counfounds">Elemental counfounds</a>
  <ul class="collapse">
  <li><a href="#the-problem-of-confounding-by-common-cause" id="toc-the-problem-of-confounding-by-common-cause" class="nav-link" data-scroll-target="#the-problem-of-confounding-by-common-cause">1. The problem of confounding by common cause</a></li>
  <li><a href="#advice-attend-to-the-temporal-order-of-cauasality" id="toc-advice-attend-to-the-temporal-order-of-cauasality" class="nav-link" data-scroll-target="#advice-attend-to-the-temporal-order-of-cauasality">Advice: attend to the temporal order of cauasality</a></li>
  <li><a href="#confounding-by-collider-stratification-conditioning-on-a-common-effect" id="toc-confounding-by-collider-stratification-conditioning-on-a-common-effect" class="nav-link" data-scroll-target="#confounding-by-collider-stratification-conditioning-on-a-common-effect">2. Confounding by collider stratification (conditioning on a common effect)</a></li>
  <li><a href="#advice-attend-to-the-temporal-order-of-cauasality-1" id="toc-advice-attend-to-the-temporal-order-of-cauasality-1" class="nav-link" data-scroll-target="#advice-attend-to-the-temporal-order-of-cauasality-1">Advice: attend to the temporal order of cauasality</a></li>
  <li><a href="#m-bias-conditioning-on-a-collider-that-occurs-before-the-exposure-may-introduce-bias" id="toc-m-bias-conditioning-on-a-collider-that-occurs-before-the-exposure-may-introduce-bias" class="nav-link" data-scroll-target="#m-bias-conditioning-on-a-collider-that-occurs-before-the-exposure-may-introduce-bias">M-bias: conditioning on a collider that occurs before the exposure may introduce bias</a></li>
  <li><a href="#the-problem-of-conditioning-on-a-mediator" id="toc-the-problem-of-conditioning-on-a-mediator" class="nav-link" data-scroll-target="#the-problem-of-conditioning-on-a-mediator">3 The problem of conditioning on a mediator</a></li>
  <li><a href="#advice-attend-to-the-temporal-order-of-cauasality-2" id="toc-advice-attend-to-the-temporal-order-of-cauasality-2" class="nav-link" data-scroll-target="#advice-attend-to-the-temporal-order-of-cauasality-2">Advice: attend to the temporal order of cauasality</a></li>
  <li><a href="#conditioning-on-a-descendant" id="toc-conditioning-on-a-descendant" class="nav-link" data-scroll-target="#conditioning-on-a-descendant">4. Conditioning on a descendant</a></li>
  <li><a href="#advice-attend-to-the-temporal-order-of-causality-and-use-expert-knowledge-of-all-relevant-nodes." id="toc-advice-attend-to-the-temporal-order-of-causality-and-use-expert-knowledge-of-all-relevant-nodes." class="nav-link" data-scroll-target="#advice-attend-to-the-temporal-order-of-causality-and-use-expert-knowledge-of-all-relevant-nodes.">Advice: attend to the temporal order of causality, and use expert knowledge of all relevant nodes.</a></li>
  <li><a href="#causal-interaction" id="toc-causal-interaction" class="nav-link" data-scroll-target="#causal-interaction">Causal Interaction?</a></li>
  <li><a href="#advice-for-causal-mediation" id="toc-advice-for-causal-mediation" class="nav-link" data-scroll-target="#advice-for-causal-mediation">Advice for causal mediation</a></li>
  <li><a href="#advice-for-modelling-repeated-exposures-in-longitudinal-data-confounder-treatment-feedback" id="toc-advice-for-modelling-repeated-exposures-in-longitudinal-data-confounder-treatment-feedback" class="nav-link" data-scroll-target="#advice-for-modelling-repeated-exposures-in-longitudinal-data-confounder-treatment-feedback">Advice for modelling repeated exposures in longitudinal data (confounder-treatment feedback)?</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="common-causal-graphs" class="level2">
<h2 class="anchored" data-anchor-id="common-causal-graphs">Common Causal Graphs</h2>
<section id="elements-of-causal-dags" class="level3">
<h3 class="anchored" data-anchor-id="elements-of-causal-dags">Elements of causal DAGs:</h3>
<section id="nodes-these-symbolize-variables-within-a-causal-system.-we-denote-nodes-with-letters-such-as" class="level4">
<h4 class="anchored" data-anchor-id="nodes-these-symbolize-variables-within-a-causal-system.-we-denote-nodes-with-letters-such-as"><strong>Nodes:</strong> These symbolize variables within a causal system. We denote nodes with letters such as</h4>
<p><span class="math display">
A, ~ Y
</span></p>
</section>
<section id="edges-or-vertices-these-are-arrows-connecting-nodes-signifying-causal-relationships.-we-denote-edges-with-arrows" class="level4">
<h4 class="anchored" data-anchor-id="edges-or-vertices-these-are-arrows-connecting-nodes-signifying-causal-relationships.-we-denote-edges-with-arrows"><strong>Edges or Vertices:</strong> These are arrows connecting nodes, signifying causal relationships. We denote edges with arrows:</h4>
<p><span class="math display">
   A \to Y
</span></p>
</section>
<section id="variable-naming-conventions" class="level4">
<h4 class="anchored" data-anchor-id="variable-naming-conventions"><strong>Variable Naming Conventions</strong></h4>
<p><strong>Outcome</strong>: typically denoted by <span class="math inline">Y</span>. The effect or outcome of interest. Do not attempt to draw a causal DAG unless this outcome is clearly defined. <strong>Exposure or Treatment</strong>: typically denoted by <span class="math inline">A</span> or <span class="math inline">X</span>. The intervention. Do not attempt to draw a causal DAG unless the exposure is a clearly defined and does not violate deterministic non-positivity. <strong>Confounders</strong>: typically denoted by <span class="math inline">C</span> or <span class="math inline">L</span>. Informally the variables influencing both the exposure/treatment and the outcome. Or more formally: <strong>Unmeasured Confounders</strong>: typically denoted by <span class="math inline">U</span>: <strong>Selection Variables</strong>: typically denoted by <span class="math inline">U</span>: Variables affecting a unit’s inclusion in the study (including retention in the study). <strong>Box</strong>: denotes conditioning on a variable. For example, to denote selection into the study we write</p>
<p><span class="math display">\framebox{S}</span></p>
<p>To denote conditioning on a confounder set <span class="math inline">L</span> we write</p>
<p><span class="math display">\framebox{L}</span></p>
</section>
<section id="key-concepts" class="level4">
<h4 class="anchored" data-anchor-id="key-concepts"><strong>Key Concepts</strong></h4>
<ul>
<li><strong>Markov Factorisation:</strong> Pertains to a causal DAG in which the joint distribution of all nodes can be expressed as a product of conditional distributions. Each variable is conditionally independent of its non-descendants, given its parents. This is crucial for identifying conditional independencies within the graph.</li>
<li><strong>D-separation (direction separation):</strong> Pertains to a condition in which there is no path between some sets of variables in the graph, given the conditioned variables. Establishing d-separation allows us to infer conditional independencies, which in turn help identify the set of measured variables we need to adjust for to obtain an unbiased estimate of the causal effect, or in the presence of unmeasured or partially measured confounders, to reduce bias.</li>
</ul>
</section>
</section>
<section id="assumption-of-causal-diagrammes" class="level3">
<h3 class="anchored" data-anchor-id="assumption-of-causal-diagrammes">Assumption of causal diagrammes</h3>
<section id="causal-markov-condition" class="level4">
<h4 class="anchored" data-anchor-id="causal-markov-condition"><strong>Causal Markov Condition</strong></h4>
<p>The <strong>Causal Markov Condition</strong> is an assumption that each variable is independent of its non-descendants, given its parents in the graph. In other words, it assumes that all dependencies between variables are mediated by direct causal relationships. If two variables are correlated, it must be because one causes the other, or they have a shared cause, not because of any unmeasured confounding variables.</p>
<p>Formally, for each variable <span class="math inline">X</span> in the graph, <span class="math inline">X</span> is independent of its non-descendants NonDesc(<span class="math inline">X</span>), given its parents Pa(<span class="math inline">X</span>).</p>
<p>This is strong assumption. Typically we must assume that there are hidden, unmeasured confounders that introduce dependencies between variables, which are not depicted in the graph. **It is important to (1) identify known unmeasured confounders and (2) label them on the the causal diagramme.</p>
</section>
<section id="faithfulness" class="level4">
<h4 class="anchored" data-anchor-id="faithfulness"><strong>Faithfulness</strong></h4>
<p>The <strong>Faithfulness</strong> assumption is the inverse to the Causal Markov Condition. It states that if two variables are uncorrelated, it is because there is no direct or indirect causal path between them, not because of any cancelling out of effects. Essentially, it assumes that the relationships in your data are stable and consistent, and will not change if you intervene to change some of the variables.</p>
<p>Formally, if <span class="math inline">A</span> and <span class="math inline">Y</span> are independent given a set of variables <span class="math inline">L</span>, then there does not exist a set of edges between <span class="math inline">A</span> and <span class="math inline">Y</span> that remains after conditioning on <span class="math inline">L</span>.</p>
<p>As with the <em>Causal Markov Condition</em>, <em>Faithfulness</em> is a strong assumption, and it might not typically hold in the real world. There could be complex causal structures or interactions that lead to apparent independence between variables, even though they are causally related.</p>
</section>
<section id="general-advice-for-drawing-a-causal-dag" class="level4">
<h4 class="anchored" data-anchor-id="general-advice-for-drawing-a-causal-dag">General Advice for drawing a causal DAG</h4>
<ul>
<li>Define all variables clearly.</li>
<li>Define any novel conventions you employ. This could include dotted or coloured arrows to indicate confounding that is induced, or unaddressed (as below)</li>
<li>Adopt minimalism. Include only those nodes and edges that are needed to clarify the problem. Use diagrams only when they bring more clarity than textual descriptions alone.</li>
<li>Chronological order. Where possible maintain temporal order of the nodes in the spatial order of the graph. Typically from left to right or top to bottom. When depicting repeated measures, index them using time subscripts:</li>
<li>Add time-stamps to your nodes. To bring additoinal clarity, it is almost always useful to time-stamp the nodes of your graph, for example, in schematic form:</li>
</ul>
<p><span class="math display">
L_{t0} \rightarrow A_{t1} \rightarrow Y_{t2}
</span></p>
<ul>
<li>Where exposures are not assigned randomly, we should nearly always assume unmeasured confounding. For this reason, your causal DAG should include a description of the sensitivity analyses you will perform to clarify the sensitivity of your findings to unmeasured confounding. Where there are known unmeasured confounders these should be described.</li>
</ul>
<p>Recall that DAGs are qualitative representations. The stamps need not defined clearly defined units of time. Rather time stamps should preserve chronological order.</p>
</section>
</section>
</section>
<section id="elemental-counfounds" class="level2">
<h2 class="anchored" data-anchor-id="elemental-counfounds">Elemental counfounds</h2>
<p>There are four elemental confounds <span class="citation" data-cites="mcelreath2020">[@mcelreath2020 p.185]</span>. Consider how chronological consciensciousness assists with understanding both constraints on data.</p>
<section id="the-problem-of-confounding-by-common-cause" class="level3">
<h3 class="anchored" data-anchor-id="the-problem-of-confounding-by-common-cause">1. The problem of confounding by common cause</h3>
<p>The problem of confounding by common cause arises when there is a variable denoted by <span class="math inline">L</span> that influences both the exposure, denoted by <span class="math inline">A</span> and the outcome variable, denoted by <span class="math inline">Y.</span> Because <span class="math inline">L</span> is a common cause of <span class="math inline">A</span> and <span class="math inline">L</span> is may create a statistical association between <span class="math inline">A</span> and <span class="math inline">Y</span> that does not reflect a causal association between <span class="math inline">A</span> and <span class="math inline">Y</span>. Put differently, although intervening on <span class="math inline">A</span> might not affect <span class="math inline">Y</span>, <span class="math inline">A</span> and <span class="math inline">Y</span> may be associated. For example, people who smoke may have yellow fingers. Smoking causes cancer. Because smoking (<span class="math inline">L</span>) is a common cause of yellow fingers (<span class="math inline">A</span>) and cancer (<span class="math inline">Y</span>), <span class="math inline">A</span> and <span class="math inline">Y</span> will be associated. However, intervening to change the colour of people’s fingers would not affect cancer. The dashed red arrow in the graph indicate bias arising from the open backdoor path from <span class="math inline">A</span> to <span class="math inline">Y</span> that results from the common cause <span class="math inline">L</span>.”</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-dag-common-cause" class="quarto-figure quarto-figure-center anchored" width="80%">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dag-common-cause-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="common_graphs_files/figure-html/fig-dag-common-cause-1.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dag-common-cause-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Counfounding by common cause. The dashed red arrow indicates bias arising from the open backdoor path from A to Y.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="advice-attend-to-the-temporal-order-of-cauasality" class="level3">
<h3 class="anchored" data-anchor-id="advice-attend-to-the-temporal-order-of-cauasality">Advice: attend to the temporal order of cauasality</h3>
<p>Confounding by a common cause can be addressed by adjusting for it. Typically we adjust through through statistical models such as regression, matching, or inverse probability of treatment weighting. Again, it is beyond the scope of this tutorial to describe causal estimation techniques. Figure <a href="#fig-dag-common-cause-solution" class="quarto-xref">Figure&nbsp;2</a> clarifies that any confounding that is a cause of <span class="math inline">A</span> and <span class="math inline">Y</span> will precede <span class="math inline">A</span> (and so <span class="math inline">Y</span>), because causes precede effects. By indexing the the nodes on the graph, we can see that confounding control typically requires time-series data.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-dag-common-cause-solution" class="quarto-figure quarto-figure-center anchored" width="80%">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dag-common-cause-solution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="common_graphs_files/figure-html/fig-dag-common-cause-solution-1.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dag-common-cause-solution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Solution: adjust for pre-exposure confounder.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="confounding-by-collider-stratification-conditioning-on-a-common-effect" class="level3">
<h3 class="anchored" data-anchor-id="confounding-by-collider-stratification-conditioning-on-a-common-effect">2. Confounding by collider stratification (conditioning on a common effect)</h3>
<p>Conditioning on a common effect occurs when a variable <span class="math inline">L</span> is affected by both the treatment <span class="math inline">A</span> and an outcome <span class="math inline">Y</span>.</p>
<p>Suppose <span class="math inline">A</span> and <span class="math inline">Y</span> are initially independent, such that <span class="math inline">A \coprod Y(a)</span>. Conditioning on the common effect <span class="math inline">L</span> opens a backdoor path between <span class="math inline">A</span> and <span class="math inline">Y</span>, possibly inducing an association. This occurs because <span class="math inline">L</span> gives information about the relationship of <span class="math inline">A</span> and <span class="math inline">Y</span>. Here’s an example:</p>
<p>Let <span class="math inline">A</span> denote “exercise”. Let <span class="math inline">Y</span> denote “heart disease”. Let <span class="math inline">L</span> denote “weight”. Suppose, “exercise” and “heart disease” are not causally linked. However, they both affect “weight”, and if we condition on “weight” in a cross-sectional study, we might find a statistical association between “exercise” and “heart disease” even in the absence of causation.</p>
<p>We denote the observed associations as follows:</p>
<ul>
<li><span class="math inline">P(A = 1)</span>: Probability of exercising</li>
<li><span class="math inline">P(Y = 1)</span>: Probability of having heart disease</li>
<li><span class="math inline">P(L = 1)</span>: Probability of being overweight</li>
</ul>
<p>Without conditioning on <span class="math inline">L</span>, we have:</p>
<p><span class="math display">P(A = 1, Y = 1) = P(A = 1)P(Y = 1)</span></p>
<p>However, if we condition on <span class="math inline">L</span> (thecommon effect of both <span class="math inline">A</span> and <span class="math inline">Y</span>), we find:</p>
<p><span class="math display">P(A = 1, Y = 1 | L = 1) \neq P(A = 1 | L = 1)P(Y = 1 | L = 1)</span></p>
<p>The common effect <span class="math inline">L</span>, once conditioned on, creates a non-causal association between <span class="math inline">A</span> and <span class="math inline">Y</span>. This can mislead us into believing there’s a direct link between exercise and heart disease, which is not the case. In the cross-sectional data, if we only observe <span class="math inline">A</span>, <span class="math inline">Y</span>, and <span class="math inline">L</span> without understanding their causal relationship, we might erroneously conclude that there is a causal relationship between <span class="math inline">A</span> and <span class="math inline">Y</span>. This is the collider stratification bias.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-dag-common-effect" class="quarto-figure quarto-figure-center anchored" width="80%">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dag-common-effect-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="common_graphs_files/figure-html/fig-dag-common-effect-1.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dag-common-effect-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Confounding by conditioning on a collider.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="advice-attend-to-the-temporal-order-of-cauasality-1" class="level3">
<h3 class="anchored" data-anchor-id="advice-attend-to-the-temporal-order-of-cauasality-1">Advice: attend to the temporal order of cauasality</h3>
<p>To address the problem of conditioning on a common effect, we should generally ensure that all confounders <span class="math inline">L</span> that are common causes of the exposure <span class="math inline">A</span> and the outcome <span class="math inline">Y</span> are measured before the occurance of the exposure <span class="math inline">A</span>, and furthermore that the exposure <span class="math inline">A</span> is measured before the occurance of the outcome <span class="math inline">Y</span>. If such temporal order is preserved, <span class="math inline">L</span> cannot be an effect of <span class="math inline">A</span>, and thus neither of <span class="math inline">Y</span>. By measuring all relevant confounders before the exposure, researchers can minimise the scope for collider confounding by conditioning on a common effect. This rule is not absolute. As indicated in <a href="#fig-dag-descendent-solution" class="quarto-xref">Figure&nbsp;9</a>, it may be useful in certain circumstances to condition on a confounder that occurs after the outcome has occurred.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-dag-common-effect-solution" class="quarto-figure quarto-figure-center anchored" width="80%">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dag-common-effect-solution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="common_graphs_files/figure-html/fig-dag-common-effect-solution-1.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dag-common-effect-solution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Solution: avoid colliders
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="m-bias-conditioning-on-a-collider-that-occurs-before-the-exposure-may-introduce-bias" class="level3">
<h3 class="anchored" data-anchor-id="m-bias-conditioning-on-a-collider-that-occurs-before-the-exposure-may-introduce-bias">M-bias: conditioning on a collider that occurs before the exposure may introduce bias</h3>
<p>Typically, confounders should be measured before their exposures. However, researchers should be cautious about conditioning on pre-exposure variable, as doing so can induce confounding. As shown in <a href="#fig-m-bias" class="quarto-xref">Figure&nbsp;5</a>, collider stratification may arise even if <span class="math inline">L</span> occurs before <span class="math inline">A</span>. This happens when <span class="math inline">L</span> does not affect <span class="math inline">A</span> or <span class="math inline">Y</span>, but may be the descendent of a unmeasured variable that affects <span class="math inline">A</span> and another unmeasured variable that also affects <span class="math inline">Y</span>. Conditioning on <span class="math inline">L</span> in this scenario elicits what is called “M-bias.” Note, however, that if <span class="math inline">L</span> is not a common cause of <span class="math inline">A</span> and <span class="math inline">Y</span>, <span class="math inline">L</span> should not be included in our model because it is not a source of confounding. Here, <span class="math inline">A \coprod Y(a)</span> and <span class="math inline">A \cancel{\coprod} Y(a)| L</span>. The solution: do not condition on the pre-exposure variable <span class="math inline">L</span>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-m-bias" class="quarto-figure quarto-figure-center anchored" width="80%">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-m-bias-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="common_graphs_files/figure-html/fig-m-bias-1.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-m-bias-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: M-bias: confounding control by including previous measures of the outcome
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="the-problem-of-conditioning-on-a-mediator" class="level3">
<h3 class="anchored" data-anchor-id="the-problem-of-conditioning-on-a-mediator">3 The problem of conditioning on a mediator</h3>
<p>Conditioning on a mediator occurs when <span class="math inline">L</span> lies on the causal pathway between the treatment <span class="math inline">A</span> and the outcome <span class="math inline">Y</span>. Conditioning on <span class="math inline">L</span> can lead to biased estimates by blocking or distorting the total effect of <span class="math inline">A</span> and <span class="math inline">Y</span>. Where <span class="math inline">L</span> is a mediator, including <span class="math inline">L</span> will typically attenuate the effect of <span class="math inline">A</span> on <span class="math inline">Y</span>. This scenario is presented in <a href="#fig-dag-mediator" class="quarto-xref">Figure&nbsp;6</a>. Where <span class="math inline">L</span> is a collider between <span class="math inline">A</span> and an unmeasured confouder <span class="math inline">U</span>, then including <span class="math inline">L</span> may increase the strength of association between <span class="math inline">A</span> and <span class="math inline">Y</span>. This scenario is presented in <a href="#fig-dag-descendent" class="quarto-xref">Figure&nbsp;8</a>.</p>
<p>In either case, unless one is interested in mediation analysis, conditioning on a post-treatment variable is nearly always a bad idea.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-dag-mediator" class="quarto-figure quarto-figure-center anchored" width="80%">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dag-mediator-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="common_graphs_files/figure-html/fig-dag-mediator-1.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dag-mediator-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Confounding by a mediator.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="advice-attend-to-the-temporal-order-of-cauasality-2" class="level3">
<h3 class="anchored" data-anchor-id="advice-attend-to-the-temporal-order-of-cauasality-2">Advice: attend to the temporal order of cauasality</h3>
<p>To address the problem of mediator bias, when interested in total effects do not condition on a mediator. This can be done by ensuring that <span class="math inline">L</span> occurs before <span class="math inline">A</span> (and <span class="math inline">Y</span>). Again we discover the importance of an explicit temporal ordering for our variables. Although note, if <span class="math inline">L</span> is associated with <span class="math inline">Y</span> but is not associated with <span class="math inline">A</span> conditioning on <span class="math inline">L</span> will improve the efficiency of the causal effect estimate of <span class="math inline">A</span> on <span class="math inline">Y</span>. However, if <span class="math inline">A</span> might affect <span class="math inline">L</span>, then <span class="math inline">L</span> might be a mediator, and including <span class="math inline">L</span> risks bias. As with some much in causal estimation, we must understand the context.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-dag-mediator-solution" class="quarto-figure quarto-figure-center anchored" width="80%">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dag-mediator-solution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="common_graphs_files/figure-html/fig-dag-mediator-solution-1.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dag-mediator-solution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Ensure confounders occur before exposures.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="conditioning-on-a-descendant" class="level3">
<h3 class="anchored" data-anchor-id="conditioning-on-a-descendant">4. Conditioning on a descendant</h3>
<p>Say <span class="math inline">X</span> is a cause of <span class="math inline">X\prime</span>. If we condition on X we partially condition on <span class="math inline">X\prime</span>.</p>
<p>There are both negative and positive implications for causal estimation in real-world scenarios.</p>
<p>First the negative. Suppose there is a confounder <span class="math inline">L</span> that is caused by an unobserved variable <span class="math inline">U</span>, and is affected by the treatment <span class="math inline">A</span>. Suppose further that <span class="math inline">U</span> causes the outcome <span class="math inline">Y</span>. In this scenario, as described in <a href="#fig-dag-descendent" class="quarto-xref">Figure&nbsp;8</a>, conditioning on <span class="math inline">L</span>, which is a descendant of <span class="math inline">A</span> and <span class="math inline">U</span>, can lead to a spurious association between <span class="math inline">A</span> and <span class="math inline">Y</span> through the path <span class="math inline">A \to L \to U \to Y</span>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-dag-descendent" class="quarto-figure quarto-figure-center anchored" width="80%">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dag-descendent-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="common_graphs_files/figure-html/fig-dag-descendent-1.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dag-descendent-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Confounding by descent
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="advice-attend-to-the-temporal-order-of-causality-and-use-expert-knowledge-of-all-relevant-nodes." class="level3">
<h3 class="anchored" data-anchor-id="advice-attend-to-the-temporal-order-of-causality-and-use-expert-knowledge-of-all-relevant-nodes.">Advice: attend to the temporal order of causality, and use expert knowledge of all relevant nodes.</h3>
<p>Ensuring the confounder (<span class="math inline">L</span>) is measured before the exposure (<span class="math inline">A</span>) has two benefits.</p>
<p>First, if <span class="math inline">L</span> is a confounder, that is, if <span class="math inline">L</span> is a variable which if we fail to condition on it will bias the association between treatment and outcome, the strategy of including only pre-treatment indicators of <span class="math inline">L</span> will reduce bias. <a href="#fig-dag-descendent-solution" class="quarto-xref">Figure&nbsp;9</a> presents this strategy</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-dag-descendent-solution" class="quarto-figure quarto-figure-center anchored" width="80%">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dag-descendent-solution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="common_graphs_files/figure-html/fig-dag-descendent-solution-1.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dag-descendent-solution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Solution: again, ensure temporal ordering in all measured variables.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Secondly, note that we may use descendent to reduce bias. For example, if an unmeasured confounder <span class="math inline">U</span> affects <span class="math inline">A</span>, <span class="math inline">Y</span>, and <span class="math inline">L\prime</span>, then adjusting for <span class="math inline">L\prime</span> may help to reduce confounding caused by <span class="math inline">U</span>. This scenario is presented in <a href="#fig-dag-descendent-solution-2" class="quarto-xref">Figure&nbsp;10</a>. Note that in this graph, <span class="math inline">L\prime</span> may occur <em>after</em> the exposure, and indeed after the outcome. This shows that it would be wrong to infer that merely because causes preceed effects, we should only condition on confounders that preceed the exposure.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-dag-descendent-solution-2" class="quarto-figure quarto-figure-center anchored" width="80%">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dag-descendent-solution-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="common_graphs_files/figure-html/fig-dag-descendent-solution-2-1.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dag-descendent-solution-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: Solution: note that conditioning on a confounder that occurs after the exposure and outcome addresses the problem of unmeasured confounding. The dotted paths denote that the effect of U on A and Y is partially adjusted by conditioning on L, even though L occurs after the outcome. The dotted blue path suggest suppressing of the biased relationship between A and Y under the null. A genetic factor that affects the exposure and the outcome early in life, and that also expresses a measured indicator late in life, might constitute an example for which post-outcome confounding control might be possible.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="causal-interaction" class="level3">
<h3 class="anchored" data-anchor-id="causal-interaction">Causal Interaction?</h3>
<p>Applied researchers will often be interested in testing interactions. What is causal interaction and how may we represent it on a causal diagramme?</p>
<p>We must distinguish the concept of causal interaction from the concept of effect modification.</p>
<section id="causal-interaction-as-two-independent-exposures" class="level4">
<h4 class="anchored" data-anchor-id="causal-interaction-as-two-independent-exposures"><strong>Causal interaction as two independent exposures</strong></h4>
<p>Causal interaction is the effect of two exosures that may occur jointly or separately (or not occur). We say there is interaction on the scale of interest when the effect of one exposure on an outcome depends on the level of another exposure. For example, the effect of a drug (exposure A) on recovery time from a disease (outcome Y) might depend on whether or not the patient is also receiving physical therapy (exposure B). In terms of causal quantities, if we denote the potential outcomes under different exposure combinations as <span class="math inline">Y(a,b)</span>, a causal interaction on the difference scale would be present if <span class="math inline">Y(1,1) - Y(1,0) \neq Y(0,1) - Y(0,0)</span>.</p>
<p>When drawing a causal diagram, we represent the two exposures as separate nodes and draw edges from them to the outcome, as showin in <a href="#fig-dag-interaction" class="quarto-xref">Figure&nbsp;11</a>. This is because causal diagrams are non-parametric; they represent the qualitative aspects of causal relationships without making specific assumptions about the functional form of these relationships.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-dag-interaction" class="quarto-figure quarto-figure-center anchored" width="80%">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dag-interaction-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="common_graphs_files/figure-html/fig-dag-interaction-1.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dag-interaction-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: Causal interaction: the are two exposures are causally independent of each other
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="effect-measures-for-causal-interaction" class="level4">
<h4 class="anchored" data-anchor-id="effect-measures-for-causal-interaction"><strong>Effect measures for causal interaction</strong></h4>
<p>On the difference scale, the total causal effect of an exposure <span class="math inline">A</span> on an outcome <span class="math inline">Y</span> is typically quantified as <span class="math inline">Y(1) - Y(0)</span>, where <span class="math inline">Y(a)</span> represents the potential outcome under exposure level a. If there is another exposure <span class="math inline">B</span>, the causal interaction effect on the difference scale would be quantified as <span class="math inline">[Y(1,1) - Y(1,0)] - [Y(0,1) - Y(0,0)]</span>.</p>
<p>Note that causal effect of interactions might differ on the ratio scale. For instance, the total causal effect on the ratio scale would be <span class="math inline">Y(1) / Y(0)</span>, and the interaction effect would be <span class="math inline">[Y(1,1) / Y(1,0)] / [Y(0,1) / Y(0,0)]</span>.</p>
</section>
<section id="causal-interaction-as-effect-modification" class="level4">
<h4 class="anchored" data-anchor-id="causal-interaction-as-effect-modification"><strong>Causal interaction as effect modification</strong></h4>
<p>Effect modification models the effect the magnitude of of a single exposure on an outcome across different levels of another variable.</p>
<p>Here we assume independence of the counterfactual outcome conditional on measured confounders, within strata of co-variate G:</p>
<p><span class="math display">Y(a) \coprod A | L, G</span></p>
<p>Note that there here, there is only one counterfactual outcome.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-dag-effect-modfication" class="quarto-figure quarto-figure-center anchored" width="80%">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dag-effect-modfication-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="common_graphs_files/figure-html/fig-dag-effect-modfication-1.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dag-effect-modfication-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12: A simple graph for effect-modification.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="advice-for-causal-mediation" class="level3">
<h3 class="anchored" data-anchor-id="advice-for-causal-mediation">Advice for causal mediation</h3>
<ol type="1">
<li><p><strong>No unmeasured exposure-outcome confounders given <span class="math inline">L</span></strong></p>
<p>This assumption is denoted by <span class="math inline">Y(a,m) \coprod A | L</span>. It implies that when we control for the covariates <span class="math inline">L</span>, there are no unmeasured confounders that influence both the exposure <span class="math inline">A</span> and the outcome <span class="math inline">Y</span>. For example, if we are studying the effect of a drug (exposure) on recovery time from a disease (outcome), and age and gender are our covariates <span class="math inline">L</span>, this assumption would mean that there are no other factors, not accounted for in <span class="math inline">L</span>, that influence both the decision to take the drug and the recovery time.</p></li>
<li><p><strong>No unmeasured mediator-outcome confounders given <span class="math inline">L</span></strong></p>
<p>This assumption is denoted by <span class="math inline">Y(a,m) \coprod M | L</span>. It implies that when we control for the covariates <span class="math inline">L</span>, there are no unmeasured confounders that influence both the mediator <span class="math inline">M</span> and the outcome <span class="math inline">Y</span>. For instance, if we are studying the effect of exercise (exposure) on weight loss (outcome) mediated by calorie intake (mediator), and age and gender are our covariates <span class="math inline">L</span>, this assumption would mean that there are no other factors, not accounted for in <span class="math inline">L</span>, that influence both the calorie intake and the weight loss.</p></li>
<li><p><strong>No unmeasured exposure-mediator confounders given <span class="math inline">L</span></strong></p>
<p>This assumption is denoted by <span class="math inline">M(a) \coprod A | L</span>. It implies that when we control for the covariates <span class="math inline">L</span>, there are no unmeasured confounders that influence both the exposure <span class="math inline">A</span> and the mediator <span class="math inline">M</span>. Using the previous example, this assumption would mean that there are no other factors, not accounted for in <span class="math inline">L</span>, that influence both the decision to exercise and the calorie intake.</p></li>
<li><p><strong>No mediator-outcome confounder affected by the exposure (no red arrow)</strong></p></li>
</ol>
<p>This assumption is denoted by <span class="math inline">Y(a,m) \coprod M^{a*} | L</span>. It implies that there are no variables that confound the relationship between the mediator and the outcome that are affected by the exposure. For example, if we are studying the effect of education (exposure) on income (outcome) mediated by job type (mediator), this assumption would mean that there are no factors that influence both job type and income that are affected by the level of education.</p>
<p>These assumptions are fundamental for the identification of causal mediation effects. If these assumptions are violated, the estimates of the mediation effect can be biased. Importantly, these assumptions cannot be fully tested with observed data. They require substantive knowledge about the underlying causal process. Note that when assumption 4 is violated, natural direct and indirect effects are not identified in the data. [Cite Tyler here]</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-dag-mediation-assuptions" class="quarto-figure quarto-figure-center anchored" width="80%">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dag-mediation-assuptions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="common_graphs_files/figure-html/fig-dag-mediation-assuptions-1.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dag-mediation-assuptions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13: Assumptions for mediation analysis
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="advice-for-modelling-repeated-exposures-in-longitudinal-data-confounder-treatment-feedback" class="level3">
<h3 class="anchored" data-anchor-id="advice-for-modelling-repeated-exposures-in-longitudinal-data-confounder-treatment-feedback">Advice for modelling repeated exposures in longitudinal data (confounder-treatment feedback)?</h3>
<p>Causal mediation is a special case in which we have multiple sequential exposures.</p>
<p>For example, consider temporally fixed multiple exposures. The counterfactual outcomes may be denoted <span class="math inline">Y(a_{t1} ,a_{t2})</span>. There are four counterfactual outcomes corresponding to the four fixed “treatment regimes”:</p>
<ol type="1">
<li><p><strong>Always treat (Y(1,1))</strong>: This regime involves providing the treatment at every opportunity.</p></li>
<li><p><strong>Never treat (Y(0,0))</strong>: This regime involves abstaining from providing the treatment at any opportunity.</p></li>
<li><p><strong>Treat once first (Y(1,0))</strong>: This regime involves providing the treatment only at the first opportunity and not at subsequent one.</p></li>
<li><p><strong>Treat once second (Y(0,1))</strong>: This regime involves abstaining from providing the treatment at the first opportunity, but then providing it at the second one.</p></li>
</ol>
<p>There are six causal contrasts that we might compute.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<ol type="1">
<li><strong>Always treat</strong> vs.&nbsp;<strong>Never treat</strong></li>
<li><strong>Always treat</strong> vs.&nbsp;<strong>Treat once first</strong></li>
<li><strong>Always treat</strong> vs.&nbsp;<strong>Treat once second</strong></li>
<li><strong>Never treat</strong> vs.&nbsp;<strong>Treat once first</strong></li>
<li><strong>Never treat</strong> vs.&nbsp;<strong>Treat once second</strong></li>
<li><strong>Treat once first</strong> vs.&nbsp;<strong>Treat once second</strong></li>
</ol>
<p>We might also consider treatment to be a function of the previous outcome. For example, we might <strong>Treat once first</strong> and then <strong>treat again</strong> or <strong>do not treat again</strong> depending on the outcome of the previous treatment. This is called “time-varying treatment regimes.”</p>
<p>Note that to estimate the “effect” of a treatment regime, we must compare the counterfactual quantities of interest. The same conditions that apply for causal identification in mediation analysis apply to causal idenification in multiple treatment settings. And notice, just as mediation opens the possibility of time-varying confounding (condition 4, in which the exposure effects the confounders of the mediator/outcome path), so too we find that with time-varying treatments comes the problem of time-varying confounding. Unlike traditional causal mediation analysis, the sequence of treatement regimes that we might consider is indefinitely long.</p>
<p>Temporally organised causal diagrammes help us to discover the problems with traditional multi-level regression analysis and structural equation modelling. Suppose we are interested in the question of whether beliefs in big Gods affect social complexity.</p>
<p>First consider fixed regimes Suppose we have well-defined concept of social complexity and excellent measurements over time. Suppose we want to compare the effects of beliefs on big Gods on Social complexity using historical data measured over two centuries. Our question is whether the introduction and persistence of such beliefs differs from having no such beliefs. The treatment strategies are: “always believe in big Gods” versus “never believe in big Gods” on the level of social complexity. The a causal diagram illustrates two time points in our study the study.</p>
<p>Here, <span class="math inline">A_{tx}</span> represents the cultural belief in “big Gods” at time <span class="math inline">x</span>, and <span class="math inline">Y_{tx}</span> is the outcome, social complexity, at time <span class="math inline">x</span>. Economic trade, denoted as <span class="math inline">L_{tx}</span>, is a time-varying confounder because it varies over time and confounds the effect of <span class="math inline">A</span> on <span class="math inline">Y</span> at several time points <span class="math inline">x</span>. To complete our causal diagramme we include an unmeasured confounder <span class="math inline">U</span>, such as geographical constraints, which might influence both the belief in “big Gods” and social complexity.</p>
<p>We know that the level of economic trade at time <span class="math inline">0</span>, <span class="math inline">L_{t0}</span>, influences the belief in “big Gods” at time <span class="math inline">1</span>, <span class="math inline">A_{t1}</span>. We therefore draw an arrow from <span class="math inline">L_{t0}</span> to <span class="math inline">A_{t1}</span>. But we also know that the belief in “big Gods”, <span class="math inline">A_{t1}</span>, affects the future level of economic trade, <span class="math inline">L_{t(2)}</span>. This means that we need to add an arrow from <span class="math inline">A_{t1}</span> to <span class="math inline">L_{t(2)}</span>. This causal graph represents a feedback process between the time-varying exposure <span class="math inline">A</span> and the time-varying confounder <span class="math inline">L</span>. This is the simplest graph with exposure-confounder feedback. In real world setting there could be arrows. However, our DAG however need show the minimum number of arrows to exhibit the problem of exposure-confounder feedback.</p>
<p>What happens if we condition on the time-varying confounder <span class="math inline">L_{t3}</span>. Two things occur. First, we block all the backdoor paths between the exposure <span class="math inline">A_{t2}</span> and the outcome. We need to block those paths to eliminate confounding. Therefore, condition on the time-varying confounding would appear to be essential. Second, paths that were previously blocked are now open. For example, the path <span class="math inline">A_{t1}, L_{t2}, U, Y_{t(4)}</span>, which was previous closed is opened because the time varying confounder is the common effect of <span class="math inline">A_{t1}</span> and <span class="math inline">U</span>. Conditioning opens the path <span class="math inline">A_{t1}, L_{t2}, U, Y_{3}</span>. The same problem occurs if the time-varying exposure and time-varying confounder share a common cause (without the exposure affecting the confounder). And the problem is only more entrenched when the exposures <span class="math inline">A_{t1}</span> affects the outcome <span class="math inline">Y_{t4}</span>. Because <span class="math inline">L_{t2}</span> is along the path from <span class="math inline">A_{t1}</span> to <span class="math inline">Y_{t4}</span> conditioning on <span class="math inline">L_{t2}</span> partially blocks the path between the exposure and the outcome. Conditioning on <span class="math inline">L_{t2}</span> in this setting induces both collider stratification bias and mediator bias. Yet we must conditoin on <span class="math inline">L_{t2}</span> to block the open backdoor path between <span class="math inline">L_{t2}</span> and <span class="math inline">Y_{t4}</span>. The general problem of xposure-confounder feedback is described in detail in <span class="citation" data-cites="hernan2023">[@hernan2023]</span>. This problem presents a serious issue for cultural evolutionary studies. The bad news is that nearly traditional regresion based methods cannot address this problem. The good new is that</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-dag-9" class="quarto-figure quarto-figure-center anchored" width="80%">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dag-9-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="common_graphs_files/figure-html/fig-dag-9-1.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dag-9-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14: Exposure confounder feedback is a problem for time-series models. Unfortunately, this problem cannot be addressed with regression-based methods, whatever the combination of Bayesian, multi-level, and phylogentic sophistication. We may only estimate controlled (simulated) effects in these setting using G-methods. Currently, outside of epidemiology, g-methods are rarely used.
</figcaption>
</figure>
</div>
</div>
</div>
<p>More about SWIGS…</p>


</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>We may compute the combination of contrasts by <span class="math inline">C(n, r) = \frac{n!}{(n-r)! \cdot r!}</span><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div>MIT</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    const typesetMath = (el) => {
      if (window.MathJax) {
        // MathJax Typeset
        window.MathJax.typeset([el]);
      } else if (window.katex) {
        // KaTeX Render
        var mathElements = el.getElementsByClassName("math");
        var macros = [];
        for (var i = 0; i < mathElements.length; i++) {
          var texText = mathElements[i].firstChild;
          if (mathElements[i].tagName == "SPAN") {
            window.katex.render(texText.data, mathElements[i], {
              displayMode: mathElements[i].classList.contains('display'),
              throwOnError: false,
              macros: macros,
              fleqn: false
            });
          }
        }
      }
    }
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        typesetMath(container);
        return container.innerHTML
      } else {
        typesetMath(note);
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      typesetMath(note);
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>
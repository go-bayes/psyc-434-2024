<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Joseph Bulbulia">
<meta name="dcterms.date" content="2023-03-08">

<title>PSYC 434 Conducting Research Across Cultures: Trimester 1, 2024 – Causal Diagrams: The Structures of Confounding Bias</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="../site_libs/table1-1.0/table1_defaults.css" rel="stylesheet">

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">PSYC 434 Conducting Research Across Cultures: Trimester 1, 2024</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../content/course-outline.html"> 
<span class="menu-text">Course Outline</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-content" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Content</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-content">    
        <li>
    <a class="dropdown-item" href="../content/glossary.pdf">
 <span class="dropdown-text">Glossary</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/course-outline.html">
 <span class="dropdown-text">Course Outline</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/01-content.html">
 <span class="dropdown-text">Week 1: Course Introduction - R (installing packages)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/02-content.html">
 <span class="dropdown-text">Week 2: Causal Diagrams - Elementary Structures and Rules - R (using the interface)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/03-content.html">
 <span class="dropdown-text">Week 3: Causal Diagrams - Confounding Bias - R (regression/simulation)</span></a>
  </li>  
        <li class="dropdown-header">Week 4: Causal Diagrams - Interaction, Measurement Bias, Selection Bias - R (regression/simulation)</li>
        <li class="dropdown-header">Week 5: Quiz - R (regression/simulation/reporting)</li>
        <li class="dropdown-header">Week 6: Causal Inference - Key Concepts ATE - R (regression/simulation: ATE)</li>
        <li class="dropdown-header">Week 7: Causal Inference - Key Concept CATE - R (regression/simulation: ATE)</li>
        <li class="dropdown-header">Week 8: Causal Inference - Estimation of ATE and CATE - R and LaTeX</li>
        <li class="dropdown-header">Week 9: Quiz - R</li>
        <li class="dropdown-header">Week 10: Measurement Matters - Factor Analysis, CFA, MultiGroup CFA, Partial Invariance - R</li>
        <li class="dropdown-header">Week 11: Measurement + External Validity in Causal Inference - R (writing introduction/method section)</li>
        <li class="dropdown-header">Week 12: Missing Data Workflows - Quarto Documents Seminar - Workflows</li>
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Causal Diagrams: The Structures of Confounding Bias</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
                      </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author">Joseph Bulbulia <a href="mailto:joseph.bulbulia@vuw.ac.nz" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0002-5861-2056" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              Victoria University of Wellington, New Zealand
            </p>
        </div>
    </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 8, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#seminar" id="toc-seminar" class="nav-link active" data-scroll-target="#seminar">Seminar</a>
  <ul class="collapse">
  <li><a href="#learning-outcomes" id="toc-learning-outcomes" class="nav-link" data-scroll-target="#learning-outcomes">Learning Outcomes</a></li>
  <li><a href="#confounding-problems-resolved-by-time-series-data" id="toc-confounding-problems-resolved-by-time-series-data" class="nav-link" data-scroll-target="#confounding-problems-resolved-by-time-series-data">Confounding problems resolved by time-series data</a></li>
  <li><a href="#confounding-problems-not-resolved-by-time-series-data-alone" id="toc-confounding-problems-not-resolved-by-time-series-data-alone" class="nav-link" data-scroll-target="#confounding-problems-not-resolved-by-time-series-data-alone">Confounding problems not resolved by time-series data alone</a></li>
  <li><a href="#worked-example-the-assumptions-in-causal-mediation" id="toc-worked-example-the-assumptions-in-causal-mediation" class="nav-link" data-scroll-target="#worked-example-the-assumptions-in-causal-mediation">Worked Example: The Assumptions in Causal Mediation</a></li>
  </ul></li>
  <li><a href="#lab-3" id="toc-lab-3" class="nav-link" data-scroll-target="#lab-3">Lab 3</a></li>
  <li><a href="#regression" id="toc-regression" class="nav-link" data-scroll-target="#regression">Regression</a>
  <ul class="collapse">
  <li><a href="#learning-outcomes-1" id="toc-learning-outcomes-1" class="nav-link" data-scroll-target="#learning-outcomes-1">Learning Outcomes</a></li>
  <li><a href="#what-is-regression" id="toc-what-is-regression" class="nav-link" data-scroll-target="#what-is-regression">What is Regression?</a>
  <ul class="collapse">
  <li><a href="#how-can-i-use-regression-to-infer-a-population-parameter" id="toc-how-can-i-use-regression-to-infer-a-population-parameter" class="nav-link" data-scroll-target="#how-can-i-use-regression-to-infer-a-population-parameter">How can I use regression to infer a population parameter?</a></li>
  <li><a href="#regression-with-a-single-co-variate" id="toc-regression-with-a-single-co-variate" class="nav-link" data-scroll-target="#regression-with-a-single-co-variate">Regression with a single co-variate</a></li>
  </ul></li>
  <li><a href="#how-do-we-interpret-the-regression-model" id="toc-how-do-we-interpret-the-regression-model" class="nav-link" data-scroll-target="#how-do-we-interpret-the-regression-model">How do we interpret the regression model?</a>
  <ul class="collapse">
  <li><a href="#graph-the-relationship-between-mothers-and-daughters-heights" id="toc-graph-the-relationship-between-mothers-and-daughters-heights" class="nav-link" data-scroll-target="#graph-the-relationship-between-mothers-and-daughters-heights">Graph the relationship between mother’s and daughter’s heights</a></li>
  <li><a href="#regression-to-predict-beyond-the-range-of-a-dataset" id="toc-regression-to-predict-beyond-the-range-of-a-dataset" class="nav-link" data-scroll-target="#regression-to-predict-beyond-the-range-of-a-dataset">Regression to predict beyond the range of a dataset</a></li>
  <li><a href="#non-linear-relationships" id="toc-non-linear-relationships" class="nav-link" data-scroll-target="#non-linear-relationships">Non-linear relationships</a></li>
  <li><a href="#centering" id="toc-centering" class="nav-link" data-scroll-target="#centering">Centering</a></li>
  <li><a href="#model-evaluation" id="toc-model-evaluation" class="nav-link" data-scroll-target="#model-evaluation">Model evaluation</a></li>
  <li><a href="#generate-a-report" id="toc-generate-a-report" class="nav-link" data-scroll-target="#generate-a-report">Generate a report</a></li>
  </ul></li>
  <li><a href="#assumptions-of-regression" id="toc-assumptions-of-regression" class="nav-link" data-scroll-target="#assumptions-of-regression">Assumptions of Regression</a>
  <ul class="collapse">
  <li><a href="#common-confusions" id="toc-common-confusions" class="nav-link" data-scroll-target="#common-confusions">Common Confusions</a></li>
  </ul></li>
  <li><a href="#simulation-demonstration-1-how-regression-coefficients-mislead" id="toc-simulation-demonstration-1-how-regression-coefficients-mislead" class="nav-link" data-scroll-target="#simulation-demonstration-1-how-regression-coefficients-mislead">Simulation Demonstration 1: How Regression Coefficients Mislead</a>
  <ul class="collapse">
  <li><a href="#compare-model-fits" id="toc-compare-model-fits" class="nav-link" data-scroll-target="#compare-model-fits">Compare model fits</a></li>
  </ul></li>
  <li><a href="#simulation-demonstration-2-how-regression-coefficients-mislead" id="toc-simulation-demonstration-2-how-regression-coefficients-mislead" class="nav-link" data-scroll-target="#simulation-demonstration-2-how-regression-coefficients-mislead">Simulation Demonstration 2: How Regression Coefficients Mislead</a>
  <ul class="collapse">
  <li><a href="#compare-model-fits-1" id="toc-compare-model-fits-1" class="nav-link" data-scroll-target="#compare-model-fits-1">Compare model fits</a></li>
  </ul></li>
  <li><a href="#resources-on-regression-that-do-not-perpetuate-the-causality-crisis" id="toc-resources-on-regression-that-do-not-perpetuate-the-causality-crisis" class="nav-link" data-scroll-target="#resources-on-regression-that-do-not-perpetuate-the-causality-crisis">Resources on Regression that Do Not Perpetuate The Causality Crisis</a></li>
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">Setup</a>
  <ul class="collapse">
  <li><a href="#libraries" id="toc-libraries" class="nav-link" data-scroll-target="#libraries">Libraries</a></li>
  <li><a href="#get-data" id="toc-get-data" class="nav-link" data-scroll-target="#get-data">Get data</a></li>
  <li><a href="#import-pearson-and-lee-mothers-and-daughters-data" id="toc-import-pearson-and-lee-mothers-and-daughters-data" class="nav-link" data-scroll-target="#import-pearson-and-lee-mothers-and-daughters-data">Import <code>Pearson and Lee</code> mother’s and daughters data</a></li>
  <li><a href="#note" id="toc-note" class="nav-link" data-scroll-target="#note">Note</a></li>
  </ul></li>
  <li><a href="#q2.-regression-height-weight-and-report-results" id="toc-q2.-regression-height-weight-and-report-results" class="nav-link" data-scroll-target="#q2.-regression-height-weight-and-report-results">Q2. Regression height ~ weight and report results</a></li>
  <li><a href="#q3.-regress-height-male-and-report-results" id="toc-q3.-regress-height-male-and-report-results" class="nav-link" data-scroll-target="#q3.-regress-height-male-and-report-results">Q3. Regress height ~ male and report results</a></li>
  <li><a href="#q4.-regression-to-predict" id="toc-q4.-regression-to-predict" class="nav-link" data-scroll-target="#q4.-regression-to-predict">Q4. Regression to predict</a></li>
  <li><a href="#q5.-bonus" id="toc-q5.-bonus" class="nav-link" data-scroll-target="#q5.-bonus">Q5. Bonus</a></li>
  <li><a href="#solutions-set-up" id="toc-solutions-set-up" class="nav-link" data-scroll-target="#solutions-set-up">Solutions: Set Up</a></li>
  <li><a href="#solution-q1-descriptive-table" id="toc-solution-q1-descriptive-table" class="nav-link" data-scroll-target="#solution-q1-descriptive-table">Solution Q1 descriptive table</a></li>
  <li><a href="#solution-q2.-regress-height-weight-and-report-results" id="toc-solution-q2.-regress-height-weight-and-report-results" class="nav-link" data-scroll-target="#solution-q2.-regress-height-weight-and-report-results">Solution Q2. Regress height ~ weight and report results</a></li>
  <li><a href="#solution-q3.-regress-height-male-and-report-results" id="toc-solution-q3.-regress-height-male-and-report-results" class="nav-link" data-scroll-target="#solution-q3.-regress-height-male-and-report-results">Solution Q3. Regress height ~ male and report results</a></li>
  <li><a href="#solution-q4.-regression-to-predict" id="toc-solution-q4.-regression-to-predict" class="nav-link" data-scroll-target="#solution-q4.-regression-to-predict">Solution Q4. Regression to predict</a></li>
  <li><a href="#solution-q6.-bonus" id="toc-solution-q6.-bonus" class="nav-link" data-scroll-target="#solution-q6.-bonus">Solution Q6. Bonus</a></li>
  <li><a href="#appendix-1-conceptual-background" id="toc-appendix-1-conceptual-background" class="nav-link" data-scroll-target="#appendix-1-conceptual-background">Appendix 1 Conceptual Background</a>
  <ul class="collapse">
  <li><a href="#science-begins-with-a-question" id="toc-science-begins-with-a-question" class="nav-link" data-scroll-target="#science-begins-with-a-question">Science begins with a question</a></li>
  <li><a href="#scientific-model-or-theory" id="toc-scientific-model-or-theory" class="nav-link" data-scroll-target="#scientific-model-or-theory">Scientific model (or theory)</a></li>
  <li><a href="#what-is-statistics" id="toc-what-is-statistics" class="nav-link" data-scroll-target="#what-is-statistics">What is statistics?</a></li>
  <li><a href="#applications-of-statistical-models-in-science" id="toc-applications-of-statistical-models-in-science" class="nav-link" data-scroll-target="#applications-of-statistical-models-in-science">Applications of statistical models in science</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">





<div class="cell">

</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Required</strong> - <span class="citation" data-cites="hernan2024WHATIF">(<a href="#ref-hernan2024WHATIF" role="doc-biblioref">Hernan and Robins 2024</a>)</span> Chapter 6 <a href="https://www.dropbox.com/scl/fi/9hy6xw1g1o4yz94ip8cvd/hernanrobins_WhatIf_2jan24.pdf?rlkey=8eaw6lqhmes7ddepuriwk5xk9&amp;dl=0">link</a></p>
<p><strong>Optional</strong></p>
<ul>
<li><span class="citation" data-cites="suzuki2020">(<a href="#ref-suzuki2020" role="doc-biblioref">Suzuki, Shinozaki, and Yamamoto 2020</a>)</span> <a href="https://www.dropbox.com/scl/fi/4midxwr9ltg9oce02e0ss/suzuki-causal-diagrams.pdf?rlkey=uktzf3nurtgpbj8m4h0xz82dn&amp;dl=0">link</a></li>
<li><span class="citation" data-cites="bulbulia2023">(<a href="#ref-bulbulia2023" role="doc-biblioref">Bulbulia 2023</a>)</span> <a href="https://osf.io/preprints/psyarxiv/b23k7">link</a></li>
<li><span class="citation" data-cites="neal2020introduction">(<a href="#ref-neal2020introduction" role="doc-biblioref">Neal 2020</a>)</span> Chapter 3 <a href="">link</a></li>
</ul>
</div>
</div>
<div class="no-row-height column-margin column-container"><div id="ref-neal2020introduction" class="csl-entry" role="listitem">
Neal, Brady. 2020. <span>“Introduction to Causal Inference from a Machine Learning Perspective.”</span> <em>Course Lecture Notes (Draft)</em>. <a href="https://www.bradyneal.com/Introduction_to_Causal_Inference-Dec17_2020-Neal.pdf">https://www.bradyneal.com/Introduction_to_Causal_Inference-Dec17_2020-Neal.pdf</a>.
</div></div><div class="no-row-height column-margin column-container"><div id="ref-bulbulia2023" class="csl-entry" role="listitem">
———. 2023. <span>“Causal Diagrams (Directed Acyclic Graphs): A Practical Guide.”</span>
</div></div><div class="no-row-height column-margin column-container"><div id="ref-suzuki2020" class="csl-entry" role="listitem">
Suzuki, Etsuji, Tomohiro Shinozaki, and Eiji Yamamoto. 2020. <span>“Causal Diagrams: Pitfalls and Tips.”</span> <em>Journal of Epidemiology</em> 30 (4): 153–62. <a href="https://doi.org/10.2188/jea.JE20190192">https://doi.org/10.2188/jea.JE20190192</a>.
</div></div><div class="no-row-height column-margin column-container"><div id="ref-hernan2024WHATIF" class="csl-entry" role="listitem">
Hernan, M. A., and J. M. Robins. 2024. <em>Causal Inference: What If?</em> Chapman &amp; Hall/CRC Monographs on Statistics &amp; Applied Probab. Taylor &amp; Francis. <a href="https://www.hsph.harvard.edu/miguel-hernan/causal-inference-book/">https://www.hsph.harvard.edu/miguel-hernan/causal-inference-book/</a>.
</div></div><div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key concepts for the test(s):
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>M-bias</strong></li>
<li><strong>Regression</strong></li>
<li><strong>Intercept</strong></li>
<li><strong>Regression Coefficient</strong></li>
<li><strong>Model Fit</strong></li>
<li><strong>Why Model Fit is Misleading for Causality</strong></li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
For the lab, copy and paste code chunks following the “LAB 3” section.
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<section id="seminar" class="level1 page-columns page-full">
<h1>Seminar</h1>
<section id="learning-outcomes" class="level2">
<h2 class="anchored" data-anchor-id="learning-outcomes">Learning Outcomes</h2>
<ul>
<li><p>You will learn how to use causal diagrams to evaluate the “no unmeasured confounding” assumption of causal inference.</p></li>
<li><p>You will understand how time-series data-collection may address common confounding problems.</p></li>
<li><p>You will understand why time-series data-collection are insufficient for addressing other common confounding problems.</p></li>
</ul>
</section>
<section id="confounding-problems-resolved-by-time-series-data" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="confounding-problems-resolved-by-time-series-data">Confounding problems resolved by time-series data</h2>
<p><a href="#fig-time-solved" class="quarto-xref">Figure&nbsp;3</a> presents the structural features of seven confounding problems. We shall discuss examples of each, and how longitudinal data collection resolves each problem.</p>
<div id="fig-time-solved" class="quarto-figure quarto-figure-left quarto-float anchored page-columns page-full" data-fig-align="left">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-time-solved-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<embed src="time-resolved-confounding.pdf" class="quarto-figure quarto-figure-left" style="width:100.0%;height:100.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-time-solved-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: This figure is adapted from <span class="citation" data-cites="bulbulia2023">(<a href="#ref-bulbulia2023" role="doc-biblioref">Bulbulia 2023</a>)</span>
<div id="ref-bulbulia2023" class="csl-entry" role="listitem">
———. 2023. <span>“Causal Diagrams (Directed Acyclic Graphs): A Practical Guide.”</span>
</div></figcaption>
</figure>
</div>
</section>
<section id="confounding-problems-not-resolved-by-time-series-data-alone" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="confounding-problems-not-resolved-by-time-series-data-alone">Confounding problems not resolved by time-series data alone</h2>
<p><a href="#fig-time-not-solved" class="quarto-xref">Figure&nbsp;2</a> presents six examples of time-series data that are not resolved by longitudinal data collection. <strong>Before seminar, consider why time series data are insufficient to address confounding in each of the six scenarios described in this figure.</strong></p>
<div id="fig-time-not-solved" class="quarto-figure quarto-figure-left quarto-float anchored page-columns page-full" data-fig-align="left">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-time-not-solved-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<embed src="dag-time-series-not-resolved.pdf" class="quarto-figure quarto-figure-left" style="width:100.0%;height:100.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-time-not-solved-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: This figure is adapted from <span class="citation" data-cites="bulbulia2023">(<a href="#ref-bulbulia2023" role="doc-biblioref">Bulbulia 2023</a>)</span>
<div id="ref-bulbulia2023" class="csl-entry" role="listitem">
———. 2023. <span>“Causal Diagrams (Directed Acyclic Graphs): A Practical Guide.”</span>
</div></figcaption>
</figure>
</div>
</section>
<section id="worked-example-the-assumptions-in-causal-mediation" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="worked-example-the-assumptions-in-causal-mediation">Worked Example: The Assumptions in Causal Mediation</h2>
<div id="fig-time-solved" class="quarto-figure quarto-figure-left quarto-float anchored page-columns page-full" data-fig-align="left">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-time-solved-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<embed src="mediation.pdf" class="quarto-figure quarto-figure-left" style="width:100.0%;height:100.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-time-solved-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: This figure is adapted from <span class="citation" data-cites="bulbulia2023">(<a href="#ref-bulbulia2023" role="doc-biblioref">Bulbulia 2023</a>)</span>
<div id="ref-bulbulia2023" class="csl-entry" role="listitem">
———. 2023. <span>“Causal Diagrams (Directed Acyclic Graphs): A Practical Guide.”</span>
</div></figcaption>
</figure>
</div>
</section>
</section>
<section id="lab-3" class="level1">
<h1>Lab 3</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(devtools, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"devtools"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(devtools)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># simulated data (will take time to download)</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># devtools::install_github("go-bayes/margot")</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"margot"</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"margot"</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># List all datasets available in the package</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># data(package = "margot")</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">#data("df_nz", package = "margot")</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># for equations </span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># if (!require(devtools, quietly = TRUE)) {</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   install.packages("remotes")</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   library(remotes)</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># remotes::install_github("datalorax/equatiomatic")</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co"># library("equatiomatic")</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co"># data wrangling</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(tidyverse, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(tidyverse)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co"># regression splines</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="co"># for equations </span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(devtools, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"splines"</span>)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(splines)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="co"># reports</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(report, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"report"</span>)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(report)</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="co"># for equations </span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(performance, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"performance"</span>)</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(performance)</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="co"># graphs </span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(ggeffects, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"ggeffects"</span>)</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggeffects)</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="co"># more graphs</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(sjPlot, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"sjPlot"</span>)</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(sjPlot)</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a><span class="co"># data wrangling</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(dplyr, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"dplyr"</span>)</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(dplyr)</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a><span class="co"># graphing</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(ggplot2, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggplot2)</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a><span class="co"># summary stats</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(skimr, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"skimr"</span>)</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(skimr)</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a><span class="co"># tables </span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(gtsummary, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"gtsummary"</span>)</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(gtsummary)</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a><span class="co"># easy tables</span></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(table1, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"table1"</span>)</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(table1)</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a><span class="co"># table summaries</span></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(kableExtra, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"kableExtra"</span>)</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(kableExtra)</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a><span class="co"># multi-panel plots</span></span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(patchwork, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"patchwork"</span>)</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(patchwork)</span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(performance, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"performance"</span>)</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(performance)</span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="regression" class="level1 page-columns page-full">
<h1>Regression</h1>
<p>This week we introduce regression.</p>
<section id="learning-outcomes-1" class="level2">
<h2 class="anchored" data-anchor-id="learning-outcomes-1">Learning Outcomes</h2>
<p>By learning regression, you will be better equipped to do psychological science and to evaluate psychological research.</p>
</section>
<section id="what-is-regression" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="what-is-regression">What is Regression?</h2>
<p>Broadly speaking, a regression model is a method for inferring the expected average features of a population and its variance conditional on other features of the population as measured in a sample.</p>
<p>We’ll see that regression encompasses more than this definition; however, this definition makes a start.</p>
<p>To understand regression, then, we need to understand the following jargon words: population, sample, measurement, and inference.</p>
<section id="what-is-a-population" class="level4">
<h4 class="anchored" data-anchor-id="what-is-a-population">What is a population?</h4>
<p>In science, a population is a hypothetical construct. It is the set of all potential members of a set of things. In psychological science, that set is typically a collection of individuals. We want to understand “The population of all human beings?” or “The New Zealand adult population”; or “The population of undergraduates who may be recruited for IPRP in New Zealand.”</p>
</section>
<section id="what-is-a-sample" class="level4">
<h4 class="anchored" data-anchor-id="what-is-a-sample">What is a sample?</h4>
<p>A sample is a randomly realised sub-population from the larger abstract population that a scientific community hopes to generalise about.</p>
<p>Think of selecting balls randomly from an urn. When pulled at random, the balls may inform us about the urn’s contents. For example, if we select one white ball and one black ball, we may infer that the balls in the urn are not all white or all black.</p>
</section>
<section id="what-is-measurement" class="level4">
<h4 class="anchored" data-anchor-id="what-is-measurement">What is “measurement”?</h4>
<p>A measure is a tool or method for obtaining numerical descriptions of a sample. We often call measures “scales.”</p>
<p>A measurement is the numerical description we obtain from sensors such as statistical surveys, census data, twitter feeds, &amp; etc.</p>
<p>In the course, we have encountered numerical scales, ordinal scales, and factors. The topic of measurement in psychology is very broad. As we shall see, the trail of the serpent of measurement runs across comparative psychological research.</p>
<p>It is essential to remember that measures can be prone to error.</p>
<p>Error-prone scales may nevertheless be helpful. However, we need to investigate their utility against the backdrop of specific interests and purposes.</p>
</section>
<section id="what-is-a-parameter" class="level4">
<h4 class="anchored" data-anchor-id="what-is-a-parameter">What is a parameter?</h4>
<p>In regression, we combine measurements on samples with probability theory to guess about the properties of a population we will never observe. We call these properties “parameters.”</p>
</section>
<section id="what-is-statistical-inference" class="level4">
<h4 class="anchored" data-anchor-id="what-is-statistical-inference">What is statistical inference?</h4>
<p>The bulk of statistical inference consists of educated guessing about population parameters.</p>
</section>
<section id="probability-distributions-and-statistical-guessing" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="probability-distributions-and-statistical-guessing">Probability distributions and statistical guessing</h4>
<p>Inference is possible because the parameters of naturally occurring populations are structured by data-generating processes that are approximated by <strong>probability distributions.</strong> A probability distribution is a mathematical function describing a random event’s probability. Today we will be focusing on height.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;The relationship of probability distributions and data-generating processes is complex, intriguing, and both historically and philosophically rich <span class="math inline">\dots</span>. Because our interests are applied, we will hardly touch up this richness in this course.</p></div></div><p>Today we will discuss the “normal” or “Gaussian distribution.” A large number of data-generating processes in nature conform the normal distribution.</p>
<p>Let’s consider some examples of randomly generated samples, which we will obtain using R’s <code>rnorm</code> function.</p>
</section>
<section id="person-sample-of-heights" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="person-sample-of-heights">100-person sample of heights</h4>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># seed</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># generate 10 samples, average 170, sd = 20</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>draws_10 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">170</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot quick-histogram</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">qplot</span>(draws_10, <span class="at">binwidth =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="03-content_files/figure-html/draws_10-1.png" class="column-column-page-left img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="person-sample-of-heights-1" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="person-sample-of-heights-1">10-person sample of heights</h4>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reproducibility </span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># generate 100 samples, average 170, sd = 20</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>draws_100 <span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">170</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># graph</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">qplot</span>(</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  draws_100, <span class="at">binwidth =</span> <span class="dv">2</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="03-content_files/figure-html/draws_100-1.png" class="column-column-page-left img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="person-sample-of-heights-2" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="person-sample-of-heights-2">10000-person sample of heights</h4>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reproducibility</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># N = 10,000</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>draws_10000 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fl">1e5</span>, <span class="at">mean =</span> <span class="dv">170</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">qplot</span>(draws_10000, <span class="at">binwidth =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="03-content_files/figure-html/draws_10000-1.png" class="column-column-page-left img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="how-can-i-use-regression-to-infer-a-population-parameter" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="how-can-i-use-regression-to-infer-a-population-parameter">How can I use regression to infer a population parameter?</h3>
<p>We can use R to investigate the <em>average</em> height of our imaginary population from which the preceding samples were randomly drawn. We do this in R by writing an “intercept-only” model as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># syntax for an intercept-only model</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(outcome <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> data)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># base R summary</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Using the previous simulations:</p>
<p>N = 10 random draws</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|code-fold: false</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#write the model and get a nice table for it</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(<span class="fu">lm</span>(draws_10 <span class="sc">~</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display column-column-page-left">
<div>
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">&nbsp;</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">Dependent variable</td>
</tr>
<tr class="even">
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Predictors</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">p</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">171.49</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">157.85&nbsp;–&nbsp;185.14</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">Observations</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">10</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">R<sup>2</sup> / R<sup>2</sup> adjusted</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.000 / 0.000</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<p>N = 100 random draws</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(<span class="fu">lm</span>(draws_100 <span class="sc">~</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display column-column-page-left">
<div>
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">&nbsp;</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">Dependent variable</td>
</tr>
<tr class="even">
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Predictors</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">p</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">171.81</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">168.19&nbsp;–&nbsp;175.43</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">Observations</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">100</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">R<sup>2</sup> / R<sup>2</sup> adjusted</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.000 / 0.000</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<p>N = 10,000 random draws</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(<span class="fu">lm</span>(draws_10000 <span class="sc">~</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display column-column-page-left">
<div>
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">&nbsp;</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">Dependent variable</td>
</tr>
<tr class="even">
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Predictors</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">p</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">170.02</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">169.90&nbsp;–&nbsp;170.14</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">Observations</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">100000</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">R<sup>2</sup> / R<sup>2</sup> adjusted</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.000 / 0.000</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<p>What do we notice about the relationship between sample size the estimated population average?</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(<span class="fu">lm</span>(draws_10 <span class="sc">~</span> <span class="dv">1</span>),</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">lm</span>(draws_100 <span class="sc">~</span> <span class="dv">1</span>),</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">lm</span>(draws_10000 <span class="sc">~</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display column-column-page-left">
<div>
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">&nbsp;</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">Dependent variable</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">Dependent variable</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">Dependent variable</td>
</tr>
<tr class="even">
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Predictors</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">p</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center;">p</td>
<td style="text-align: center;">Estimates</td>
<td style="text-align: center;">CI</td>
<td style="text-align: center;">p</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">171.49</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">157.85&nbsp;–&nbsp;185.14</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">171.81</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">168.19&nbsp;–&nbsp;175.43</td>
<td style="text-align: center;"><strong>&lt;0.001</strong></td>
<td style="text-align: center;">170.02</td>
<td style="text-align: center;">169.90&nbsp;–&nbsp;170.14</td>
<td style="text-align: center;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">Observations</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">10</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">100</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">100000</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">R<sup>2</sup> / R<sup>2</sup> adjusted</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.000 / 0.000</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.000 / 0.000</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.000 / 0.000</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
</section>
<section id="regression-with-a-single-co-variate" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="regression-with-a-single-co-variate">Regression with a single co-variate</h3>
<p>Do mothers’s heights <em>predict</em> daughter height? If so, what is the magnitude of the relationship?</p>
<p>Francis Galton is credited with inventing regression analysis. Galton observed that offspring’s heights tend to fall between parental height and the population average, which Galton termed “regression to the mean.” Galton sought a method for educated guessing about heights, and this led to fitting a line of regression by a method called “least squares” (For a history, see: <a href="https://rss.onlinelibrary.wiley.com/doi/full/10.1111/j.1740-9713.2011.00509.x">here</a>).</p>
<p>The following dataset is from “The heredity of height” by Karl Pearson and Alice Lee (1903)<span class="citation" data-cites="pearson1903">(<a href="#ref-pearson1903" role="doc-biblioref"><strong>pearson1903?</strong></a>)</span>. I obtained it from <span class="citation" data-cites="gelman_regression_2020">(<a href="#ref-gelman_regression_2020" role="doc-biblioref">Gelman, Hill, and Vehtari 2020</a>)</span>. Let’s use this dataset to investigate the relationship between mothers’ and daughters’ heights.</p>
<div class="no-row-height column-margin column-container"></div><div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import data</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>df_pearson_lee <span class="ot">&lt;-</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="fu">read.table</span>(</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">url</span>(</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>      <span class="st">"https://raw.githubusercontent.com/avehtari/ROS-Examples/master/PearsonLee/data/MotherDaughterHeights.txt"</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cn">TRUE</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># save</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co"># saveRDS(df_pearson_lee, here::here("data", "df_pearson_lee"))</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Center mother's height for later example</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>df_pearson_lee_centered <span class="ot">&lt;-</span> df_pearson_lee <span class="sc">|&gt;</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">mother_height_c =</span> <span class="fu">as.numeric</span>(<span class="fu">scale</span>(</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    mother_height, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">FALSE</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  )))</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co"># skimr::skim(df_pearson_lee_centered)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Pearson and Lee collected 5,524 observations from mother/daughter height pairs. Let’s examine the data, first by plotting the relationship.</p>
<p>What is happening here?</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># explore pearson lee data</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>explore_md <span class="ot">&lt;-</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> df_pearson_lee_centered, <span class="fu">aes</span>(<span class="at">y =</span> daughter_height, <span class="at">x =</span> mother_height)) <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"The relationship between mothers height and daughter's height"</span>) <span class="sc">+</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Daughter's height"</span>) <span class="sc">+</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Mother's height"</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>()</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>explore_md</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="03-content_files/figure-html/graph_pearson_lee-1.png" class="column-column-page-left img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Is there a linear predictive relationship between these two parameters? In regression we examine the line of best fit.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># regression </span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(daughter_height <span class="sc">~</span> mother_height, <span class="at">data =</span> df_pearson_lee_centered)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># graph</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display column-column-page-left">
<div>
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">&nbsp;</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">daughter height</td>
</tr>
<tr class="even">
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Predictors</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">p</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">29.80</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">28.25&nbsp;–&nbsp;31.35</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">mother height</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.54</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.52&nbsp;–&nbsp;0.57</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">Observations</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">5524</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">R<sup>2</sup> / R<sup>2</sup> adjusted</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.252 / 0.252</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<p>We can plot the coefficient, but in a model with one predictor, this isn’t very informative. However, as we continue in the course, we’ll see that plotting coefficients can be easier than deciphering the numbers in tables. Here are two methods for plotting.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get model parameters</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>t_m1<span class="ot">&lt;-</span>parameters<span class="sc">::</span><span class="fu">model_parameters</span>(m1,  </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">ci =</span> <span class="fl">0.95</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot </span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t_m1) <span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"The relationship between mothers height and daughter's height"</span>) <span class="sc">+</span> </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Daughter's height"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="03-content_files/figure-html/unnamed-chunk-14-1.png" class="column-column-page-left img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="how-do-we-interpret-the-regression-model" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="how-do-we-interpret-the-regression-model">How do we interpret the regression model?</h2>
<p>Let’s write the equation out in mathematics. How do we read this? [^2] [^2]: Later, we’ll prefer a different way of writing regression equations in math. (Note: writing math isn’t math - it’s just encoding the model that we’ve written).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"equatiomatic"</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># extract equation</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">#extract_eq(m1, use_coefs = FALSE)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math display">
\operatorname{daughter\_height} = \alpha + \beta_{1}(\operatorname{mother\_height}) + \epsilon
</span></p>
<p>The math says that the expected daughter’s height in a population is predicted by the average height of the population when mothers’ heights are set to zero units (note, this is impossible - we’ll come back to this) plus <span class="math inline">\beta ~\times</span> units of daughter’s height (inches) for each additional unit of mother’s height (inches)</p>
<p>We can plug the output of the model directly into the equation as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract equation</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co">#extract_eq(m1, use_coefs = TRUE)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math display">
\operatorname{\widehat{daughter\_height}} = 29.8 + 0.54(\operatorname{mother\_height})
</span></p>
<section id="graph-the-relationship-between-mothers-and-daughters-heights" class="level3">
<h3 class="anchored" data-anchor-id="graph-the-relationship-between-mothers-and-daughters-heights">Graph the relationship between mother’s and daughter’s heights</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> ggeffects<span class="sc">::</span><span class="fu">ggpredict</span>(m1, <span class="at">terms =</span> <span class="st">"mother_height"</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>plot_predictions <span class="ot">&lt;-</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    predictions,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">add.data =</span> <span class="cn">TRUE</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">dot.alpha =</span> .<span class="dv">1</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">jitter =</span> <span class="cn">TRUE</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span>   <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Predicted values of daughter's height from the Pearson/Fox 1903 dataset"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="regression-to-predict-beyond-the-range-of-a-dataset" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="regression-to-predict-beyond-the-range-of-a-dataset">Regression to predict beyond the range of a dataset</h3>
<p>Joyte Amge is the world’s shortest woman at 25 inches. Sandy Allen was the world’s tallest woman at 91 inches. What are the expected heights of their daughter and of every intermediary woman in between?</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use the `expand.grid` command to create a sequence of points for mother's height</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>df_expand_grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">mother_height =</span> <span class="fu">c</span>(<span class="dv">25</span><span class="sc">:</span><span class="dv">91</span>))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># use the `predict` function to create a new response</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>df_predict <span class="ot">&lt;-</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(m1,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">type =</span> <span class="st">"response"</span>,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">interval =</span> <span class="st">"confidence"</span>,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">newdata =</span> df_expand_grid)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co"># have a look at the object</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co">#dplyr::glimpse(df_predict)</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co"># create a new dataframe for the new sequence of points for mother's height and the predicted data</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(df_expand_grid, df_predict)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(newdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  mother_height      fit      lwr      upr
1            25 43.42183 42.49099 44.35266
2            26 43.96676 43.06065 44.87288
3            27 44.51170 43.63030 45.39310
4            28 45.05664 44.19995 45.91332
5            29 45.60157 44.76960 46.43355
6            30 46.14651 45.33924 46.95378</code></pre>
</div>
</div>
<p>Graph the predicted results</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># graph the expected results</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>predplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> newdata,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">aes</span>(<span class="at">x =</span> mother_height, <span class="at">y =</span> fit))  <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lwr, <span class="at">ymax =</span> upr), <span class="at">width =</span> .<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">91</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">81</span>))  <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Predicted values for a broader population"</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the two graphs together (making the x and y axis at the same scale </span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"patchwork"</span>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co"># rescale heightplot</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co"># old plot with the new axis and y-axis scales, and remove points</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>plot_height <span class="ot">&lt;-</span> <span class="fu">plot</span>(predplot, <span class="at">add.data =</span> <span class="cn">FALSE</span>) <span class="sc">+</span>   <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="03-content_files/figure-html/predict_new_data-1.png" class="column-column-page-left img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>plot_height_title <span class="ot">&lt;-</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  plot_height <span class="sc">+</span>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">91</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">81</span>)) <span class="sc">+</span>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Predicted values of daughter's height from the Pearson/Fox 1903 dataset"</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># double graph</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>plot_height_title <span class="sc">/</span> predplot  <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">"What do you notice about these relationships?"</span>, <span class="at">tag_levels =</span> <span class="st">"a"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="03-content_files/figure-html/predict_new_data-2.png" class="column-column-page-left img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>A simple method for obtaining the predicted values from your fitted model is to obtain the effects output without producing a graph.</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prediction plots</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># predicted values of mother height on daughter height</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>ggeffects<span class="sc">::</span><span class="fu">ggpredict</span>(m1, <span class="at">terms =</span> <span class="st">"mother_height"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Predicted values of daughter_height

mother_height | Predicted |         95% CI
------------------------------------------
        52.50 |     58.41 | [58.15, 58.66]
        54.50 |     59.50 | [59.29, 59.70]
        57.50 |     61.13 | [60.99, 61.27]
        59.50 |     62.22 | [62.13, 62.32]
        61.50 |     63.31 | [63.25, 63.38]
        63.50 |     64.40 | [64.34, 64.47]
        65.50 |     65.49 | [65.40, 65.59]
        70.50 |     68.22 | [68.01, 68.42]</code></pre>
</div>
</div>
</section>
<section id="non-linear-relationships" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="non-linear-relationships">Non-linear relationships</h3>
<p>Linear regression assumes linearity conditional on a model. Often your data will not be linear!</p>
<p>Consider the following example:</p>
<div class="cell page-columns page-full" data-code_folding="false">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate nonlinear relationship between x and y</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">0.75</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> b[<span class="dv">1</span>] <span class="sc">*</span> <span class="fu">exp</span>(b[<span class="dv">2</span>] <span class="sc">*</span> x))</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x, y)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>ot1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data  =</span> dat1)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co"># performance::check_model(ot1)</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="co"># plot linear effect</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ggeffects<span class="sc">::</span><span class="fu">ggpredict</span>(ot1, <span class="at">terms =</span> <span class="st">"x"</span>),</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">add.data =</span> <span class="cn">TRUE</span>,</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">dot.alpha =</span> .<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="03-content_files/figure-html/unnamed-chunk-21-1.png" class="column-column-page-left img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Non-linear relationship as modelled by a polynomial regression:</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># model: quadratic</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>fit_non_linear <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x <span class="sc">^</span> <span class="dv">2</span>), <span class="at">data  =</span> dat1)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># predictive plot</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ggeffects<span class="sc">::</span><span class="fu">ggpredict</span>(fit_non_linear, <span class="at">terms =</span> <span class="st">"x"</span>),</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">add.data =</span> <span class="cn">TRUE</span>,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">dot.alpha =</span> .<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="03-content_files/figure-html/unnamed-chunk-22-1.png" class="column-column-page-left img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Here is another approach:</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># non-linear regression </span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(splines)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># fit model </span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>fit_non_linear_b <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">poly</span>(x, <span class="dv">2</span>), <span class="at">data  =</span> dat1)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co"># graph model</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  ggeffects<span class="sc">::</span><span class="fu">ggpredict</span>(fit_non_linear_b, <span class="at">terms =</span> <span class="st">"x"</span>),</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">add.data =</span> <span class="cn">TRUE</span>,</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">dot.alpha =</span> .<span class="dv">4</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="03-content_files/figure-html/unnamed-chunk-23-1.png" class="column-column-page-left img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Non-linear relationship as modelled by a general additive model (spline)</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit spline: not specified</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>fit_non_linear_c <span class="ot">&lt;-</span><span class="fu">lm</span>(y <span class="sc">~</span> <span class="fu">bs</span>(x), <span class="at">data  =</span> dat1)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># model parameters: coefficients are not interpretable</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">model_parameters</span>(</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  fit_non_linear_c</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter      | Coefficient |   SE |         95% CI |  t(96) |      p
----------------------------------------------------------------------
(Intercept)    |       -1.90 | 0.03 | [-1.95, -1.84] | -70.74 | &lt; .001
x [1st degree] |        2.60 | 0.06 | [ 2.48,  2.72] |  43.47 | &lt; .001
x [2nd degree] |        3.00 | 0.03 | [ 2.94,  3.06] |  96.12 | &lt; .001
x [3rd degree] |       13.33 | 0.04 | [13.26, 13.40] | 368.37 | &lt; .001</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#performance::check_model(ot2)</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  ggeffects<span class="sc">::</span><span class="fu">ggpredict</span>(fit_non_linear_c, <span class="at">terms =</span> <span class="st">"x"</span>),</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">add.data =</span> <span class="cn">TRUE</span>,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">dot.alpha =</span> .<span class="dv">4</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="03-content_files/figure-html/unnamed-chunk-24-1.png" class="column-column-page-left img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="centering" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="centering">Centering</h3>
<p>Any linear transformation of a predictor is <em>OK</em>. Often we centre (or centre and scale) all indicators, which gives us an interpretable intercept (the expected population average when the other indicators are set their average).</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co"># fit raw data </span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>fit_raw <span class="ot">&lt;-</span> <span class="fu">lm</span>(daughter_height <span class="sc">~</span> mother_height, <span class="at">data =</span> df_pearson_lee_centered)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co"># fit centred data</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>fit_centered <span class="ot">&lt;-</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(daughter_height <span class="sc">~</span> mother_height_c, <span class="at">data =</span> df_pearson_lee_centered)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co"># compare the models</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(fit_raw, fit_centered)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display column-column-page-left">
<div>
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">&nbsp;</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">daughter height</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">daughter height</td>
</tr>
<tr class="even">
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Predictors</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">p</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center;">p</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">29.80</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">28.25&nbsp;–&nbsp;31.35</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">63.86</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">63.80&nbsp;–&nbsp;63.92</td>
<td style="text-align: center;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">mother height</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.54</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.52&nbsp;–&nbsp;0.57</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">mother height c</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.54</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.52&nbsp;–&nbsp;0.57</td>
<td style="text-align: center;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">Observations</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">5524</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">5524</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">R<sup>2</sup> / R<sup>2</sup> adjusted</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.252 / 0.252</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.252 / 0.252</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<p>Graph model</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># graph centred model</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  ggeffects<span class="sc">::</span><span class="fu">ggpredict</span>(fit_centered, <span class="at">terms =</span> <span class="st">"mother_height_c"</span>),</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">add.data =</span> <span class="cn">TRUE</span>,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">dot.alpha =</span> .<span class="dv">4</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="03-content_files/figure-html/unnamed-chunk-26-1.png" class="column-column-page-left img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Note: when fitting a polynomial or any interaction, it is important to center your indicators. We’ll come back to this point in later lectures.</p>
</section>
<section id="model-evaluation" class="level3">
<h3 class="anchored" data-anchor-id="model-evaluation">Model evaluation</h3>
<p>Reviewers will sometime ask you to assess model fit.</p>
<p>A simple, but flawed way to assess accuracy of your model fit is to compare a model with one covariate with a simple intercept-only model and to assess improvement in either the <code>AIC</code> statistic or the <code>BIC</code> statistic. The <code>BIC</code> is similar to the <code>AIC</code> but adds a penalty for extra predictors. An absolute improvement in either statistic of n &gt; 10 is considered to be a “better” model.</p>
<p>We can use the <code>performance</code> package to generate a table that compares model fits.</p>
<div class="cell" data-code_foldign="false" data-code_folding="false">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load library </span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># intercept only</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>fig_intercept_only <span class="ot">&lt;-</span> <span class="fu">lm</span>(daughter_height <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> df_pearson_lee)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co"># covariate added</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>fig_covariate <span class="ot">&lt;-</span> <span class="fu">lm</span>(daughter_height <span class="sc">~</span> mother_height, <span class="at">data =</span> df_pearson_lee)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="co"># evaluate</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">compare_performance</span>(fig_intercept_only, fig_covariate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name               | Model |   AIC (weights) |  AICc (weights) |   BIC (weights) |    R2 | R2 (adj.) |  RMSE | Sigma
--------------------------------------------------------------------------------------------------------------------
fig_intercept_only |    lm | 26300.0 (&lt;.001) | 26300.0 (&lt;.001) | 26313.2 (&lt;.001) | 0.000 |     0.000 | 2.615 | 2.615
fig_covariate      |    lm | 24698.5 (&gt;.999) | 24698.5 (&gt;.999) | 24718.4 (&gt;.999) | 0.252 |     0.252 | 2.262 | 2.262</code></pre>
</div>
</div>
<p>What was the model “improvement?”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># improved fit</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(fig_intercept_only) <span class="sc">-</span> <span class="fu">BIC</span>(fig_covariate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1594.839</code></pre>
</div>
</div>
</section>
<section id="generate-a-report" class="level3">
<h3 class="anchored" data-anchor-id="generate-a-report">Generate a report</h3>
<p>This is easy with the <code>report</code> package</p>
<p>For example:</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report_statistics</span>(fig_covariate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>beta = 29.80, 95% CI [28.25, 31.35], t(5522) = 37.70, p &lt; .001; Std. beta = 7.21e-15, 95% CI [-0.02, 0.02]
beta = 0.54, 95% CI [0.52, 0.57], t(5522) = 43.12, p &lt; .001; Std. beta = 0.50, 95% CI [0.48, 0.52]</code></pre>
</div>
</div>
<p>Or, if you want a longer report:</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(fig_covariate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Use <code>statistically significant</code> in place of <code>significant</code>. This will avoid misleading your audience into thinking your result is important when what you intend to communicate is that it is reliable.</p>
</section>
</section>
<section id="assumptions-of-regression" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="assumptions-of-regression">Assumptions of Regression</h2>
<p>From Gelman and Hill <span class="citation" data-cites="gelman2006">(<a href="#ref-gelman2006" role="doc-biblioref">Gelman and Hill 2006</a>)</span></p>
<div class="no-row-height column-margin column-container"></div><ol type="1">
<li><p><strong>Validity</strong></p>
<blockquote class="blockquote">
<p>The most important is that the data you are analyzing should map to the research question you are trying to answer <span class="citation" data-cites="gelman_regression_2020">(<a href="#ref-gelman_regression_2020" role="doc-biblioref">Gelman, Hill, and Vehtari 2020, 152</a>)</span></p>
</blockquote></li>
<li><p><strong>Representativeness</strong></p>
<blockquote class="blockquote">
<p>A regression model is fit to data and is used to make inferences about a larger population, hence the implicit assumption in interpreting regression coefficients is that the sample is representative of the population. <span class="citation" data-cites="gelman_regression_2020">(<a href="#ref-gelman_regression_2020" role="doc-biblioref">Gelman, Hill, and Vehtari 2020, 153</a>)</span><br>
</p>
</blockquote></li>
<li><p><strong>Linearity</strong></p>
<blockquote class="blockquote">
<p>The most important mathematical assumption of the linear regression model is that its deterministic component is a linear function of the separate predictors: y = β0 + β1x1 + β2x2 +···. If additivity is violated, it might make sense to transform the data (for example, if y = abc, then log y = log a + log b + log c) or to add interactions. If linearity is violated, perhaps a predictor should be put in as 1/x or log(x) instead of simply linearly. Or a more complicated relationship could be expressed using a nonlinear function such as a spline or Gaussian process, <span class="citation" data-cites="gelman_regression_2020">(<a href="#ref-gelman_regression_2020" role="doc-biblioref">Gelman, Hill, and Vehtari 2020, 153</a>)</span></p>
</blockquote></li>
<li><p><strong>Independence of errors</strong></p>
<blockquote class="blockquote">
<p>The simple regression model assumes that the errors from the prediction line are independent, an assumption that is violated in time series, spatial, and multilevel settings <span class="citation" data-cites="gelman_regression_2020">(<a href="#ref-gelman_regression_2020" role="doc-biblioref">Gelman, Hill, and Vehtari 2020, 153</a>)</span></p>
</blockquote></li>
<li><p><strong>Equal variance of errors</strong></p></li>
</ol>
<div class="no-row-height column-margin column-container"></div><div class="page-columns page-full"><blockquote class="blockquote">
<p>…unequal variance does not affect the most important aspect of a regression model, which is the form of the predictors <span class="citation" data-cites="gelman_regression_2020">(<a href="#ref-gelman_regression_2020" role="doc-biblioref">Gelman, Hill, and Vehtari 2020, 153</a>)</span></p>
</blockquote><div class="no-row-height column-margin column-container"></div></div>
<ol start="5" type="1">
<li><strong>Normality of errors (statistical independence)</strong></li>
</ol>
<div class="page-columns page-full"><blockquote class="blockquote">
<p>The regression assumption that is generally least important is that the errors are normally distributed. In fact, for the purpose of estimating the regression line (as compared to predicting individual data points), the assumption of normality is barely important at all. Thus, in contrast to many regression textbooks, we do not recommend diagnostics of the normality of re-gression residuals. <span class="citation" data-cites="gelman2006">(<a href="#ref-gelman2006" role="doc-biblioref">Gelman and Hill 2006, 46</a>)</span></p>
</blockquote><div class="no-row-height column-margin column-container"></div></div>
<div class="page-columns page-full"><blockquote class="blockquote">
<p>A good way to diagnose violations of some of the assumptions just considered (importantly, linearity) is to plot the residuals versus fitted values or simply individual predictors.<span class="citation" data-cites="gelman2006">(<a href="#ref-gelman2006" role="doc-biblioref">Gelman and Hill 2006, 46</a>)</span></p>
</blockquote><div class="no-row-height column-margin column-container"><div id="ref-gelman2006" class="csl-entry" role="listitem">
Gelman, Andrew, and Jennifer Hill. 2006. <em>Data Analysis Using Regression and Multilevel/Hierarchical Models</em>. Cambridge university press.
</div></div></div>
<section id="common-confusions" class="level3">
<h3 class="anchored" data-anchor-id="common-confusions">Common Confusions</h3>
<section id="regressions-do-not-automatically-give-us-effects" class="level4">
<h4 class="anchored" data-anchor-id="regressions-do-not-automatically-give-us-effects">Regressions do not automatically give us “effects”</h4>
<p><strong>People use the work “effect”, but that is not what regression gives us, by default.</strong></p>
</section>
<section id="normality-assumption" class="level4">
<h4 class="anchored" data-anchor-id="normality-assumption">“Normality Assumption”</h4>
<p>Gelman and Hill note that the “normality” assumption is the least important. The assumption pertains to the normality of residuals.</p>
</section>
<section id="statistical-independence" class="level4">
<h4 class="anchored" data-anchor-id="statistical-independence">Statistical Independence</h4>
<p>This is the motivation for doing multi-level modelling: to condition on dependencies in the data. However, multi-level modelling can produce new problems if the error terms in the model are not independent of the outcome.</p>
</section>
<section id="external-validity-wrong-population" class="level4">
<h4 class="anchored" data-anchor-id="external-validity-wrong-population">External Validity (wrong population)</h4>
<p>We sample from undergraduates, but infer about the human population.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>NOTE</strong>: The concept of “better model fit” is relative to our interests and purposes. A better (lower) AIC statistic does not tell us whether a model is better for better causal inference. We must assess whether a model satisfies the assumptions necessary for valid causal inference.</p>
</div>
</div>
</section>
</section>
</section>
<section id="simulation-demonstration-1-how-regression-coefficients-mislead" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="simulation-demonstration-1-how-regression-coefficients-mislead">Simulation Demonstration 1: How Regression Coefficients Mislead</h2>
<section id="methodology" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="methodology">Methodology</h4>
<ol type="1">
<li><p><strong>Data Generation</strong>: we simulate a dataset for 1,000 individuals, where religious service attendance (<span class="math inline">A</span>) affects wealth (<span class="math inline">L</span>), which in turn affects charitable donations (<span class="math inline">Y</span>). The simulation is based on predefined parameters that establish L as a mediator between <span class="math inline">A</span> and <span class="math inline">Y</span>.</p></li>
<li><p><strong>Parameter Definitions</strong>:</p>
<ul>
<li>The probability of religious service (<span class="math inline">A</span>) is set at 0.5.</li>
<li>The effect of <span class="math inline">A</span> on <span class="math inline">L</span> (wealth) is given by <span class="math inline">\beta = 2</span>.</li>
<li>The effect of <span class="math inline">L</span> on <span class="math inline">Y</span> (charity) is given by <span class="math inline">\delta = 1.5</span>.</li>
<li>Standard deviations for <span class="math inline">L</span> and <span class="math inline">Y</span> are set at 1 and 1.5, respectively.</li>
</ul></li>
<li><p><strong>Model Specifications</strong>:</p>
<ul>
<li><strong>Model 1</strong> (Correct Assumption): considerss a linear regression model assuming <span class="math inline">L</span> as a mediator, including <span class="math inline">A</span> and <span class="math inline">L</span> as regressors on <span class="math inline">Y</span>. This model aligns with the data-generating process and correctly identifies L as a mediator. According to the rules of d-separation (last week): <strong>to identify the total effect of <span class="math inline">A</span> on <span class="math inline">Y</span> we must not include <span class="math inline">L</span></strong></li>
<li><strong>Model 2</strong> (Correct model): This fits a linear regression model that includes only <span class="math inline">A</span> as a regressor on <span class="math inline">Y</span> and omits the mediator <span class="math inline">L</span>. This model assesses the direct effect of <span class="math inline">A</span> on <span class="math inline">Y</span> without accounting for mediation.</li>
</ul></li>
<li><p><strong>Analysis and Comparison</strong>: the analysis compares the estimated effects of <span class="math inline">A</span> on <span class="math inline">Y</span> under both model specifications. By including <span class="math inline">L</span> as a predictor in Model 1, we induce mediation bias. Whereas Model 2 correctly excludes <span class="math inline">L</span> from the model.</p></li>
<li><p><strong>Presentation</strong>: the results are displayed in a comparative table formatted for publication. The table contrasts the regression coefficients and significance levels obtained under each model.</p></li>
</ol>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulation seed</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co">#  reproducibility</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># define the parameters </span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">1000</span> <span class="co"># Number of observations</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fl">0.5</span>  <span class="co"># Probability of A = 1 </span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="dv">0</span> <span class="co"># Intercept for L </span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">=</span> <span class="dv">2</span>  <span class="co"># Effect of A on L </span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>gamma <span class="ot">=</span> <span class="dv">1</span> <span class="co"># Intercept for Y </span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>delta <span class="ot">=</span> <span class="fl">1.5</span> <span class="co"># Effect of L on Y</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>sigma_L <span class="ot">=</span> <span class="dv">1</span> <span class="co"># Standard deviation of L</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>sigma_Y <span class="ot">=</span> <span class="fl">1.5</span> <span class="co"># Standard deviation of Y</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate the data: fully mediated effect by L</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>A <span class="ot">=</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, p) <span class="co"># binary exposure variable</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>L <span class="ot">=</span> alpha <span class="sc">+</span> beta<span class="sc">*</span>A <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, sigma_L) <span class="co"># mediator L affect by A</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">=</span> gamma <span class="sc">+</span> delta<span class="sc">*</span>L <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, sigma_Y) <span class="co"># Y affected only by L,</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a><span class="co"># make the data frame</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">A =</span> A, <span class="at">L =</span> L, <span class="at">Y =</span> Y)</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a><span class="co"># fit regression in which L is assumed to be a mediator</span></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a><span class="co"># (cross-sectional data is consistent with this model)</span></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>example_fit_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>( Y <span class="sc">~</span> A <span class="sc">+</span> L, <span class="at">data =</span> data)</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a><span class="co"># fit regression in which L is assumed to be a mediator</span></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a><span class="co"># (cross-sectional data is also consistent with this model)</span></span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>example_fit_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>( Y <span class="sc">~</span> A, <span class="at">data =</span> data)</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a><span class="co"># create gtsummary tables for each regression model</span></span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>table1 <span class="ot">&lt;-</span> gtsummary<span class="sc">::</span><span class="fu">tbl_regression</span>(example_fit_1)</span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>table2 <span class="ot">&lt;-</span> gtsummary<span class="sc">::</span><span class="fu">tbl_regression</span>(example_fit_2)</span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a><span class="co"># merge the tables for comparison</span></span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>table_comparison <span class="ot">&lt;-</span> gtsummary<span class="sc">::</span><span class="fu">tbl_merge</span>(</span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(table1, table2),</span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">tab_spanner =</span> <span class="fu">c</span>(<span class="st">"Model: Wealth assumed confounder"</span>, </span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Model: Wealth assumed to be a mediator"</span>)</span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a><span class="co"># make latex table (for publication)</span></span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>markdown_table_0 <span class="ot">&lt;-</span> <span class="fu">as_kable_extra</span>(table_comparison, </span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">format =</span> <span class="st">"markdown"</span>, </span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">booktabs =</span> <span class="cn">TRUE</span>)</span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a><span class="co"># print markdown table (note, you might prefer "latex" or another format)                                </span></span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a>markdown_table_0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display column-column-page-left page-columns page-full">
<div class="page-columns page-full">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">

<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Model: Wealth assumed confounder
</div></th>
<th colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Model: Wealth assumed to be a mediator
</div></th>
</tr>
<tr class="odd">
<th style="text-align: left;" data-quarto-table-cell-role="th">Characteristic</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Beta</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">95% CI</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">p-value</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Beta</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">95% CI</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">A</td>
<td style="text-align: center;">-0.27</td>
<td style="text-align: center;">-0.53, -0.01</td>
<td style="text-align: center;">0.043</td>
<td style="text-align: center;">2.9</td>
<td style="text-align: center;">2.6, 3.2</td>
<td style="text-align: center;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">L</td>
<td style="text-align: center;">1.6</td>
<td style="text-align: center;">1.5, 1.7</td>
<td style="text-align: center;">&lt;0.001</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody><tfoot>
<tr class="even">
<td style="text-align: left; padding: 0;"><sup>1</sup> CI = Confidence Interval</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tfoot>

</table>


<div class="quarto-table-caption margin-caption">Code for a simulation of a data generating process in which the effect of exercise (L) fully mediates the effect of greenspace (A) on happiness (Y).</div></div>
</div>
</div>
</section>
<section id="compare-model-fits" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="compare-model-fits">Compare model fits</h3>
<section id="by-all-metrics-model-1-fits-better-but-it-is-confounded" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="by-all-metrics-model-1-fits-better-but-it-is-confounded">By all metrics, model 1 fits better but it is confounded</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">compare_performance</span>(example_fit_1, example_fit_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name          | Model |  AIC (weights) | AICc (weights) |  BIC (weights) |    R2 | R2 (adj.) |  RMSE | Sigma
------------------------------------------------------------------------------------------------------------
example_fit_1 |    lm | 3620.6 (&gt;.999) | 3620.6 (&gt;.999) | 3640.2 (&gt;.999) | 0.682 |     0.682 | 1.473 | 1.475
example_fit_2 |    lm | 4392.2 (&lt;.001) | 4392.2 (&lt;.001) | 4406.9 (&lt;.001) | 0.312 |     0.311 | 2.169 | 2.171</code></pre>
</div>
</div>
<p>Model 1 exhibits mediator bias, but it has a considerably higher <span class="math inline">R^2</span>, and a lower BIC</p>
<section id="focussing-on-the-bic-lower-is-better-model-1-fits-better-but-it-is-confounded." class="level5 page-columns page-full">
<h5 class="anchored" data-anchor-id="focussing-on-the-bic-lower-is-better-model-1-fits-better-but-it-is-confounded.">Focussing on the BIC (lower is better) Model 1 fits better, but it is confounded.</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(example_fit_1) <span class="sc">-</span> <span class="fu">BIC</span>(example_fit_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -766.643</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>In this simulation, we discovered that if we assess “effect” by “model fit” we will get the wrong <em>sign</em> for the coefficient of interest. The use of model fit perpetuates the <em>causality crisis</em> in psychological science <span class="citation" data-cites="bulbulia2022">(<a href="#ref-bulbulia2022" role="doc-biblioref">Bulbulia 2022</a>)</span>. Few are presently aware of this crisis. Causal diagrams show us how we can do better.</p>
</div>
</div>
<div class="no-row-height column-margin column-container"></div></section>
</section>
</section>
</section>
<section id="simulation-demonstration-2-how-regression-coefficients-mislead" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="simulation-demonstration-2-how-regression-coefficients-mislead">Simulation Demonstration 2: How Regression Coefficients Mislead</h2>
<section id="methodology-1" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="methodology-1">Methodology</h4>
<ol type="1">
<li><p><strong>Data Generation</strong>: simulate a dataset for 1,000 individuals, where religious service attendance (<span class="math inline">A</span>) affects wealth (<span class="math inline">L</span>),and chartitable donations charitable donations (<span class="math inline">Y</span>) also affects wealth <span class="math inline">L</span>, but <span class="math inline">A</span> and <span class="math inline">Y</span> are not causally related</p></li>
<li><p><strong>Parameter Definitions</strong>:</p>
<ul>
<li>The probability of religious service (<span class="math inline">A</span>) is set at 0.5.</li>
<li><span class="math inline">Y</span> is has a mean <span class="math inline">0</span> and sd = <span class="math inline">1</span>, and is independent of <span class="math inline">A</span>.</li>
<li><span class="math inline">L</span> is a linear function of <span class="math inline">A</span> and <span class="math inline">Y</span>.</li>
</ul></li>
<li><p><strong>Model Specifications</strong>:</p>
<ul>
<li><strong>Model 1</strong> (Correct Assumption): do not control for <span class="math inline">L</span></li>
<li><strong>Model 2</strong> (Correct model): control for <span class="math inline">L</span></li>
</ul></li>
<li><p><strong>Analysis and Comparison</strong>: compare models.</p></li>
<li><p><strong>Presentation</strong>: a table.</p></li>
</ol>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulation seed</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co">#  reproducibility</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># define parameters </span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">1000</span> <span class="co"># Number of observations</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fl">0.5</span>  <span class="co"># Probability of A = 1 </span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="dv">0</span> <span class="co"># Intercept for L</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate the data</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>A_1 <span class="ot">=</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, p) <span class="co"># binary exposure variable</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>Y_1 <span class="ot">=</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>) <span class="co"># Y affected only by L,</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>L_2 <span class="ot">=</span> <span class="fu">rnorm</span>(n, A <span class="sc">+</span> Y)</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a><span class="co"># make the data frame</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>data_collider <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">A =</span> A_1, <span class="at">L =</span> L_2, <span class="at">Y =</span> Y_1)</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a><span class="co"># fit regression in which L is assumed to be a mediator</span></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a><span class="co"># (cross-sectional data is consistent with this model)</span></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>collider_example_fit_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>( Y <span class="sc">~</span> A <span class="sc">+</span> L, <span class="at">data =</span> data_collider)</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a><span class="co"># fit regression in which L is assumed to be a mediator</span></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a><span class="co"># (cross-sectional data is also consistent with this model)</span></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>collider_example_fit_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>( Y <span class="sc">~</span> A, <span class="at">data =</span> data_collider)</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a><span class="co"># create gtsummary tables for each regression model</span></span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>collider_table1 <span class="ot">&lt;-</span> gtsummary<span class="sc">::</span><span class="fu">tbl_regression</span>(collider_example_fit_1)</span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>collider_table2 <span class="ot">&lt;-</span> gtsummary<span class="sc">::</span><span class="fu">tbl_regression</span>(collider_example_fit_2)</span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a><span class="co"># merge the tables for comparison</span></span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>collider_table_comparison <span class="ot">&lt;-</span> gtsummary<span class="sc">::</span><span class="fu">tbl_merge</span>(</span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(collider_table1, collider_table2),</span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">tab_spanner =</span> <span class="fu">c</span>(<span class="st">"Model: Wealth assumed confounder"</span>, </span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Model: Wealth not assumed to be a mediator"</span>)</span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a><span class="co"># make latex table (for publication)</span></span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a>markdown_table_1 <span class="ot">&lt;-</span> <span class="fu">as_kable_extra</span>(collider_table_comparison, </span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">format =</span> <span class="st">"markdown"</span>, </span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">booktabs =</span> <span class="cn">TRUE</span>)</span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a><span class="co"># print markdown table (note, you might prefer "latex" or another format)                                </span></span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a>collider_table_comparison</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display column-column-page-left page-columns page-full">
<div class="page-columns page-full">
<div id="gnvxvysfyx" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;" class="page-columns page-full">
<style>#gnvxvysfyx table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#gnvxvysfyx thead, #gnvxvysfyx tbody, #gnvxvysfyx tfoot, #gnvxvysfyx tr, #gnvxvysfyx td, #gnvxvysfyx th {
  border-style: none;
}

#gnvxvysfyx p {
  margin: 0;
  padding: 0;
}

#gnvxvysfyx .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#gnvxvysfyx .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#gnvxvysfyx .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#gnvxvysfyx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#gnvxvysfyx .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gnvxvysfyx .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gnvxvysfyx .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gnvxvysfyx .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#gnvxvysfyx .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#gnvxvysfyx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#gnvxvysfyx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#gnvxvysfyx .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#gnvxvysfyx .gt_spanner_row {
  border-bottom-style: hidden;
}

#gnvxvysfyx .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#gnvxvysfyx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#gnvxvysfyx .gt_from_md > :first-child {
  margin-top: 0;
}

#gnvxvysfyx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#gnvxvysfyx .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#gnvxvysfyx .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#gnvxvysfyx .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#gnvxvysfyx .gt_row_group_first td {
  border-top-width: 2px;
}

#gnvxvysfyx .gt_row_group_first th {
  border-top-width: 2px;
}

#gnvxvysfyx .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gnvxvysfyx .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#gnvxvysfyx .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#gnvxvysfyx .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gnvxvysfyx .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gnvxvysfyx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#gnvxvysfyx .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#gnvxvysfyx .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#gnvxvysfyx .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gnvxvysfyx .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gnvxvysfyx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gnvxvysfyx .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gnvxvysfyx .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gnvxvysfyx .gt_left {
  text-align: left;
}

#gnvxvysfyx .gt_center {
  text-align: center;
}

#gnvxvysfyx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#gnvxvysfyx .gt_font_normal {
  font-weight: normal;
}

#gnvxvysfyx .gt_font_bold {
  font-weight: bold;
}

#gnvxvysfyx .gt_font_italic {
  font-style: italic;
}

#gnvxvysfyx .gt_super {
  font-size: 65%;
}

#gnvxvysfyx .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#gnvxvysfyx .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#gnvxvysfyx .gt_indent_1 {
  text-indent: 5px;
}

#gnvxvysfyx .gt_indent_2 {
  text-indent: 10px;
}

#gnvxvysfyx .gt_indent_3 {
  text-indent: 15px;
}

#gnvxvysfyx .gt_indent_4 {
  text-indent: 20px;
}

#gnvxvysfyx .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">

<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header gt_col_headings gt_spanner_row">
<th rowspan="2" id="<strong>Characteristic</strong>" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th colspan="3" id="Model: Wealth assumed confounder" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner">Model: Wealth assumed confounder</span></th>
<th colspan="3" id="Model: Wealth not assumed to be a mediator" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner">Model: Wealth not assumed to be a mediator</span></th>
</tr>
<tr class="odd gt_col_headings">
<th id="<strong>Beta</strong>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Beta</strong></th>
<th id="<strong>95% CI</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
<th id="<strong>p-value</strong>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
<th id="<strong>Beta</strong>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Beta</strong></th>
<th id="<strong>95% CI</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
<th id="<strong>p-value</strong>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">A</td>
<td class="gt_row gt_center" headers="estimate_1">-0.73</td>
<td class="gt_row gt_center" headers="ci_1">-0.85, -0.60</td>
<td class="gt_row gt_center" headers="p.value_1">&lt;0.001</td>
<td class="gt_row gt_center" headers="estimate_2">0.00</td>
<td class="gt_row gt_center" headers="ci_2">-0.12, 0.13</td>
<td class="gt_row gt_center" headers="p.value_2">&gt;0.9</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">L</td>
<td class="gt_row gt_center" headers="estimate_1">0.19</td>
<td class="gt_row gt_center" headers="ci_1">0.17, 0.21</td>
<td class="gt_row gt_center" headers="p.value_1">&lt;0.001</td>
<td class="gt_row gt_center" headers="estimate_2"><br>
</td>
<td class="gt_row gt_center" headers="ci_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="even">
<td colspan="7" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> CI = Confidence Interval</td>
</tr>
</tfoot>

</table>

<div class="quarto-table-caption margin-caption">L is a collider of A and Y.</div></div>
</div>
</div>
</div>
</section>
<section id="compare-model-fits-1" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="compare-model-fits-1">Compare model fits</h3>
<section id="by-all-metrics-model-1-fits-better-but-it-is-confounded." class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="by-all-metrics-model-1-fits-better-but-it-is-confounded.">By all metrics, model 1 fits better but it is confounded.</h4>
<p><span class="math inline">A</span> is not causally associated with <span class="math inline">Y</span>. We generated the data so we know. However, the confounded model shows a better fit, and in this model the coefficient for <span class="math inline">A</span> is significant (and negative).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">compare_performance</span>(collider_example_fit_1, collider_example_fit_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name                   | Model |  AIC (weights) | AICc (weights) |  BIC (weights) |        R2 |  R2 (adj.) |  RMSE | Sigma
--------------------------------------------------------------------------------------------------------------------------
collider_example_fit_1 |    lm | 2474.5 (&gt;.999) | 2474.6 (&gt;.999) | 2494.2 (&gt;.999) |     0.312 |      0.310 | 0.831 | 0.832
collider_example_fit_2 |    lm | 2845.9 (&lt;.001) | 2845.9 (&lt;.001) | 2860.6 (&lt;.001) | 2.784e-06 | -9.992e-04 | 1.001 | 1.002</code></pre>
</div>
</div>
<section id="again-the-bic-for-lower-is-better-model-1-fits-better-but-it-is-entirely-confounded." class="level5 page-columns page-full">
<h5 class="anchored" data-anchor-id="again-the-bic-for-lower-is-better-model-1-fits-better-but-it-is-entirely-confounded.">Again, the BIC for (lower is better) Model 1 fits better, but it is entirely confounded.</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(collider_example_fit_1) <span class="sc">-</span> <span class="fu">BIC</span>(collider_example_fit_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -366.4564</code></pre>
</div>
</div>
<p>How does collider bias work? If we know that someone is <em>not</em> attending church, if they are charitable then we can <em>predict</em> they are wealthy. Similarly if we know someone is not wealthy but charitable, we can <em>predict</em> they attend religious service.</p>
<p>However, in this simulation, we know the religion and wealth are <em>not</em> casually associated because we have simulated the data.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>In this simulation, we discovered that if we assess “effect” by “model fit”, we get the **wrong scientific inference<em>. The use of model fit perpetuates the </em>causality crisis* in psychological science <span class="citation" data-cites="bulbulia2022">(<a href="#ref-bulbulia2022" role="doc-biblioref">Bulbulia 2022</a>)</span>. Let’s do better.</p>
</div>
</div>
<div class="no-row-height column-margin column-container"><div id="ref-bulbulia2022" class="csl-entry" role="listitem">
Bulbulia, J. A. 2022. <span>“A Workflow for Causal Inference in Cross-Cultural Psychology.”</span> <em>Religion, Brain &amp; Behavior</em> 0 (0): 1–16. <a href="https://doi.org/10.1080/2153599X.2022.2070245">https://doi.org/10.1080/2153599X.2022.2070245</a>.
</div></div></section>
</section>
</section>
</section>
<section id="resources-on-regression-that-do-not-perpetuate-the-causality-crisis" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="resources-on-regression-that-do-not-perpetuate-the-causality-crisis">Resources on Regression that Do Not Perpetuate The Causality Crisis</h2>
<ol type="1">
<li><strong>Statistical Rethinking</strong> <span class="citation" data-cites="mcelreath2020">(<a href="#ref-mcelreath2020" role="doc-biblioref">McElreath 2020</a>)</span></li>
<li><strong>Regression and Other Stories</strong> <span class="citation" data-cites="gelman_regression_2020">(<a href="#ref-gelman_regression_2020" role="doc-biblioref">Gelman, Hill, and Vehtari 2020</a>)</span></li>
</ol>
<div class="no-row-height column-margin column-container"><div id="ref-mcelreath2020" class="csl-entry" role="listitem">
McElreath, Richard. 2020. <em>Statistical Rethinking: A <span>B</span>ayesian Course with Examples in r and Stan</em>. CRC press.
</div><div id="ref-gelman_regression_2020" class="csl-entry" role="listitem">
Gelman, Andrew, Jennifer Hill, and Aki Vehtari. 2020. <em>Regression and Other Stories</em>. Cambridge University Press.
</div></div></section>
<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<section id="libraries" class="level3">
<h3 class="anchored" data-anchor-id="libraries">Libraries</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="get-data" class="level3">
<h3 class="anchored" data-anchor-id="get-data">Get data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># package with data</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(margot)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"df_nz"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="import-pearson-and-lee-mothers-and-daughters-data" class="level3">
<h3 class="anchored" data-anchor-id="import-pearson-and-lee-mothers-and-daughters-data">Import <code>Pearson and Lee</code> mother’s and daughters data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>df_pearson_lee <span class="ot">&lt;-</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="fu">read.table</span>(</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">url</span>(</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>      <span class="st">"https://raw.githubusercontent.com/avehtari/ROS-Examples/master/PearsonLee/data/MotherDaughterHeights.txt"</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cn">TRUE</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Center mother's height for later example</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>df_pearson_lee <span class="ot">&lt;-</span> df_pearson_lee<span class="sc">|&gt;</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">mother_height_c =</span> <span class="fu">as.numeric</span>(<span class="fu">scale</span>(</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>    mother_height, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">FALSE</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  )))</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a><span class="co"># dplyr::glimpse(df_pearson_lee)</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a><span class="co"># In 1903, Pearson and Lee collected 5,524 observations from mother/daughter height pairs. See lecture 5 for details</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="note" class="level3">
<h3 class="anchored" data-anchor-id="note">Note</h3>
<p><strong>For all exercises below, use only the 2018 wave of the <code>df_nz</code> dataset.</strong></p>
<p>colnames(df_nz) ## Q1. Create a descriptive table and a descriptive graph for the <code>hlth_weight</code> and <code>hlth_height</code> variables in the <code>df_nz</code> dataset</p>
<p>Select <code>hlth_height</code>, <code>hlth_weight</code> from the nz dataset.</p>
<p>Filter only the 2018 wave.</p>
<p>Create a descriptive table and graph these two variables</p>
<p>Annotate your workflow (at each step, describe what you are doing and why).</p>
</section>
</section>
<section id="q2.-regression-height-weight-and-report-results" class="level2">
<h2 class="anchored" data-anchor-id="q2.-regression-height-weight-and-report-results">Q2. Regression height ~ weight and report results</h2>
<p>Using the <code>df_nz</code> dataset, write a regression model for height as predicted by weight.</p>
<p>Create a table for your results.</p>
<p>Create a graphs/graphs to clarify the results of your regression model.</p>
<p>Briefly report your results.</p>
</section>
<section id="q3.-regress-height-male-and-report-results" class="level2">
<h2 class="anchored" data-anchor-id="q3.-regress-height-male-and-report-results">Q3. Regress height ~ male and report results</h2>
<p>Using the <code>df_nz</code> dataset, write a regression model for height as predicted by <code>male</code></p>
<p>Create a table for your results.</p>
<p>Create a graphs/graphs to clarify the results of your regression model.</p>
<p>Briefly report your results.</p>
</section>
<section id="q4.-regression-to-predict" class="level2">
<h2 class="anchored" data-anchor-id="q4.-regression-to-predict">Q4. Regression to predict</h2>
<p>Using the regression coefficients from the Pearson and Lee 1903 dataset, predict the heights of daughters of women in the <code>df_nz</code> dataset.</p>
</section>
<section id="q5.-bonus" class="level2">
<h2 class="anchored" data-anchor-id="q5.-bonus">Q5. Bonus</h2>
<p>On average, how much taller or shorter are women in New Zealand as sampled in 2019 <code>df_nz</code> dataset compared with women in 1903 as sampled in the Pearson and Lee dataset.</p>
<p>Clarify your inference.</p>
</section>
<section id="solutions-set-up" class="level2">
<h2 class="anchored" data-anchor-id="solutions-set-up">Solutions: Set Up</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="do">### libraries</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"patchwork"</span>)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"lubridate"</span>)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"kableExtra"</span>)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"gtsummary"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get data</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"margot"</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"df_nz"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import `Pearson and Lee` mother's and daughters data</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co"># In 1903, Pearson and Lee collected 5,524 observations from mother/daughter height pairs. </span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>df_pearson_lee <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">read.table</span>(</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">url</span>(</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"https://raw.githubusercontent.com/avehtari/ROS-Examples/master/PearsonLee/data/MotherDaughterHeights.txt"</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">header =</span> <span class="cn">TRUE</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Center mother's height for later example</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>df_pearson_lee <span class="ot">&lt;-</span> df_pearson_lee<span class="sc">|&gt;</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">mother_height_c =</span> <span class="fu">as.numeric</span>(<span class="fu">scale</span>(</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>    mother_height, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">FALSE</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>  )))</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a><span class="co"># dplyr::glimpse(df_pearson_lee)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="solution-q1-descriptive-table" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="solution-q1-descriptive-table">Solution Q1 descriptive table</h2>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># required libraries</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(margot)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="co"># select focal variables and rename them for clarity</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>df_nzdat <span class="ot">&lt;-</span> df_nz  <span class="sc">|&gt;</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(wave <span class="sc">==</span> <span class="dv">2019</span>) <span class="sc">|&gt;</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(hlth_weight, hlth_height, male) <span class="sc">|&gt;</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">weight =</span> hlth_weight,</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">height =</span> hlth_height) <span class="sc">|&gt;</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(weight, height, male) <span class="sc">|&gt;</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">weight_c =</span> <span class="fu">as.numeric</span>(<span class="fu">scale</span>(</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>    weight, <span class="at">scale =</span> F, <span class="at">center =</span> <span class="cn">TRUE</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>  )))</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a><span class="co"># create table</span></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>df_nzdat <span class="sc">|&gt;</span> </span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(weight,</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>                height) <span class="sc">|&gt;</span> </span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>  gtsummary<span class="sc">::</span><span class="fu">tbl_summary</span>(</span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">#by = wave,</span></span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">statistic =</span> <span class="fu">list</span>(</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">all_continuous</span>() <span class="sc">~</span> <span class="st">"{mean} ({sd})"</span>,</span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">all_categorical</span>() <span class="sc">~</span> <span class="st">"{n} / {N} ({p}%)"</span></span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">digits =</span> <span class="fu">all_continuous</span>() <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">missing_text =</span> <span class="st">"(Missing)"</span></span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">|&gt;</span></span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_labels</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display column-column-page-left">
<div>
<div id="prvxiiaybr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#prvxiiaybr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#prvxiiaybr thead, #prvxiiaybr tbody, #prvxiiaybr tfoot, #prvxiiaybr tr, #prvxiiaybr td, #prvxiiaybr th {
  border-style: none;
}

#prvxiiaybr p {
  margin: 0;
  padding: 0;
}

#prvxiiaybr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#prvxiiaybr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#prvxiiaybr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#prvxiiaybr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#prvxiiaybr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#prvxiiaybr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#prvxiiaybr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#prvxiiaybr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#prvxiiaybr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#prvxiiaybr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#prvxiiaybr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#prvxiiaybr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#prvxiiaybr .gt_spanner_row {
  border-bottom-style: hidden;
}

#prvxiiaybr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#prvxiiaybr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#prvxiiaybr .gt_from_md > :first-child {
  margin-top: 0;
}

#prvxiiaybr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#prvxiiaybr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#prvxiiaybr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#prvxiiaybr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#prvxiiaybr .gt_row_group_first td {
  border-top-width: 2px;
}

#prvxiiaybr .gt_row_group_first th {
  border-top-width: 2px;
}

#prvxiiaybr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#prvxiiaybr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#prvxiiaybr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#prvxiiaybr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#prvxiiaybr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#prvxiiaybr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#prvxiiaybr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#prvxiiaybr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#prvxiiaybr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#prvxiiaybr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#prvxiiaybr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#prvxiiaybr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#prvxiiaybr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#prvxiiaybr .gt_left {
  text-align: left;
}

#prvxiiaybr .gt_center {
  text-align: center;
}

#prvxiiaybr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#prvxiiaybr .gt_font_normal {
  font-weight: normal;
}

#prvxiiaybr .gt_font_bold {
  font-weight: bold;
}

#prvxiiaybr .gt_font_italic {
  font-style: italic;
}

#prvxiiaybr .gt_super {
  font-size: 65%;
}

#prvxiiaybr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#prvxiiaybr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#prvxiiaybr .gt_indent_1 {
  text-indent: 5px;
}

#prvxiiaybr .gt_indent_2 {
  text-indent: 10px;
}

#prvxiiaybr .gt_indent_3 {
  text-indent: 15px;
}

#prvxiiaybr .gt_indent_4 {
  text-indent: 20px;
}

#prvxiiaybr .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="<strong>Characteristic</strong>" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="<strong>N = 20,000</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>N = 20,000</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">weight</td>
<td class="gt_row gt_center" headers="stat_0">79.24 (18.42)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;(Missing)</td>
<td class="gt_row gt_center" headers="stat_0">5,655</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">height</td>
<td class="gt_row gt_center" headers="stat_0">1.70 (0.10)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;(Missing)</td>
<td class="gt_row gt_center" headers="stat_0">5,655</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="2" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> Mean (SD)</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</div>
<p>Here’s another approach:</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># libs we need</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(table1)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(margot)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="co"># filter 2019 wave</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>df_nz_1 <span class="ot">&lt;-</span> df_nz<span class="sc">|&gt;</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(wave <span class="sc">==</span> <span class="dv">2019</span>)</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a><span class="co"># nicer labels</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>table1<span class="sc">::</span><span class="fu">label</span>(df_nz_1<span class="sc">$</span>hlth_weight)     <span class="ot">&lt;-</span> <span class="st">"Weight"</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>table1<span class="sc">::</span><span class="fu">label</span>(df_nz_1<span class="sc">$</span>hlth_height)     <span class="ot">&lt;-</span> <span class="st">"Height"</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a><span class="co"># table</span></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>table1<span class="sc">::</span><span class="fu">table1</span>(<span class="sc">~</span> hlth_weight <span class="sc">+</span> hlth_height, <span class="at">data =</span> df_nz_1)     </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display column-column-page-left">
<div>
<div class="Rtable1">
<table class="Rtable1 table table-sm table-striped small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th class="rowlabel firstrow lastrow" data-quarto-table-cell-role="th"></th>
<th class="firstrow lastrow" data-quarto-table-cell-role="th"><span class="stratlabel">Overall<br>
<span class="stratn">(N=20000)</span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowlabel firstrow">Weight</td>
<td class="firstrow"></td>
</tr>
<tr class="even">
<td class="rowlabel">Mean (SD)</td>
<td>79.2 (18.4)</td>
</tr>
<tr class="odd">
<td class="rowlabel">Median [Min, Max]</td>
<td>77.0 [38.0, 200]</td>
</tr>
<tr class="even">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">5655 (28.3%)</td>
</tr>
<tr class="odd">
<td class="rowlabel firstrow">Height</td>
<td class="firstrow"></td>
</tr>
<tr class="even">
<td class="rowlabel">Mean (SD)</td>
<td>1.70 (0.101)</td>
</tr>
<tr class="odd">
<td class="rowlabel">Median [Min, Max]</td>
<td>1.69 [1.26, 2.06]</td>
</tr>
<tr class="even">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">5655 (28.3%)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>Create graph</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"patchwork"</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="co"># create data set where filtering na vals</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>df_nzdat1 <span class="ot">&lt;-</span> df_nzdat <span class="sc">|&gt;</span> </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(weight),</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>                  <span class="sc">!</span><span class="fu">is.na</span>(height),</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>                  <span class="sc">!</span><span class="fu">is.na</span>(male)) <span class="co"># filter na's for density plots</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>weight_density <span class="ot">&lt;-</span>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> df_nzdat1, <span class="fu">aes</span>(<span class="at">x =</span> weight)) <span class="sc">+</span> <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"chocolate2"</span>) <span class="sc">+</span> </span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Density plot of weight of NZ sample years 2019/2020"</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>()</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>weight_density</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="03-content_files/figure-html/shape_data-1.png" class="column-column-page-left img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>height_density <span class="ot">&lt;-</span>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> df_nzdat1, <span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span> <span class="fu">geom_density</span>(<span class="at">fill =</span><span class="st">"blue2"</span>) <span class="sc">+</span> </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Density plot of height of NZ sample years 2019/2020"</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>()</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>height_density</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="03-content_files/figure-html/shape_data-2.png" class="column-column-page-left img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>weight_density <span class="sc">/</span> height_density <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'a'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="03-content_files/figure-html/shape_data-3.png" class="column-column-page-left img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Here’s a density plot:</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> df_nzdat1, <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">fill =</span> <span class="fu">as.factor</span>(male))) <span class="sc">+</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span> </span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Density plot of weight of NZ sample years 2019/2020"</span>) <span class="sc">+</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>() <span class="co"># nicer colour</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="03-content_files/figure-html/density_plot-1.png" class="column-column-page-left img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="solution-q2.-regress-height-weight-and-report-results" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="solution-q2.-regress-height-weight-and-report-results">Solution Q2. Regress height ~ weight and report results</h2>
<p><strong>Using the <code>nz</code> dataset, write a regression model for height as predicted by weight. Create a table for your results. Create a graphs/graphs to clarify the results of your regression model. Briefly report your results.</strong></p>
<p>Model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># regression of height ~ weight</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>fit_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(height <span class="sc">~</span> weight_c, <span class="at">data =</span> df_nzdat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Table:</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="co">#table of model</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">model_parameters</span>( fit_1) <span class="sc">|&gt;</span> </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print_html</span>(  <span class="at">digits =</span> <span class="dv">2</span>,  <span class="co"># options</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">select =</span> <span class="st">"{coef}{stars}|({ci})"</span>,</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">column_labels =</span> <span class="fu">c</span>(<span class="st">"Estimate"</span>, <span class="st">"95% CI"</span>)</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display column-column-page-left">
<div>
<div id="kgywzvlydc" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#kgywzvlydc table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#kgywzvlydc thead, #kgywzvlydc tbody, #kgywzvlydc tfoot, #kgywzvlydc tr, #kgywzvlydc td, #kgywzvlydc th {
  border-style: none;
}

#kgywzvlydc p {
  margin: 0;
  padding: 0;
}

#kgywzvlydc .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 100%;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kgywzvlydc .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kgywzvlydc .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kgywzvlydc .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kgywzvlydc .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kgywzvlydc .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kgywzvlydc .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kgywzvlydc .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kgywzvlydc .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kgywzvlydc .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kgywzvlydc .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kgywzvlydc .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kgywzvlydc .gt_spanner_row {
  border-bottom-style: hidden;
}

#kgywzvlydc .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kgywzvlydc .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kgywzvlydc .gt_from_md > :first-child {
  margin-top: 0;
}

#kgywzvlydc .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kgywzvlydc .gt_row {
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kgywzvlydc .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#kgywzvlydc .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kgywzvlydc .gt_row_group_first td {
  border-top-width: 2px;
}

#kgywzvlydc .gt_row_group_first th {
  border-top-width: 2px;
}

#kgywzvlydc .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kgywzvlydc .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kgywzvlydc .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kgywzvlydc .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kgywzvlydc .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kgywzvlydc .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kgywzvlydc .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#kgywzvlydc .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kgywzvlydc .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kgywzvlydc .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kgywzvlydc .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kgywzvlydc .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kgywzvlydc .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kgywzvlydc .gt_left {
  text-align: left;
}

#kgywzvlydc .gt_center {
  text-align: center;
}

#kgywzvlydc .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kgywzvlydc .gt_font_normal {
  font-weight: normal;
}

#kgywzvlydc .gt_font_bold {
  font-weight: bold;
}

#kgywzvlydc .gt_font_italic {
  font-style: italic;
}

#kgywzvlydc .gt_super {
  font-size: 65%;
}

#kgywzvlydc .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#kgywzvlydc .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kgywzvlydc .gt_indent_1 {
  text-indent: 5px;
}

#kgywzvlydc .gt_indent_2 {
  text-indent: 10px;
}

#kgywzvlydc .gt_indent_3 {
  text-indent: 15px;
}

#kgywzvlydc .gt_indent_4 {
  text-indent: 20px;
}

#kgywzvlydc .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="Parameter" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Parameter</th>
<th id="Estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Estimate</th>
<th id="95% CI" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">95% CI</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Parameter" style="border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3">(Intercept)</td>
<td class="gt_row gt_center" headers="Estimate">1.70***</td>
<td class="gt_row gt_center" headers="(ci)">(1.70, 1.70)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Parameter" style="border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3">weight c</td>
<td class="gt_row gt_center" headers="Estimate">2.23e-03***</td>
<td class="gt_row gt_center" headers="(ci)">(2.15e-03, 2.32e-03)</td>
</tr>
</tbody><tfoot class="gt_sourcenotes">
<tr class="odd">
<td colspan="3" class="gt_sourcenote"></td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</div>
<p>Prediction:</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure necessary libraries are loaded</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="co"># generate the plot with adjusted y-scale</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ggeffects<span class="sc">::</span><span class="fu">ggpredict</span>(fit_1, <span class="at">terms =</span> <span class="st">"weight_c"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="03-content_files/figure-html/regression_height_nz_prediction-1.png" class="column-column-page-left img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Briefly report your results. (note: please replace “significant” with “statistically significant.)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(fit_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear model (estimated using OLS) to predict height with weight_c
(formula: height ~ weight_c). The model explains a statistically significant
and moderate proportion of variance (R2 = 0.17, F(1, 14286) = 2853.14, p &lt;
.001, adj. R2 = 0.17). The model's intercept, corresponding to weight_c = 0, is
at 1.70 (95% CI [1.70, 1.70], t(14286) = 2205.37, p &lt; .001). Within this model:

  - The effect of weight c is statistically significant and positive (beta =
2.23e-03, 95% CI [2.15e-03, 2.32e-03], t(14286) = 53.41, p &lt; .001; Std. beta =
0.41, 95% CI [0.39, 0.42])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
</div>
</section>
<section id="solution-q3.-regress-height-male-and-report-results" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="solution-q3.-regress-height-male-and-report-results">Solution Q3. Regress height ~ male and report results</h2>
<p><strong>Using the <code>df_nz</code> dataset, write a regression model for height as predicted by <code>male</code> Create a table for your results. Create a graph/graphs to clarify the results of your regression model. Briefly report your results.</strong></p>
<p>Model and table:</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># regression of height ~ weight</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>fit_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(height <span class="sc">~</span> male, <span class="at">data =</span> df_nzdat)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(fit_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display column-column-page-left">
<div>
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">&nbsp;</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">height</td>
</tr>
<tr class="even">
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Predictors</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">p</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">1.78</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">1.78&nbsp;–&nbsp;1.78</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">male</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.13</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.13&nbsp;–&nbsp;-0.13</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">Observations</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">14345</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">R<sup>2</sup> / R<sup>2</sup> adjusted</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.387 / 0.387</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<p>Graph:</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot over the range of the data</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>plot_fit_2 <span class="ot">&lt;-</span> <span class="fu">plot</span>(</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  ggeffects<span class="sc">::</span><span class="fu">ggpredict</span>(fit_2, <span class="at">terms =</span> <span class="st">"male [all]"</span>),</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">add.data =</span> <span class="cn">TRUE</span>,</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">dot.alpha =</span> .<span class="dv">2</span>,</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">jitter =</span> .<span class="dv">1</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>plot_fit_2 <span class="sc">+</span> </span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">1.2</span>, <span class="fl">2.1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="03-content_files/figure-html/unnamed-chunk-51-1.png" class="column-column-page-left img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Report</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># report</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(fit_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear model (estimated using OLS) to predict height with male
(formula: height ~ male). The model explains a statistically significant and
substantial proportion of variance (R2 = 0.39, F(1, 14343) = 9049.77, p &lt; .001,
adj. R2 = 0.39). The model's intercept, corresponding to male = 0, is at 1.78
(95% CI [1.78, 1.78], t(14343) = 1629.39, p &lt; .001). Within this model:

  - The effect of male is statistically significant and negative (beta = -0.13,
95% CI [-0.13, -0.13], t(14343) = -95.13, p &lt; .001; Std. beta = -0.62, 95% CI
[-0.63, -0.61])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
</div>
</section>
<section id="solution-q4.-regression-to-predict" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="solution-q4.-regression-to-predict">Solution Q4. Regression to predict</h2>
<p><strong>Using the regression coefficients from the Pearson and Lee 1903 dataset, predict the heights of daughters of women in the <code>nz</code> dataset.</strong></p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># model for daughter height from mother height</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>fit_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(daughter_height <span class="sc">~</span> mother_height, <span class="at">data =</span> df_pearson_lee)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create data frame of not_male's in 2019</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="co"># notice problem. not_male != woman</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="co"># additionally, woman != mother!</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>df_nz_2 <span class="ot">&lt;-</span> df_nzdat<span class="sc">|&gt;</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(male <span class="sc">==</span> <span class="dv">1</span>)<span class="sc">|&gt;</span> <span class="co"># not_males</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(height)<span class="sc">|&gt;</span> <span class="co"># variable of interest</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">mother_height =</span> height <span class="sc">*</span> <span class="fl">39.36</span>)<span class="sc">|&gt;</span> <span class="co"># Convert meters to inches</span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(mother_height)<span class="sc">|&gt;</span></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>((mother_height))</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a><span class="co"># find min and max heights, store as objects</span></span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>min_mother_height <span class="ot">&lt;-</span> <span class="fu">min</span>(df_nz_2<span class="sc">$</span>mother_height, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>max_mother_height <span class="ot">&lt;-</span> <span class="fu">max</span>(df_nz_2<span class="sc">$</span>mother_height, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a><span class="co"># expand grid, use stored objects to define boundaries.</span></span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>df_expand_grid_nz_2 <span class="ot">&lt;-</span></span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand.grid</span>(<span class="at">mother_height =</span> <span class="fu">seq</span>(</span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">from =</span> min_mother_height,</span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">to =</span> max_mother_height,</span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">length.out =</span> <span class="dv">200</span></span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a><span class="co"># use the `predict` function to create a new response using the pearson and fox regression model</span></span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a>predict_fit_3 <span class="ot">&lt;-</span></span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(fit_3,</span>
<span id="cb69-31"><a href="#cb69-31" aria-hidden="true" tabindex="-1"></a>          <span class="at">type =</span> <span class="st">"response"</span>,</span>
<span id="cb69-32"><a href="#cb69-32" aria-hidden="true" tabindex="-1"></a>          <span class="at">interval =</span> <span class="st">"confidence"</span>,</span>
<span id="cb69-33"><a href="#cb69-33" aria-hidden="true" tabindex="-1"></a>          <span class="at">newdata =</span> df_expand_grid_nz_2)</span>
<span id="cb69-34"><a href="#cb69-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-35"><a href="#cb69-35" aria-hidden="true" tabindex="-1"></a><span class="co"># create a new dataframe for the response variables, following the method in lecture 5</span></span>
<span id="cb69-36"><a href="#cb69-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-37"><a href="#cb69-37" aria-hidden="true" tabindex="-1"></a><span class="co"># combine variables into a data frame</span></span>
<span id="cb69-38"><a href="#cb69-38" aria-hidden="true" tabindex="-1"></a>df_expand_grid_nz_2_predict_fit_3 <span class="ot">&lt;-</span></span>
<span id="cb69-39"><a href="#cb69-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(df_expand_grid_nz_2, predict_fit_3)</span>
<span id="cb69-40"><a href="#cb69-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-41"><a href="#cb69-41" aria-hidden="true" tabindex="-1"></a><span class="co"># graph the expected average hypothetical heights of "daughters"</span></span>
<span id="cb69-42"><a href="#cb69-42" aria-hidden="true" tabindex="-1"></a>predplot2 <span class="ot">&lt;-</span></span>
<span id="cb69-43"><a href="#cb69-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> df_expand_grid_nz_2_predict_fit_3,</span>
<span id="cb69-44"><a href="#cb69-44" aria-hidden="true" tabindex="-1"></a>         <span class="fu">aes</span>(<span class="at">x =</span> mother_height,</span>
<span id="cb69-45"><a href="#cb69-45" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> fit))  <span class="sc">+</span></span>
<span id="cb69-46"><a href="#cb69-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">colour =</span> <span class="st">"cadetblue"</span>)  <span class="sc">+</span>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lwr, <span class="at">ymax =</span> upr), <span class="at">width =</span> .<span class="dv">1</span>) <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">75</span>)) <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">75</span>)) <span class="sc">+</span> <span class="fu">theme_classic</span>()  <span class="sc">+</span></span>
<span id="cb69-47"><a href="#cb69-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"NZ 2019 female population"</span>) <span class="sc">+</span></span>
<span id="cb69-48"><a href="#cb69-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"predicted daughter heights in inches"</span>) <span class="sc">+</span></span>
<span id="cb69-49"><a href="#cb69-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Regression prediction for hypothetical daughter heights of NZ population in 2019 "</span>)</span>
<span id="cb69-50"><a href="#cb69-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-51"><a href="#cb69-51" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb69-52"><a href="#cb69-52" aria-hidden="true" tabindex="-1"></a>predplot2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="03-content_files/figure-html/unnamed-chunk-53-1.png" class="column-column-page-left img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="solution-q6.-bonus" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="solution-q6.-bonus">Solution Q6. Bonus</h2>
<p><strong>On average, how much taller or shorter are women in New Zealand as sampled in 2019 <code>nz</code> dataset compared with women in 1903 as sampled in the Pearson and Lee dataset.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create var for 1903 dataset</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="co"># For the historical dataset (assuming year 1903 for df_pearson_lee_2)</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>df_pearson_lee_2 <span class="ot">&lt;-</span> df_pearson_lee <span class="sc">|&gt;</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(mother_height, daughter_height) <span class="sc">|&gt;</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"relation"</span>, <span class="at">values_to =</span> <span class="st">"f_height"</span>) <span class="sc">|&gt;</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">year_is =</span> <span class="fu">factor</span>(<span class="st">"1903"</span>))</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a><span class="co"># create var the 2019 dataset</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>df_nz_combine_pearson_lee <span class="ot">&lt;-</span> df_nz_2 <span class="sc">|&gt;</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">f_height =</span> mother_height) <span class="sc">|&gt;</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">year_is =</span> <span class="fu">factor</span>(<span class="st">"2019"</span>),</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">relation =</span> <span class="fu">factor</span>(<span class="st">"mother"</span>))</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a><span class="co"># both dataframes have the `year_is` column but with different factor levels</span></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_nz_combine_pearson_lee)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  f_height year_is relation
     &lt;dbl&gt; &lt;fct&gt;   &lt;fct&gt;   
1     49.6 2019    mother  
2     49.6 2019    mother  
3     53.7 2019    mother  
4     54.5 2019    mother  
5     54.7 2019    mother  
6     54.9 2019    mother  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># combine data frames row-wise</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>df_nz_combine_pearson_lee_1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df_pearson_lee_2, df_nz_combine_pearson_lee)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="co"># look at data structure</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="co">#dplyr::glimpse(df_nz_combine_pearson_lee_1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Look at heights in sample</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get min and max heights for graph range</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df_nz_combine_pearson_lee_1<span class="sc">$</span>year_is)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 1903  2019 
11048 12574 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># box plot</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>                  df_nz_combine_pearson_lee_1,</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> year_is, <span class="at">y =</span> f_height, <span class="at">fill =</span> year_is)) <span class="sc">+</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">notch =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Comparison of female height 1903/2019"</span>) <span class="sc">+</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">scale_fill_viridis_d</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="03-content_files/figure-html/unnamed-chunk-55-1.png" class="column-column-page-left img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Predict heights out of sample</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># regression model</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>fit_4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(f_height <span class="sc">~</span> year_is, <span class="at">data =</span> df_nz_combine_pearson_lee_1)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="co"># table</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(fit_4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display column-column-page-left">
<div>
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">&nbsp;</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">f height</td>
</tr>
<tr class="even">
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Predictors</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">p</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">63.18</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">63.12&nbsp;–&nbsp;63.23</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">year is [2019]</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">1.82</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">1.75&nbsp;–&nbsp;1.90</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">Observations</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">20176</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">R<sup>2</sup> / R<sup>2</sup> adjusted</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.093 / 0.093</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<p>Women in 2019 are taller</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(fit_4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear model (estimated using OLS) to predict f_height with year_is
(formula: f_height ~ year_is). The model explains a statistically significant
and weak proportion of variance (R2 = 0.09, F(1, 20174) = 2080.54, p &lt; .001,
adj. R2 = 0.09). The model's intercept, corresponding to year_is = 1903, is at
63.18 (95% CI [63.12, 63.23], t(20174) = 2347.94, p &lt; .001). Within this model:

  - The effect of year is [2019] is statistically significant and positive (beta
= 1.82, 95% CI [1.75, 1.90], t(20174) = 45.61, p &lt; .001; Std. beta = 0.61, 95%
CI [0.59, 0.64])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
</div>
<p>Graph:</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get meaningful values for the y access range</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="co"># min</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>min_mother_height_for_range <span class="ot">&lt;-</span> <span class="fu">min</span>(df_nz_combine_pearson_lee_1<span class="sc">$</span>f_height, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="co"># max</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>max_mother_height_for_range <span class="ot">&lt;-</span> <span class="fu">max</span>(df_nz_combine_pearson_lee_1<span class="sc">$</span>f_height, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a><span class="co"># make graph </span></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>  ggeffects<span class="sc">::</span><span class="fu">ggpredict</span>(fit_4, <span class="at">terms =</span> <span class="st">"year_is"</span>),</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">add.data =</span> F,</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">dot.alpha =</span> .<span class="dv">2</span></span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Predicted difference in female heights 1903/2019"</span>) <span class="sc">+</span> </span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Study year"</span>) <span class="sc">+</span> </span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span> (<span class="st">"Predicted femal height (inches)"</span>) <span class="sc">+</span>   <span class="fu">scale_y_continuous</span>(</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(min_mother_height_for_range,max_mother_height_for_range))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="03-content_files/figure-html/unnamed-chunk-58-1.png" class="column-column-page-left img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Graph with predicted points:</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>ggeffects<span class="sc">::</span><span class="fu">ggpredict</span>(fit_4, <span class="at">terms =</span> <span class="st">"year_is"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Predicted values of f_height

year_is | Predicted |         95% CI
------------------------------------
1903    |     63.18 | [63.12, 63.23]
2019    |     65.00 | [64.94, 65.06]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># graph with predicted values based on the model</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  ggeffects<span class="sc">::</span><span class="fu">ggpredict</span>(fit_4, <span class="at">terms =</span> <span class="st">"year_is"</span>),</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">add.data =</span> <span class="cn">TRUE</span>,</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">dot.alpha =</span> .<span class="dv">01</span>,</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>   <span class="at">colors =</span> <span class="st">"us"</span>, <span class="co"># see colour pallet options </span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">jitter =</span>.<span class="dv">5</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Predicted difference in female heights 1903/2019"</span>) <span class="sc">+</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Study year"</span>) <span class="sc">+</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span> (<span class="st">"Predicted femal height (inches)"</span>) <span class="sc">+</span></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(min_mother_height_for_range, max_mother_height_for_range))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="03-content_files/figure-html/unnamed-chunk-59-1.png" class="column-column-page-left img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>fit_4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = f_height ~ year_is, data = df_nz_combine_pearson_lee_1)

Coefficients:
(Intercept)  year_is2019  
     63.177        1.825  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show all color palettes</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="co">#show_pals()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="appendix-1-conceptual-background" class="level2">
<h2 class="anchored" data-anchor-id="appendix-1-conceptual-background">Appendix 1 Conceptual Background</h2>
<p>Some preliminaries about science.</p>
<section id="science-begins-with-a-question" class="level3">
<h3 class="anchored" data-anchor-id="science-begins-with-a-question">Science begins with a question</h3>
<p>Science begins with a question about the world. The first step in science, then, is to clarify what you want to know.</p>
<p>Because science is a social practice, you will also need to clarify why your question is interesting: so what?</p>
<p>In short, know your question.</p>
</section>
<section id="scientific-model-or-theory" class="level3">
<h3 class="anchored" data-anchor-id="scientific-model-or-theory">Scientific model (or theory)</h3>
<p>Sometimes, scientists are interested in specific features of the world: how did virus x originate? Such a question might have a forensic interest: what constellation of events gave rise to a novel infectious disease?</p>
<p>Scientists typically seek generalisations. How do infectious diseases evolve? How do biological organisms evolve? Such questions have applied interests. How can we better prevent infectious diseases? How did life originate?</p>
<p>A scientific model proposes how nature is structured (and unstructured). For example, the theory of evolution by natural selection proposes that life emerges from variation, inheritance, and differential reproduction/survival.</p>
<p>To evaluate a scientific model, scientists must make generalisations beyond individual cases. This is where statistics shines.</p>
</section>
<section id="what-is-statistics" class="level3">
<h3 class="anchored" data-anchor-id="what-is-statistics">What is statistics?</h3>
<p>Mathematics is a logic of certainty.</p>
<p>Statistics is a logic of uncertainty.</p>
<p>A statistical model uses the logic of probability to make better guesses.</p>
</section>
<section id="applications-of-statistical-models-in-science" class="level3">
<h3 class="anchored" data-anchor-id="applications-of-statistical-models-in-science">Applications of statistical models in science</h3>
<p>Scientific models seek to explain how nature is structured. Where scientific models conflict, we can combine statistical models with data collection to evaluate the credibility of of one theoretical model over others. To do this, a scientific model must make distinct, non-trivial predictions about the world.</p>
<p>If the predictions are not distinct, the observations will not enable a shift in credibility for one theory over another. Consider the theory that predicts any observation. Such a theory would be better classified as a conspiracy theory; it is compatible with any evidence.</p>
<!-- Sometimes the processes of empirical testing is called "hypothesis testing." In the weeks ahead, we will distinguish the intellectually excellent concept of "hypothesis testing" from "Null Hypothesis Significance Testing (NHST)." Although there is is nothing inherently flawed with NHST, it's misunderstandings have been an abomination. -->


<!-- -->


</section>
</section>
</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb86" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Causal Diagrams: The Structures of Confounding Bias"</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2023-MAR-08"</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="an">bibliography:</span><span class="co"> /Users/joseph/GIT/templates/bib/references.bib</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: console</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a><span class="co">    warnings: FALSE</span></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a><span class="co">    error: FALSE</span></span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a><span class="co">    messages: FALSE</span></span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-overflow: scroll</span></span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a><span class="co">    highlight-style: gruvbox</span></span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools:</span></span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a><span class="co">      source: TRUE</span></span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a><span class="co">      toggle: FALSE</span></span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a><span class="an">html-math-method:</span><span class="co"> katex</span></span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a><span class="an">reference-location:</span><span class="co"> margin</span></span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a><span class="an">citation-location:</span><span class="co"> margin</span></span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a><span class="an">cap-location:</span><span class="co"> margin</span></span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a><span class="an">column:</span><span class="co"> column-page-left</span></span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a><span class="an">code-block-border-left:</span><span class="co"> true</span></span>
<span id="cb86-23"><a href="#cb86-23" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb86-24"><a href="#cb86-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-27"><a href="#cb86-27" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-28"><a href="#cb86-28" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: FALSE</span></span>
<span id="cb86-29"><a href="#cb86-29" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: FALSE</span></span>
<span id="cb86-30"><a href="#cb86-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-31"><a href="#cb86-31" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">WARNING</span><span class="co">:  COMMENT THIS OUT. JB DOES THIS FOR WORKING WITHOUT WIFI</span></span>
<span id="cb86-32"><a href="#cb86-32" aria-hidden="true" tabindex="-1"></a><span class="co">#source("/Users/joseph/GIT/templates/functions/libs2.R")</span></span>
<span id="cb86-33"><a href="#cb86-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-34"><a href="#cb86-34" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">WARNING</span><span class="co">:  COMMENT THIS OUT. JB DOES THIS FOR WORKING WITHOUT WIFI</span></span>
<span id="cb86-35"><a href="#cb86-35" aria-hidden="true" tabindex="-1"></a><span class="co">#source("/Users/joseph/GIT/templates/functions/funs.R")</span></span>
<span id="cb86-36"><a href="#cb86-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-37"><a href="#cb86-37" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">ALERT</span><span class="co">: UNCOMMENT THIS AND DOWNLOAD THE FUNCTIONS FROM JB's GITHUB</span></span>
<span id="cb86-38"><a href="#cb86-38" aria-hidden="true" tabindex="-1"></a><span class="co"># source(</span></span>
<span id="cb86-39"><a href="#cb86-39" aria-hidden="true" tabindex="-1"></a><span class="co">#   "https://raw.githubusercontent.com/go-bayes/templates/main/functions/experimental_funs.R"</span></span>
<span id="cb86-40"><a href="#cb86-40" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb86-41"><a href="#cb86-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-42"><a href="#cb86-42" aria-hidden="true" tabindex="-1"></a><span class="co"># source(</span></span>
<span id="cb86-43"><a href="#cb86-43" aria-hidden="true" tabindex="-1"></a><span class="co">#   "https://raw.githubusercontent.com/go-bayes/templates/main/functions/experimental_funs.R"</span></span>
<span id="cb86-44"><a href="#cb86-44" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb86-45"><a href="#cb86-45" aria-hidden="true" tabindex="-1"></a><span class="co"># for making graphs</span></span>
<span id="cb86-46"><a href="#cb86-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"tinytex"</span>)</span>
<span id="cb86-47"><a href="#cb86-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"extrafont"</span>)</span>
<span id="cb86-48"><a href="#cb86-48" aria-hidden="true" tabindex="-1"></a><span class="fu">loadfonts</span>(<span class="at">device =</span> <span class="st">"all"</span>)</span>
<span id="cb86-49"><a href="#cb86-49" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-50"><a href="#cb86-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-51"><a href="#cb86-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-52"><a href="#cb86-52" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb86-53"><a href="#cb86-53" aria-hidden="true" tabindex="-1"></a>**Required**</span>
<span id="cb86-54"><a href="#cb86-54" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">@hernan2024WHATIF</span><span class="co">]</span> Chapter 6 <span class="co">[</span><span class="ot">link</span><span class="co">](https://www.dropbox.com/scl/fi/9hy6xw1g1o4yz94ip8cvd/hernanrobins_WhatIf_2jan24.pdf?rlkey=8eaw6lqhmes7ddepuriwk5xk9&amp;dl=0)</span></span>
<span id="cb86-55"><a href="#cb86-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-56"><a href="#cb86-56" aria-hidden="true" tabindex="-1"></a>**Optional**</span>
<span id="cb86-57"><a href="#cb86-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-58"><a href="#cb86-58" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">@suzuki2020</span><span class="co">] [link]</span>(https://www.dropbox.com/scl/fi/4midxwr9ltg9oce02e0ss/suzuki-causal-diagrams.pdf?rlkey=uktzf3nurtgpbj8m4h0xz82dn&amp;dl=0)</span>
<span id="cb86-59"><a href="#cb86-59" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">@bulbulia2023</span><span class="co">] [link]</span>(https://osf.io/preprints/psyarxiv/b23k7)</span>
<span id="cb86-60"><a href="#cb86-60" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">@neal2020introduction</span><span class="co">]</span> Chapter 3 <span class="co">[</span><span class="ot">link</span><span class="co">]()</span></span>
<span id="cb86-61"><a href="#cb86-61" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-62"><a href="#cb86-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-63"><a href="#cb86-63" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb86-64"><a href="#cb86-64" aria-hidden="true" tabindex="-1"></a><span class="fu">## Key concepts for the test(s):</span></span>
<span id="cb86-65"><a href="#cb86-65" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**M-bias**</span>
<span id="cb86-66"><a href="#cb86-66" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Regression**</span>
<span id="cb86-67"><a href="#cb86-67" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Intercept**</span>
<span id="cb86-68"><a href="#cb86-68" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Regression Coefficient**</span>
<span id="cb86-69"><a href="#cb86-69" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Model Fit**</span>
<span id="cb86-70"><a href="#cb86-70" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Why Model Fit is Misleading for Causality**</span>
<span id="cb86-71"><a href="#cb86-71" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-72"><a href="#cb86-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-73"><a href="#cb86-73" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb86-74"><a href="#cb86-74" aria-hidden="true" tabindex="-1"></a><span class="fu">## For the lab, copy and paste code chunks following the "LAB 3" section.</span></span>
<span id="cb86-75"><a href="#cb86-75" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-76"><a href="#cb86-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-77"><a href="#cb86-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-78"><a href="#cb86-78" aria-hidden="true" tabindex="-1"></a><span class="fu"># Seminar</span></span>
<span id="cb86-79"><a href="#cb86-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-80"><a href="#cb86-80" aria-hidden="true" tabindex="-1"></a><span class="fu">## Learning Outcomes</span></span>
<span id="cb86-81"><a href="#cb86-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-82"><a href="#cb86-82" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>You will learn how to use causal diagrams to evaluate the "no unmeasured confounding" assumption of causal inference.</span>
<span id="cb86-83"><a href="#cb86-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-84"><a href="#cb86-84" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>You will understand how time-series data-collection may address common confounding problems.</span>
<span id="cb86-85"><a href="#cb86-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-86"><a href="#cb86-86" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>You will understand why time-series data-collection are insufficient for addressing other common confounding problems.</span>
<span id="cb86-87"><a href="#cb86-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-88"><a href="#cb86-88" aria-hidden="true" tabindex="-1"></a><span class="fu">## Confounding problems resolved by time-series data </span></span>
<span id="cb86-89"><a href="#cb86-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-90"><a href="#cb86-90" aria-hidden="true" tabindex="-1"></a>@fig-time-solved presents the structural features of seven confounding problems.  We shall discuss examples of each, and how longitudinal data collection resolves each problem.  </span>
<span id="cb86-91"><a href="#cb86-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-92"><a href="#cb86-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-93"><a href="#cb86-93" aria-hidden="true" tabindex="-1"></a>::: {#fig-time-solved}</span>
<span id="cb86-94"><a href="#cb86-94" aria-hidden="true" tabindex="-1"></a><span class="al">![](time-resolved-confounding.pdf)</span>{fig-align="left" height=100% width=100%}</span>
<span id="cb86-95"><a href="#cb86-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-96"><a href="#cb86-96" aria-hidden="true" tabindex="-1"></a>This figure is adapted from <span class="co">[</span><span class="ot">@bulbulia2023</span><span class="co">]</span></span>
<span id="cb86-97"><a href="#cb86-97" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-98"><a href="#cb86-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-99"><a href="#cb86-99" aria-hidden="true" tabindex="-1"></a><span class="fu">## Confounding problems not resolved by time-series data alone</span></span>
<span id="cb86-100"><a href="#cb86-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-101"><a href="#cb86-101" aria-hidden="true" tabindex="-1"></a>@fig-time-not-solved presents six examples of time-series data that are not resolved by longitudinal data collection. **Before seminar, consider why time series data are insufficient to address confounding in each of the six scenarios described in this figure.**</span>
<span id="cb86-102"><a href="#cb86-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-103"><a href="#cb86-103" aria-hidden="true" tabindex="-1"></a>::: {#fig-time-not-solved}</span>
<span id="cb86-104"><a href="#cb86-104" aria-hidden="true" tabindex="-1"></a><span class="al">![](dag-time-series-not-resolved.pdf)</span>{fig-align="left" height=100% width=100%}</span>
<span id="cb86-105"><a href="#cb86-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-106"><a href="#cb86-106" aria-hidden="true" tabindex="-1"></a>This figure is adapted from <span class="co">[</span><span class="ot">@bulbulia2023</span><span class="co">]</span></span>
<span id="cb86-107"><a href="#cb86-107" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-108"><a href="#cb86-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-109"><a href="#cb86-109" aria-hidden="true" tabindex="-1"></a><span class="fu">## Worked Example: The Assumptions in Causal Mediation</span></span>
<span id="cb86-110"><a href="#cb86-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-111"><a href="#cb86-111" aria-hidden="true" tabindex="-1"></a>::: {#fig-time-solved}</span>
<span id="cb86-112"><a href="#cb86-112" aria-hidden="true" tabindex="-1"></a><span class="al">![](mediation.pdf)</span>{fig-align="left" height=100% width=100%}</span>
<span id="cb86-113"><a href="#cb86-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-114"><a href="#cb86-114" aria-hidden="true" tabindex="-1"></a>This figure is adapted from <span class="co">[</span><span class="ot">@bulbulia2023</span><span class="co">]</span></span>
<span id="cb86-115"><a href="#cb86-115" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-116"><a href="#cb86-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-117"><a href="#cb86-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-118"><a href="#cb86-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-119"><a href="#cb86-119" aria-hidden="true" tabindex="-1"></a><span class="fu"># Lab 3</span></span>
<span id="cb86-120"><a href="#cb86-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-123"><a href="#cb86-123" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-124"><a href="#cb86-124" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: packages</span></span>
<span id="cb86-125"><a href="#cb86-125" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(devtools, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb86-126"><a href="#cb86-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"devtools"</span>)</span>
<span id="cb86-127"><a href="#cb86-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(devtools)</span>
<span id="cb86-128"><a href="#cb86-128" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-129"><a href="#cb86-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-130"><a href="#cb86-130" aria-hidden="true" tabindex="-1"></a><span class="co"># simulated data (will take time to download)</span></span>
<span id="cb86-131"><a href="#cb86-131" aria-hidden="true" tabindex="-1"></a><span class="co"># devtools::install_github("go-bayes/margot")</span></span>
<span id="cb86-132"><a href="#cb86-132" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"margot"</span>)</span>
<span id="cb86-133"><a href="#cb86-133" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"margot"</span>)</span>
<span id="cb86-134"><a href="#cb86-134" aria-hidden="true" tabindex="-1"></a><span class="co"># List all datasets available in the package</span></span>
<span id="cb86-135"><a href="#cb86-135" aria-hidden="true" tabindex="-1"></a><span class="co"># data(package = "margot")</span></span>
<span id="cb86-136"><a href="#cb86-136" aria-hidden="true" tabindex="-1"></a><span class="co">#data("df_nz", package = "margot")</span></span>
<span id="cb86-137"><a href="#cb86-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-138"><a href="#cb86-138" aria-hidden="true" tabindex="-1"></a><span class="co"># for equations </span></span>
<span id="cb86-139"><a href="#cb86-139" aria-hidden="true" tabindex="-1"></a><span class="co"># if (!require(devtools, quietly = TRUE)) {</span></span>
<span id="cb86-140"><a href="#cb86-140" aria-hidden="true" tabindex="-1"></a><span class="co">#   install.packages("remotes")</span></span>
<span id="cb86-141"><a href="#cb86-141" aria-hidden="true" tabindex="-1"></a><span class="co">#   library(remotes)</span></span>
<span id="cb86-142"><a href="#cb86-142" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb86-143"><a href="#cb86-143" aria-hidden="true" tabindex="-1"></a><span class="co"># remotes::install_github("datalorax/equatiomatic")</span></span>
<span id="cb86-144"><a href="#cb86-144" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb86-145"><a href="#cb86-145" aria-hidden="true" tabindex="-1"></a><span class="co"># library("equatiomatic")</span></span>
<span id="cb86-146"><a href="#cb86-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-147"><a href="#cb86-147" aria-hidden="true" tabindex="-1"></a><span class="co"># data wrangling</span></span>
<span id="cb86-148"><a href="#cb86-148" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(tidyverse, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb86-149"><a href="#cb86-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb86-150"><a href="#cb86-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(tidyverse)</span>
<span id="cb86-151"><a href="#cb86-151" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-152"><a href="#cb86-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-153"><a href="#cb86-153" aria-hidden="true" tabindex="-1"></a><span class="co"># regression splines</span></span>
<span id="cb86-154"><a href="#cb86-154" aria-hidden="true" tabindex="-1"></a><span class="co"># for equations </span></span>
<span id="cb86-155"><a href="#cb86-155" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(devtools, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb86-156"><a href="#cb86-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"splines"</span>)</span>
<span id="cb86-157"><a href="#cb86-157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(splines)</span>
<span id="cb86-158"><a href="#cb86-158" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-159"><a href="#cb86-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-160"><a href="#cb86-160" aria-hidden="true" tabindex="-1"></a><span class="co"># reports</span></span>
<span id="cb86-161"><a href="#cb86-161" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(report, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb86-162"><a href="#cb86-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"report"</span>)</span>
<span id="cb86-163"><a href="#cb86-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(report)</span>
<span id="cb86-164"><a href="#cb86-164" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-165"><a href="#cb86-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-166"><a href="#cb86-166" aria-hidden="true" tabindex="-1"></a><span class="co"># for equations </span></span>
<span id="cb86-167"><a href="#cb86-167" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(performance, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb86-168"><a href="#cb86-168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"performance"</span>)</span>
<span id="cb86-169"><a href="#cb86-169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(performance)</span>
<span id="cb86-170"><a href="#cb86-170" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-171"><a href="#cb86-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-172"><a href="#cb86-172" aria-hidden="true" tabindex="-1"></a><span class="co"># graphs </span></span>
<span id="cb86-173"><a href="#cb86-173" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(ggeffects, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb86-174"><a href="#cb86-174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"ggeffects"</span>)</span>
<span id="cb86-175"><a href="#cb86-175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggeffects)</span>
<span id="cb86-176"><a href="#cb86-176" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-177"><a href="#cb86-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-178"><a href="#cb86-178" aria-hidden="true" tabindex="-1"></a><span class="co"># more graphs</span></span>
<span id="cb86-179"><a href="#cb86-179" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(sjPlot, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb86-180"><a href="#cb86-180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"sjPlot"</span>)</span>
<span id="cb86-181"><a href="#cb86-181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(sjPlot)</span>
<span id="cb86-182"><a href="#cb86-182" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-183"><a href="#cb86-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-184"><a href="#cb86-184" aria-hidden="true" tabindex="-1"></a><span class="co"># data wrangling</span></span>
<span id="cb86-185"><a href="#cb86-185" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(dplyr, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb86-186"><a href="#cb86-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"dplyr"</span>)</span>
<span id="cb86-187"><a href="#cb86-187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(dplyr)</span>
<span id="cb86-188"><a href="#cb86-188" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-189"><a href="#cb86-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-190"><a href="#cb86-190" aria-hidden="true" tabindex="-1"></a><span class="co"># graphing</span></span>
<span id="cb86-191"><a href="#cb86-191" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(ggplot2, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb86-192"><a href="#cb86-192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb86-193"><a href="#cb86-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggplot2)</span>
<span id="cb86-194"><a href="#cb86-194" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-195"><a href="#cb86-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-196"><a href="#cb86-196" aria-hidden="true" tabindex="-1"></a><span class="co"># summary stats</span></span>
<span id="cb86-197"><a href="#cb86-197" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(skimr, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb86-198"><a href="#cb86-198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"skimr"</span>)</span>
<span id="cb86-199"><a href="#cb86-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(skimr)</span>
<span id="cb86-200"><a href="#cb86-200" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-201"><a href="#cb86-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-202"><a href="#cb86-202" aria-hidden="true" tabindex="-1"></a><span class="co"># tables </span></span>
<span id="cb86-203"><a href="#cb86-203" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(gtsummary, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb86-204"><a href="#cb86-204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"gtsummary"</span>)</span>
<span id="cb86-205"><a href="#cb86-205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(gtsummary)</span>
<span id="cb86-206"><a href="#cb86-206" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-207"><a href="#cb86-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-208"><a href="#cb86-208" aria-hidden="true" tabindex="-1"></a><span class="co"># easy tables</span></span>
<span id="cb86-209"><a href="#cb86-209" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(table1, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb86-210"><a href="#cb86-210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"table1"</span>)</span>
<span id="cb86-211"><a href="#cb86-211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(table1)</span>
<span id="cb86-212"><a href="#cb86-212" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-213"><a href="#cb86-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-214"><a href="#cb86-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-215"><a href="#cb86-215" aria-hidden="true" tabindex="-1"></a><span class="co"># table summaries</span></span>
<span id="cb86-216"><a href="#cb86-216" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(kableExtra, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb86-217"><a href="#cb86-217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"kableExtra"</span>)</span>
<span id="cb86-218"><a href="#cb86-218" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(kableExtra)</span>
<span id="cb86-219"><a href="#cb86-219" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-220"><a href="#cb86-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-221"><a href="#cb86-221" aria-hidden="true" tabindex="-1"></a><span class="co"># multi-panel plots</span></span>
<span id="cb86-222"><a href="#cb86-222" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(patchwork, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb86-223"><a href="#cb86-223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"patchwork"</span>)</span>
<span id="cb86-224"><a href="#cb86-224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(patchwork)</span>
<span id="cb86-225"><a href="#cb86-225" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-226"><a href="#cb86-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-227"><a href="#cb86-227" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(performance, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb86-228"><a href="#cb86-228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"performance"</span>)</span>
<span id="cb86-229"><a href="#cb86-229" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(performance)</span>
<span id="cb86-230"><a href="#cb86-230" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-231"><a href="#cb86-231" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-232"><a href="#cb86-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-233"><a href="#cb86-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-234"><a href="#cb86-234" aria-hidden="true" tabindex="-1"></a><span class="fu"># Regression </span></span>
<span id="cb86-235"><a href="#cb86-235" aria-hidden="true" tabindex="-1"></a>This week we introduce regression.</span>
<span id="cb86-236"><a href="#cb86-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-237"><a href="#cb86-237" aria-hidden="true" tabindex="-1"></a><span class="fu">## Learning Outcomes</span></span>
<span id="cb86-238"><a href="#cb86-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-239"><a href="#cb86-239" aria-hidden="true" tabindex="-1"></a>By learning regression, you will be better equipped to do psychological science and to evaluate psychological research.</span>
<span id="cb86-240"><a href="#cb86-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-241"><a href="#cb86-241" aria-hidden="true" tabindex="-1"></a><span class="fu">## What is Regression?</span></span>
<span id="cb86-242"><a href="#cb86-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-243"><a href="#cb86-243" aria-hidden="true" tabindex="-1"></a>Broadly speaking, a regression model is a method for inferring the expected average features of a population and its variance conditional on other features of the population as measured in a sample.</span>
<span id="cb86-244"><a href="#cb86-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-245"><a href="#cb86-245" aria-hidden="true" tabindex="-1"></a>We'll see that regression encompasses more than this definition; however, this definition makes a start.</span>
<span id="cb86-246"><a href="#cb86-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-247"><a href="#cb86-247" aria-hidden="true" tabindex="-1"></a>To understand regression, then, we need to understand the following jargon words: population, sample, measurement, and inference.</span>
<span id="cb86-248"><a href="#cb86-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-249"><a href="#cb86-249" aria-hidden="true" tabindex="-1"></a><span class="fu">#### What is a population?</span></span>
<span id="cb86-250"><a href="#cb86-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-251"><a href="#cb86-251" aria-hidden="true" tabindex="-1"></a>In science, a population is a hypothetical construct. It is the set of all potential members of a set of things. In psychological science, that set is typically a collection of individuals. We want to understand "The population of all human beings?" or "The New Zealand adult population"; or "The population of undergraduates who may be recruited for IPRP in New Zealand."</span>
<span id="cb86-252"><a href="#cb86-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-253"><a href="#cb86-253" aria-hidden="true" tabindex="-1"></a><span class="fu">#### What is a sample?</span></span>
<span id="cb86-254"><a href="#cb86-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-255"><a href="#cb86-255" aria-hidden="true" tabindex="-1"></a>A sample is a randomly realised sub-population from the larger abstract population that a scientific community hopes to generalise about.</span>
<span id="cb86-256"><a href="#cb86-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-257"><a href="#cb86-257" aria-hidden="true" tabindex="-1"></a>Think of selecting balls randomly from an urn. When pulled at random, the balls may inform us about the urn's contents. For example, if we select one white ball and one black ball, we may infer that the balls in the urn are not all white or all black.</span>
<span id="cb86-258"><a href="#cb86-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-259"><a href="#cb86-259" aria-hidden="true" tabindex="-1"></a><span class="fu">#### What is "measurement"?</span></span>
<span id="cb86-260"><a href="#cb86-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-261"><a href="#cb86-261" aria-hidden="true" tabindex="-1"></a>A measure is a tool or method for obtaining numerical descriptions of a sample. We often call measures "scales."</span>
<span id="cb86-262"><a href="#cb86-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-263"><a href="#cb86-263" aria-hidden="true" tabindex="-1"></a>A measurement is the numerical description we obtain from sensors such as statistical surveys, census data, twitter feeds, &amp; etc.</span>
<span id="cb86-264"><a href="#cb86-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-265"><a href="#cb86-265" aria-hidden="true" tabindex="-1"></a>In the course, we have encountered numerical scales, ordinal scales, and factors. The topic of measurement in psychology is very broad. As we shall see, the trail of the serpent of measurement runs across comparative psychological research.</span>
<span id="cb86-266"><a href="#cb86-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-267"><a href="#cb86-267" aria-hidden="true" tabindex="-1"></a>It is essential to remember that measures can be prone to error.</span>
<span id="cb86-268"><a href="#cb86-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-269"><a href="#cb86-269" aria-hidden="true" tabindex="-1"></a>Error-prone scales may nevertheless be helpful. However, we need to investigate their utility against the backdrop of specific interests and purposes.</span>
<span id="cb86-270"><a href="#cb86-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-271"><a href="#cb86-271" aria-hidden="true" tabindex="-1"></a><span class="fu">#### What is a parameter?</span></span>
<span id="cb86-272"><a href="#cb86-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-273"><a href="#cb86-273" aria-hidden="true" tabindex="-1"></a>In regression, we combine measurements on samples with probability theory to guess about the properties of a population we will never observe. We call these properties "parameters."</span>
<span id="cb86-274"><a href="#cb86-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-275"><a href="#cb86-275" aria-hidden="true" tabindex="-1"></a><span class="fu">#### What is statistical inference?</span></span>
<span id="cb86-276"><a href="#cb86-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-277"><a href="#cb86-277" aria-hidden="true" tabindex="-1"></a>The bulk of statistical inference consists of educated guessing about population parameters.</span>
<span id="cb86-278"><a href="#cb86-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-279"><a href="#cb86-279" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Probability distributions and statistical guessing</span></span>
<span id="cb86-280"><a href="#cb86-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-281"><a href="#cb86-281" aria-hidden="true" tabindex="-1"></a>Inference is possible because the parameters of naturally occurring populations are structured by data-generating processes that are approximated by **probability distributions.** A probability distribution is a mathematical function describing a random event's probability. Today we will be focusing on height.<span class="ot">[^1]</span></span>
<span id="cb86-282"><a href="#cb86-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-283"><a href="#cb86-283" aria-hidden="true" tabindex="-1"></a><span class="ot">[^1]: </span>The relationship of probability distributions and data-generating processes is complex, intriguing, and both historically and philosophically rich $\dots$. Because our interests are applied, we will hardly touch up this richness in this course.</span>
<span id="cb86-284"><a href="#cb86-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-285"><a href="#cb86-285" aria-hidden="true" tabindex="-1"></a>Today we will discuss the "normal" or "Gaussian distribution." A large number of data-generating processes in nature conform the normal distribution.</span>
<span id="cb86-286"><a href="#cb86-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-287"><a href="#cb86-287" aria-hidden="true" tabindex="-1"></a>Let's consider some examples of randomly generated samples, which we will obtain using R's <span class="in">`rnorm`</span> function.</span>
<span id="cb86-288"><a href="#cb86-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-289"><a href="#cb86-289" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 100-person sample of heights</span></span>
<span id="cb86-290"><a href="#cb86-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-293"><a href="#cb86-293" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-294"><a href="#cb86-294" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: draws_10 </span></span>
<span id="cb86-295"><a href="#cb86-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-296"><a href="#cb86-296" aria-hidden="true" tabindex="-1"></a><span class="co"># seed</span></span>
<span id="cb86-297"><a href="#cb86-297" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb86-298"><a href="#cb86-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-299"><a href="#cb86-299" aria-hidden="true" tabindex="-1"></a><span class="co"># generate 10 samples, average 170, sd = 20</span></span>
<span id="cb86-300"><a href="#cb86-300" aria-hidden="true" tabindex="-1"></a>draws_10 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">170</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb86-301"><a href="#cb86-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-302"><a href="#cb86-302" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot quick-histogram</span></span>
<span id="cb86-303"><a href="#cb86-303" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">qplot</span>(draws_10, <span class="at">binwidth =</span> <span class="dv">2</span>)</span>
<span id="cb86-304"><a href="#cb86-304" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-305"><a href="#cb86-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-306"><a href="#cb86-306" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 10-person sample of heights</span></span>
<span id="cb86-307"><a href="#cb86-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-310"><a href="#cb86-310" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-311"><a href="#cb86-311" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: draws_100 </span></span>
<span id="cb86-312"><a href="#cb86-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-313"><a href="#cb86-313" aria-hidden="true" tabindex="-1"></a><span class="co"># reproducibility </span></span>
<span id="cb86-314"><a href="#cb86-314" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb86-315"><a href="#cb86-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-316"><a href="#cb86-316" aria-hidden="true" tabindex="-1"></a><span class="co"># generate 100 samples, average 170, sd = 20</span></span>
<span id="cb86-317"><a href="#cb86-317" aria-hidden="true" tabindex="-1"></a>draws_100 <span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">170</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb86-318"><a href="#cb86-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-319"><a href="#cb86-319" aria-hidden="true" tabindex="-1"></a><span class="co"># graph</span></span>
<span id="cb86-320"><a href="#cb86-320" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">qplot</span>(</span>
<span id="cb86-321"><a href="#cb86-321" aria-hidden="true" tabindex="-1"></a>  draws_100, <span class="at">binwidth =</span> <span class="dv">2</span></span>
<span id="cb86-322"><a href="#cb86-322" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb86-323"><a href="#cb86-323" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-324"><a href="#cb86-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-325"><a href="#cb86-325" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 10000-person sample of heights</span></span>
<span id="cb86-326"><a href="#cb86-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-329"><a href="#cb86-329" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-330"><a href="#cb86-330" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: draws_10000 </span></span>
<span id="cb86-331"><a href="#cb86-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-332"><a href="#cb86-332" aria-hidden="true" tabindex="-1"></a><span class="co"># reproducibility</span></span>
<span id="cb86-333"><a href="#cb86-333" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb86-334"><a href="#cb86-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-335"><a href="#cb86-335" aria-hidden="true" tabindex="-1"></a><span class="co"># N = 10,000</span></span>
<span id="cb86-336"><a href="#cb86-336" aria-hidden="true" tabindex="-1"></a>draws_10000 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fl">1e5</span>, <span class="at">mean =</span> <span class="dv">170</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb86-337"><a href="#cb86-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-338"><a href="#cb86-338" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb86-339"><a href="#cb86-339" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">qplot</span>(draws_10000, <span class="at">binwidth =</span> <span class="dv">2</span>)</span>
<span id="cb86-340"><a href="#cb86-340" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-341"><a href="#cb86-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-342"><a href="#cb86-342" aria-hidden="true" tabindex="-1"></a><span class="fu">### How can I use regression to infer a population parameter?</span></span>
<span id="cb86-343"><a href="#cb86-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-344"><a href="#cb86-344" aria-hidden="true" tabindex="-1"></a>We can use R to investigate the *average* height of our imaginary population from which the preceding samples were randomly drawn. We do this in R by writing an "intercept-only" model as follows:</span>
<span id="cb86-345"><a href="#cb86-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-348"><a href="#cb86-348" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-349"><a href="#cb86-349" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: eval_false_model</span></span>
<span id="cb86-350"><a href="#cb86-350" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false </span></span>
<span id="cb86-351"><a href="#cb86-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-352"><a href="#cb86-352" aria-hidden="true" tabindex="-1"></a><span class="co"># syntax for an intercept-only model</span></span>
<span id="cb86-353"><a href="#cb86-353" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(outcome <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> data)</span>
<span id="cb86-354"><a href="#cb86-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-355"><a href="#cb86-355" aria-hidden="true" tabindex="-1"></a><span class="co"># base R summary</span></span>
<span id="cb86-356"><a href="#cb86-356" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span>
<span id="cb86-357"><a href="#cb86-357" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-358"><a href="#cb86-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-359"><a href="#cb86-359" aria-hidden="true" tabindex="-1"></a>Using the previous simulations:</span>
<span id="cb86-360"><a href="#cb86-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-361"><a href="#cb86-361" aria-hidden="true" tabindex="-1"></a>N = 10 random draws</span>
<span id="cb86-362"><a href="#cb86-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-365"><a href="#cb86-365" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-366"><a href="#cb86-366" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: draws_10_tab</span></span>
<span id="cb86-367"><a href="#cb86-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-368"><a href="#cb86-368" aria-hidden="true" tabindex="-1"></a><span class="co">#|code-fold: false</span></span>
<span id="cb86-369"><a href="#cb86-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-370"><a href="#cb86-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-371"><a href="#cb86-371" aria-hidden="true" tabindex="-1"></a><span class="co">#write the model and get a nice table for it</span></span>
<span id="cb86-372"><a href="#cb86-372" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(<span class="fu">lm</span>(draws_10 <span class="sc">~</span> <span class="dv">1</span>))</span>
<span id="cb86-373"><a href="#cb86-373" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-374"><a href="#cb86-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-375"><a href="#cb86-375" aria-hidden="true" tabindex="-1"></a>N = 100 random draws</span>
<span id="cb86-376"><a href="#cb86-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-379"><a href="#cb86-379" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-380"><a href="#cb86-380" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: draws_100_tab</span></span>
<span id="cb86-381"><a href="#cb86-381" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb86-382"><a href="#cb86-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-383"><a href="#cb86-383" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(<span class="fu">lm</span>(draws_100 <span class="sc">~</span> <span class="dv">1</span>))</span>
<span id="cb86-384"><a href="#cb86-384" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-385"><a href="#cb86-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-386"><a href="#cb86-386" aria-hidden="true" tabindex="-1"></a>N = 10,000 random draws</span>
<span id="cb86-387"><a href="#cb86-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-390"><a href="#cb86-390" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-391"><a href="#cb86-391" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: draws_10000_tab</span></span>
<span id="cb86-392"><a href="#cb86-392" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb86-393"><a href="#cb86-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-394"><a href="#cb86-394" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(<span class="fu">lm</span>(draws_10000 <span class="sc">~</span> <span class="dv">1</span>))</span>
<span id="cb86-395"><a href="#cb86-395" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-396"><a href="#cb86-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-397"><a href="#cb86-397" aria-hidden="true" tabindex="-1"></a>What do we notice about the relationship between sample size the estimated population average?</span>
<span id="cb86-398"><a href="#cb86-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-401"><a href="#cb86-401" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-402"><a href="#cb86-402" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: compare_draws_tab</span></span>
<span id="cb86-403"><a href="#cb86-403" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb86-404"><a href="#cb86-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-405"><a href="#cb86-405" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(<span class="fu">lm</span>(draws_10 <span class="sc">~</span> <span class="dv">1</span>),</span>
<span id="cb86-406"><a href="#cb86-406" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">lm</span>(draws_100 <span class="sc">~</span> <span class="dv">1</span>),</span>
<span id="cb86-407"><a href="#cb86-407" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">lm</span>(draws_10000 <span class="sc">~</span> <span class="dv">1</span>))</span>
<span id="cb86-408"><a href="#cb86-408" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-409"><a href="#cb86-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-410"><a href="#cb86-410" aria-hidden="true" tabindex="-1"></a><span class="fu">### Regression with a single co-variate</span></span>
<span id="cb86-411"><a href="#cb86-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-412"><a href="#cb86-412" aria-hidden="true" tabindex="-1"></a>Do mothers’s heights *predict* daughter height? If so, what is the magnitude of the relationship?</span>
<span id="cb86-413"><a href="#cb86-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-414"><a href="#cb86-414" aria-hidden="true" tabindex="-1"></a>Francis Galton is credited with inventing regression analysis. Galton observed that offspring’s heights tend to fall between parental height and the population average, which Galton termed "regression to the mean." Galton sought a method for educated guessing about heights, and this led to fitting a line of regression by a method called "least squares" (For a history, see: <span class="co">[</span><span class="ot">here</span><span class="co">](https://rss.onlinelibrary.wiley.com/doi/full/10.1111/j.1740-9713.2011.00509.x)</span>).</span>
<span id="cb86-415"><a href="#cb86-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-416"><a href="#cb86-416" aria-hidden="true" tabindex="-1"></a>The following dataset is from "The heredity of height" by Karl Pearson and Alice Lee (1903)<span class="co">[</span><span class="ot">@pearson1903</span><span class="co">]</span>. I obtained it from <span class="co">[</span><span class="ot">@gelman_regression_2020</span><span class="co">]</span>. Let's use this dataset to investigate the relationship between mothers' and daughters' heights.</span>
<span id="cb86-417"><a href="#cb86-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-420"><a href="#cb86-420" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-421"><a href="#cb86-421" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: pearson_lee_data</span></span>
<span id="cb86-422"><a href="#cb86-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-423"><a href="#cb86-423" aria-hidden="true" tabindex="-1"></a><span class="co"># import data</span></span>
<span id="cb86-424"><a href="#cb86-424" aria-hidden="true" tabindex="-1"></a>df_pearson_lee <span class="ot">&lt;-</span></span>
<span id="cb86-425"><a href="#cb86-425" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="fu">read.table</span>(</span>
<span id="cb86-426"><a href="#cb86-426" aria-hidden="true" tabindex="-1"></a>    <span class="fu">url</span>(</span>
<span id="cb86-427"><a href="#cb86-427" aria-hidden="true" tabindex="-1"></a>      <span class="st">"https://raw.githubusercontent.com/avehtari/ROS-Examples/master/PearsonLee/data/MotherDaughterHeights.txt"</span></span>
<span id="cb86-428"><a href="#cb86-428" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb86-429"><a href="#cb86-429" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cn">TRUE</span></span>
<span id="cb86-430"><a href="#cb86-430" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb86-431"><a href="#cb86-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-432"><a href="#cb86-432" aria-hidden="true" tabindex="-1"></a><span class="co"># save</span></span>
<span id="cb86-433"><a href="#cb86-433" aria-hidden="true" tabindex="-1"></a><span class="co"># saveRDS(df_pearson_lee, here::here("data", "df_pearson_lee"))</span></span>
<span id="cb86-434"><a href="#cb86-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-435"><a href="#cb86-435" aria-hidden="true" tabindex="-1"></a><span class="co"># Center mother's height for later example</span></span>
<span id="cb86-436"><a href="#cb86-436" aria-hidden="true" tabindex="-1"></a>df_pearson_lee_centered <span class="ot">&lt;-</span> df_pearson_lee <span class="sc">|&gt;</span></span>
<span id="cb86-437"><a href="#cb86-437" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">mother_height_c =</span> <span class="fu">as.numeric</span>(<span class="fu">scale</span>(</span>
<span id="cb86-438"><a href="#cb86-438" aria-hidden="true" tabindex="-1"></a>    mother_height, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">FALSE</span></span>
<span id="cb86-439"><a href="#cb86-439" aria-hidden="true" tabindex="-1"></a>  )))</span>
<span id="cb86-440"><a href="#cb86-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-441"><a href="#cb86-441" aria-hidden="true" tabindex="-1"></a><span class="co"># skimr::skim(df_pearson_lee_centered)</span></span>
<span id="cb86-442"><a href="#cb86-442" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-443"><a href="#cb86-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-444"><a href="#cb86-444" aria-hidden="true" tabindex="-1"></a>Pearson and Lee collected 5,524 observations from mother/daughter height pairs. Let's examine the data, first by plotting the relationship.</span>
<span id="cb86-445"><a href="#cb86-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-446"><a href="#cb86-446" aria-hidden="true" tabindex="-1"></a>What is happening here?</span>
<span id="cb86-447"><a href="#cb86-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-450"><a href="#cb86-450" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-451"><a href="#cb86-451" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: graph_pearson_lee</span></span>
<span id="cb86-452"><a href="#cb86-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-453"><a href="#cb86-453" aria-hidden="true" tabindex="-1"></a><span class="co"># explore pearson lee data</span></span>
<span id="cb86-454"><a href="#cb86-454" aria-hidden="true" tabindex="-1"></a>explore_md <span class="ot">&lt;-</span></span>
<span id="cb86-455"><a href="#cb86-455" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> df_pearson_lee_centered, <span class="fu">aes</span>(<span class="at">y =</span> daughter_height, <span class="at">x =</span> mother_height)) <span class="sc">+</span></span>
<span id="cb86-456"><a href="#cb86-456" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb86-457"><a href="#cb86-457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"The relationship between mothers height and daughter's height"</span>) <span class="sc">+</span></span>
<span id="cb86-458"><a href="#cb86-458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Daughter's height"</span>) <span class="sc">+</span></span>
<span id="cb86-459"><a href="#cb86-459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Mother's height"</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>()</span>
<span id="cb86-460"><a href="#cb86-460" aria-hidden="true" tabindex="-1"></a>explore_md</span>
<span id="cb86-461"><a href="#cb86-461" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-462"><a href="#cb86-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-463"><a href="#cb86-463" aria-hidden="true" tabindex="-1"></a>Is there a linear predictive relationship between these two parameters? In regression we examine the line of best fit.</span>
<span id="cb86-464"><a href="#cb86-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-467"><a href="#cb86-467" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-468"><a href="#cb86-468" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: regression_pearson_lee</span></span>
<span id="cb86-469"><a href="#cb86-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-470"><a href="#cb86-470" aria-hidden="true" tabindex="-1"></a><span class="co"># regression </span></span>
<span id="cb86-471"><a href="#cb86-471" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span></span>
<span id="cb86-472"><a href="#cb86-472" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(daughter_height <span class="sc">~</span> mother_height, <span class="at">data =</span> df_pearson_lee_centered)</span>
<span id="cb86-473"><a href="#cb86-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-474"><a href="#cb86-474" aria-hidden="true" tabindex="-1"></a><span class="co"># graph</span></span>
<span id="cb86-475"><a href="#cb86-475" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(m1)</span>
<span id="cb86-476"><a href="#cb86-476" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-477"><a href="#cb86-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-478"><a href="#cb86-478" aria-hidden="true" tabindex="-1"></a>We can plot the coefficient, but in a model with one predictor, this isn't very informative. However, as we continue in the course, we'll see that plotting coefficients can be easier than deciphering the numbers in tables. Here are two methods for plotting.</span>
<span id="cb86-479"><a href="#cb86-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-482"><a href="#cb86-482" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-483"><a href="#cb86-483" aria-hidden="true" tabindex="-1"></a><span class="co"># get model parameters</span></span>
<span id="cb86-484"><a href="#cb86-484" aria-hidden="true" tabindex="-1"></a>t_m1<span class="ot">&lt;-</span>parameters<span class="sc">::</span><span class="fu">model_parameters</span>(m1,  </span>
<span id="cb86-485"><a href="#cb86-485" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">ci =</span> <span class="fl">0.95</span>)</span>
<span id="cb86-486"><a href="#cb86-486" aria-hidden="true" tabindex="-1"></a><span class="co"># plot </span></span>
<span id="cb86-487"><a href="#cb86-487" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t_m1) <span class="sc">+</span></span>
<span id="cb86-488"><a href="#cb86-488" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"The relationship between mothers height and daughter's height"</span>) <span class="sc">+</span> </span>
<span id="cb86-489"><a href="#cb86-489" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Daughter's height"</span>) </span>
<span id="cb86-490"><a href="#cb86-490" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-491"><a href="#cb86-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-492"><a href="#cb86-492" aria-hidden="true" tabindex="-1"></a><span class="fu">## How do we interpret the regression model?</span></span>
<span id="cb86-493"><a href="#cb86-493" aria-hidden="true" tabindex="-1"></a>Let's write the equation out in mathematics. How do we read this? <span class="ot">[^2]</span></span>
<span id="cb86-494"><a href="#cb86-494" aria-hidden="true" tabindex="-1"></a><span class="ot">[^2]: </span>Later, we'll prefer a different way of writing regression equations in math. (Note: writing math isn't math - it's just encoding the model that we've written).</span>
<span id="cb86-495"><a href="#cb86-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-498"><a href="#cb86-498" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-499"><a href="#cb86-499" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"equatiomatic"</span>)</span>
<span id="cb86-500"><a href="#cb86-500" aria-hidden="true" tabindex="-1"></a><span class="co"># extract equation</span></span>
<span id="cb86-501"><a href="#cb86-501" aria-hidden="true" tabindex="-1"></a><span class="co">#extract_eq(m1, use_coefs = FALSE)</span></span>
<span id="cb86-502"><a href="#cb86-502" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-503"><a href="#cb86-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-504"><a href="#cb86-504" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb86-505"><a href="#cb86-505" aria-hidden="true" tabindex="-1"></a>\operatorname{daughter<span class="sc">\_</span>height} = \alpha + \beta_{1}(\operatorname{mother<span class="sc">\_</span>height}) + \epsilon</span>
<span id="cb86-506"><a href="#cb86-506" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb86-507"><a href="#cb86-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-508"><a href="#cb86-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-509"><a href="#cb86-509" aria-hidden="true" tabindex="-1"></a>The math says that the expected daughter's height in a population is predicted by the average height of the population when mothers’ heights are set to zero units (note, this is impossible - we'll come back to this) plus $\beta ~\times$ units of daughter's height (inches) for each additional unit of mother's height (inches)</span>
<span id="cb86-510"><a href="#cb86-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-511"><a href="#cb86-511" aria-hidden="true" tabindex="-1"></a>We can plug the output of the model directly into the equation as follows:</span>
<span id="cb86-512"><a href="#cb86-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-515"><a href="#cb86-515" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-516"><a href="#cb86-516" aria-hidden="true" tabindex="-1"></a><span class="co"># extract equation</span></span>
<span id="cb86-517"><a href="#cb86-517" aria-hidden="true" tabindex="-1"></a><span class="co">#extract_eq(m1, use_coefs = TRUE)</span></span>
<span id="cb86-518"><a href="#cb86-518" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-519"><a href="#cb86-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-520"><a href="#cb86-520" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb86-521"><a href="#cb86-521" aria-hidden="true" tabindex="-1"></a>\operatorname{\widehat{daughter<span class="sc">\_</span>height}} = 29.8 + 0.54(\operatorname{mother<span class="sc">\_</span>height})</span>
<span id="cb86-522"><a href="#cb86-522" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb86-523"><a href="#cb86-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-524"><a href="#cb86-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-525"><a href="#cb86-525" aria-hidden="true" tabindex="-1"></a><span class="fu">### Graph the relationship between mother's and daughter's heights</span></span>
<span id="cb86-526"><a href="#cb86-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-529"><a href="#cb86-529" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-530"><a href="#cb86-530" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb86-531"><a href="#cb86-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-532"><a href="#cb86-532" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb86-533"><a href="#cb86-533" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> ggeffects<span class="sc">::</span><span class="fu">ggpredict</span>(m1, <span class="at">terms =</span> <span class="st">"mother_height"</span>)</span>
<span id="cb86-534"><a href="#cb86-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-535"><a href="#cb86-535" aria-hidden="true" tabindex="-1"></a>plot_predictions <span class="ot">&lt;-</span></span>
<span id="cb86-536"><a href="#cb86-536" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(</span>
<span id="cb86-537"><a href="#cb86-537" aria-hidden="true" tabindex="-1"></a>    predictions,</span>
<span id="cb86-538"><a href="#cb86-538" aria-hidden="true" tabindex="-1"></a>    <span class="at">add.data =</span> <span class="cn">TRUE</span>,</span>
<span id="cb86-539"><a href="#cb86-539" aria-hidden="true" tabindex="-1"></a>    <span class="at">dot.alpha =</span> .<span class="dv">1</span>,</span>
<span id="cb86-540"><a href="#cb86-540" aria-hidden="true" tabindex="-1"></a>    <span class="at">jitter =</span> <span class="cn">TRUE</span></span>
<span id="cb86-541"><a href="#cb86-541" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span>   <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Predicted values of daughter's height from the Pearson/Fox 1903 dataset"</span>)</span>
<span id="cb86-542"><a href="#cb86-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-543"><a href="#cb86-543" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-544"><a href="#cb86-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-545"><a href="#cb86-545" aria-hidden="true" tabindex="-1"></a><span class="fu">### Regression to predict beyond the range of a dataset</span></span>
<span id="cb86-546"><a href="#cb86-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-547"><a href="#cb86-547" aria-hidden="true" tabindex="-1"></a>Joyte Amge is the world's shortest woman at 25 inches. Sandy Allen was the world's tallest woman at 91 inches. What are the expected heights of their daughter and of every intermediary woman in between?</span>
<span id="cb86-548"><a href="#cb86-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-549"><a href="#cb86-549" aria-hidden="true" tabindex="-1"></a><span class="in">```{r code_folding = FALSE}</span></span>
<span id="cb86-550"><a href="#cb86-550" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: false</span></span>
<span id="cb86-551"><a href="#cb86-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-552"><a href="#cb86-552" aria-hidden="true" tabindex="-1"></a><span class="in"># use the `expand.grid` command to create a sequence of points for mother's height</span></span>
<span id="cb86-553"><a href="#cb86-553" aria-hidden="true" tabindex="-1"></a><span class="in">df_expand_grid &lt;- expand.grid(mother_height = c(25:91))</span></span>
<span id="cb86-554"><a href="#cb86-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-555"><a href="#cb86-555" aria-hidden="true" tabindex="-1"></a><span class="in"># use the `predict` function to create a new response</span></span>
<span id="cb86-556"><a href="#cb86-556" aria-hidden="true" tabindex="-1"></a><span class="in">df_predict &lt;-</span></span>
<span id="cb86-557"><a href="#cb86-557" aria-hidden="true" tabindex="-1"></a><span class="in">  predict(m1,</span></span>
<span id="cb86-558"><a href="#cb86-558" aria-hidden="true" tabindex="-1"></a><span class="in">          type = "response",</span></span>
<span id="cb86-559"><a href="#cb86-559" aria-hidden="true" tabindex="-1"></a><span class="in">          interval = "confidence",</span></span>
<span id="cb86-560"><a href="#cb86-560" aria-hidden="true" tabindex="-1"></a><span class="in">          newdata = df_expand_grid)</span></span>
<span id="cb86-561"><a href="#cb86-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-562"><a href="#cb86-562" aria-hidden="true" tabindex="-1"></a><span class="in"># have a look at the object</span></span>
<span id="cb86-563"><a href="#cb86-563" aria-hidden="true" tabindex="-1"></a><span class="in">#dplyr::glimpse(df_predict)</span></span>
<span id="cb86-564"><a href="#cb86-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-565"><a href="#cb86-565" aria-hidden="true" tabindex="-1"></a><span class="in"># create a new dataframe for the new sequence of points for mother's height and the predicted data</span></span>
<span id="cb86-566"><a href="#cb86-566" aria-hidden="true" tabindex="-1"></a><span class="in">newdata &lt;- data.frame(df_expand_grid, df_predict)</span></span>
<span id="cb86-567"><a href="#cb86-567" aria-hidden="true" tabindex="-1"></a><span class="in">head(newdata)</span></span>
<span id="cb86-568"><a href="#cb86-568" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-569"><a href="#cb86-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-570"><a href="#cb86-570" aria-hidden="true" tabindex="-1"></a>Graph the predicted results</span>
<span id="cb86-571"><a href="#cb86-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-574"><a href="#cb86-574" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-575"><a href="#cb86-575" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: predict_new_data</span></span>
<span id="cb86-576"><a href="#cb86-576" aria-hidden="true" tabindex="-1"></a><span class="co"># graph the expected results</span></span>
<span id="cb86-577"><a href="#cb86-577" aria-hidden="true" tabindex="-1"></a>predplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> newdata,</span>
<span id="cb86-578"><a href="#cb86-578" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">aes</span>(<span class="at">x =</span> mother_height, <span class="at">y =</span> fit))  <span class="sc">+</span></span>
<span id="cb86-579"><a href="#cb86-579" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lwr, <span class="at">ymax =</span> upr), <span class="at">width =</span> .<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb86-580"><a href="#cb86-580" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">91</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">81</span>))  <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb86-581"><a href="#cb86-581" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Predicted values for a broader population"</span>)</span>
<span id="cb86-582"><a href="#cb86-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-583"><a href="#cb86-583" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the two graphs together (making the x and y axis at the same scale </span></span>
<span id="cb86-584"><a href="#cb86-584" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"patchwork"</span>)</span>
<span id="cb86-585"><a href="#cb86-585" aria-hidden="true" tabindex="-1"></a><span class="co"># rescale heightplot</span></span>
<span id="cb86-586"><a href="#cb86-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-587"><a href="#cb86-587" aria-hidden="true" tabindex="-1"></a><span class="co"># old plot with the new axis and y-axis scales, and remove points</span></span>
<span id="cb86-588"><a href="#cb86-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-589"><a href="#cb86-589" aria-hidden="true" tabindex="-1"></a>plot_height <span class="ot">&lt;-</span> <span class="fu">plot</span>(predplot, <span class="at">add.data =</span> <span class="cn">FALSE</span>) <span class="sc">+</span>   <span class="fu">theme_classic</span>()</span>
<span id="cb86-590"><a href="#cb86-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-591"><a href="#cb86-591" aria-hidden="true" tabindex="-1"></a>plot_height_title <span class="ot">&lt;-</span></span>
<span id="cb86-592"><a href="#cb86-592" aria-hidden="true" tabindex="-1"></a>  plot_height <span class="sc">+</span>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">91</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">81</span>)) <span class="sc">+</span>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Predicted values of daughter's height from the Pearson/Fox 1903 dataset"</span>)</span>
<span id="cb86-593"><a href="#cb86-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-594"><a href="#cb86-594" aria-hidden="true" tabindex="-1"></a><span class="co"># double graph</span></span>
<span id="cb86-595"><a href="#cb86-595" aria-hidden="true" tabindex="-1"></a>plot_height_title <span class="sc">/</span> predplot  <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">"What do you notice about these relationships?"</span>, <span class="at">tag_levels =</span> <span class="st">"a"</span>)</span>
<span id="cb86-596"><a href="#cb86-596" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-597"><a href="#cb86-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-598"><a href="#cb86-598" aria-hidden="true" tabindex="-1"></a>A simple method for obtaining the predicted values from your fitted model is to obtain the effects output without producing a graph.</span>
<span id="cb86-599"><a href="#cb86-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-600"><a href="#cb86-600" aria-hidden="true" tabindex="-1"></a><span class="in">```{r code_folding = FALSE}</span></span>
<span id="cb86-601"><a href="#cb86-601" aria-hidden="true" tabindex="-1"></a><span class="in"># prediction plots</span></span>
<span id="cb86-602"><a href="#cb86-602" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggeffects)</span></span>
<span id="cb86-603"><a href="#cb86-603" aria-hidden="true" tabindex="-1"></a><span class="in"># predicted values of mother height on daughter height</span></span>
<span id="cb86-604"><a href="#cb86-604" aria-hidden="true" tabindex="-1"></a><span class="in">ggeffects::ggpredict(m1, terms = "mother_height")</span></span>
<span id="cb86-605"><a href="#cb86-605" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-606"><a href="#cb86-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-607"><a href="#cb86-607" aria-hidden="true" tabindex="-1"></a><span class="fu">### Non-linear relationships</span></span>
<span id="cb86-608"><a href="#cb86-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-609"><a href="#cb86-609" aria-hidden="true" tabindex="-1"></a>Linear regression assumes linearity conditional on a model. Often your data will not be linear!</span>
<span id="cb86-610"><a href="#cb86-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-611"><a href="#cb86-611" aria-hidden="true" tabindex="-1"></a>Consider the following example:</span>
<span id="cb86-612"><a href="#cb86-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-613"><a href="#cb86-613" aria-hidden="true" tabindex="-1"></a><span class="in">```{r code_folding = FALSE}</span></span>
<span id="cb86-614"><a href="#cb86-614" aria-hidden="true" tabindex="-1"></a><span class="in"># simulate nonlinear relationship between x and y</span></span>
<span id="cb86-615"><a href="#cb86-615" aria-hidden="true" tabindex="-1"></a><span class="in">b &lt;- c(2, 0.75)</span></span>
<span id="cb86-616"><a href="#cb86-616" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(12)</span></span>
<span id="cb86-617"><a href="#cb86-617" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- rnorm(100)</span></span>
<span id="cb86-618"><a href="#cb86-618" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(12)</span></span>
<span id="cb86-619"><a href="#cb86-619" aria-hidden="true" tabindex="-1"></a><span class="in">y &lt;- rnorm(100, mean = b[1] * exp(b[2] * x))</span></span>
<span id="cb86-620"><a href="#cb86-620" aria-hidden="true" tabindex="-1"></a><span class="in">dat1 &lt;- data.frame(x, y)</span></span>
<span id="cb86-621"><a href="#cb86-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-622"><a href="#cb86-622" aria-hidden="true" tabindex="-1"></a><span class="in">ot1 &lt;- lm(y ~ x, data  = dat1)</span></span>
<span id="cb86-623"><a href="#cb86-623" aria-hidden="true" tabindex="-1"></a><span class="in"># performance::check_model(ot1)</span></span>
<span id="cb86-624"><a href="#cb86-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-625"><a href="#cb86-625" aria-hidden="true" tabindex="-1"></a><span class="in"># plot linear effect</span></span>
<span id="cb86-626"><a href="#cb86-626" aria-hidden="true" tabindex="-1"></a><span class="in">plot(ggeffects::ggpredict(ot1, terms = "x"),</span></span>
<span id="cb86-627"><a href="#cb86-627" aria-hidden="true" tabindex="-1"></a><span class="in">     add.data = TRUE,</span></span>
<span id="cb86-628"><a href="#cb86-628" aria-hidden="true" tabindex="-1"></a><span class="in">     dot.alpha = .4)</span></span>
<span id="cb86-629"><a href="#cb86-629" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-630"><a href="#cb86-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-631"><a href="#cb86-631" aria-hidden="true" tabindex="-1"></a>Non-linear relationship as modelled by a polynomial regression:</span>
<span id="cb86-632"><a href="#cb86-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-635"><a href="#cb86-635" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-636"><a href="#cb86-636" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb86-637"><a href="#cb86-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-638"><a href="#cb86-638" aria-hidden="true" tabindex="-1"></a><span class="co"># model: quadratic</span></span>
<span id="cb86-639"><a href="#cb86-639" aria-hidden="true" tabindex="-1"></a>fit_non_linear <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x <span class="sc">^</span> <span class="dv">2</span>), <span class="at">data  =</span> dat1)</span>
<span id="cb86-640"><a href="#cb86-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-641"><a href="#cb86-641" aria-hidden="true" tabindex="-1"></a><span class="co"># predictive plot</span></span>
<span id="cb86-642"><a href="#cb86-642" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ggeffects<span class="sc">::</span><span class="fu">ggpredict</span>(fit_non_linear, <span class="at">terms =</span> <span class="st">"x"</span>),</span>
<span id="cb86-643"><a href="#cb86-643" aria-hidden="true" tabindex="-1"></a>     <span class="at">add.data =</span> <span class="cn">TRUE</span>,</span>
<span id="cb86-644"><a href="#cb86-644" aria-hidden="true" tabindex="-1"></a>     <span class="at">dot.alpha =</span> .<span class="dv">4</span>)</span>
<span id="cb86-645"><a href="#cb86-645" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-646"><a href="#cb86-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-647"><a href="#cb86-647" aria-hidden="true" tabindex="-1"></a>Here is another approach:</span>
<span id="cb86-648"><a href="#cb86-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-651"><a href="#cb86-651" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-652"><a href="#cb86-652" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb86-653"><a href="#cb86-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-654"><a href="#cb86-654" aria-hidden="true" tabindex="-1"></a><span class="co"># non-linear regression </span></span>
<span id="cb86-655"><a href="#cb86-655" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(splines)</span>
<span id="cb86-656"><a href="#cb86-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-657"><a href="#cb86-657" aria-hidden="true" tabindex="-1"></a><span class="co"># fit model </span></span>
<span id="cb86-658"><a href="#cb86-658" aria-hidden="true" tabindex="-1"></a>fit_non_linear_b <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">poly</span>(x, <span class="dv">2</span>), <span class="at">data  =</span> dat1)</span>
<span id="cb86-659"><a href="#cb86-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-660"><a href="#cb86-660" aria-hidden="true" tabindex="-1"></a><span class="co"># graph model</span></span>
<span id="cb86-661"><a href="#cb86-661" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb86-662"><a href="#cb86-662" aria-hidden="true" tabindex="-1"></a>  ggeffects<span class="sc">::</span><span class="fu">ggpredict</span>(fit_non_linear_b, <span class="at">terms =</span> <span class="st">"x"</span>),</span>
<span id="cb86-663"><a href="#cb86-663" aria-hidden="true" tabindex="-1"></a>  <span class="at">add.data =</span> <span class="cn">TRUE</span>,</span>
<span id="cb86-664"><a href="#cb86-664" aria-hidden="true" tabindex="-1"></a>  <span class="at">dot.alpha =</span> .<span class="dv">4</span></span>
<span id="cb86-665"><a href="#cb86-665" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-666"><a href="#cb86-666" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-667"><a href="#cb86-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-668"><a href="#cb86-668" aria-hidden="true" tabindex="-1"></a>Non-linear relationship as modelled by a general additive model (spline)</span>
<span id="cb86-669"><a href="#cb86-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-672"><a href="#cb86-672" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-673"><a href="#cb86-673" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb86-674"><a href="#cb86-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-675"><a href="#cb86-675" aria-hidden="true" tabindex="-1"></a><span class="co"># fit spline: not specified</span></span>
<span id="cb86-676"><a href="#cb86-676" aria-hidden="true" tabindex="-1"></a>fit_non_linear_c <span class="ot">&lt;-</span><span class="fu">lm</span>(y <span class="sc">~</span> <span class="fu">bs</span>(x), <span class="at">data  =</span> dat1)</span>
<span id="cb86-677"><a href="#cb86-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-678"><a href="#cb86-678" aria-hidden="true" tabindex="-1"></a><span class="co"># model parameters: coefficients are not interpretable</span></span>
<span id="cb86-679"><a href="#cb86-679" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">model_parameters</span>(</span>
<span id="cb86-680"><a href="#cb86-680" aria-hidden="true" tabindex="-1"></a>  fit_non_linear_c</span>
<span id="cb86-681"><a href="#cb86-681" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-682"><a href="#cb86-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-683"><a href="#cb86-683" aria-hidden="true" tabindex="-1"></a><span class="co">#performance::check_model(ot2)</span></span>
<span id="cb86-684"><a href="#cb86-684" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb86-685"><a href="#cb86-685" aria-hidden="true" tabindex="-1"></a>  ggeffects<span class="sc">::</span><span class="fu">ggpredict</span>(fit_non_linear_c, <span class="at">terms =</span> <span class="st">"x"</span>),</span>
<span id="cb86-686"><a href="#cb86-686" aria-hidden="true" tabindex="-1"></a>  <span class="at">add.data =</span> <span class="cn">TRUE</span>,</span>
<span id="cb86-687"><a href="#cb86-687" aria-hidden="true" tabindex="-1"></a>  <span class="at">dot.alpha =</span> .<span class="dv">4</span></span>
<span id="cb86-688"><a href="#cb86-688" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-689"><a href="#cb86-689" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-690"><a href="#cb86-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-691"><a href="#cb86-691" aria-hidden="true" tabindex="-1"></a><span class="fu">### Centering</span></span>
<span id="cb86-692"><a href="#cb86-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-693"><a href="#cb86-693" aria-hidden="true" tabindex="-1"></a>Any linear transformation of a predictor is *OK*. Often we centre (or centre and scale) all indicators, which gives us an interpretable intercept (the expected population average when the other indicators are set their average).</span>
<span id="cb86-694"><a href="#cb86-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-697"><a href="#cb86-697" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-698"><a href="#cb86-698" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb86-699"><a href="#cb86-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-700"><a href="#cb86-700" aria-hidden="true" tabindex="-1"></a><span class="co"># fit raw data </span></span>
<span id="cb86-701"><a href="#cb86-701" aria-hidden="true" tabindex="-1"></a>fit_raw <span class="ot">&lt;-</span> <span class="fu">lm</span>(daughter_height <span class="sc">~</span> mother_height, <span class="at">data =</span> df_pearson_lee_centered)</span>
<span id="cb86-702"><a href="#cb86-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-703"><a href="#cb86-703" aria-hidden="true" tabindex="-1"></a><span class="co"># fit centred data</span></span>
<span id="cb86-704"><a href="#cb86-704" aria-hidden="true" tabindex="-1"></a>fit_centered <span class="ot">&lt;-</span></span>
<span id="cb86-705"><a href="#cb86-705" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(daughter_height <span class="sc">~</span> mother_height_c, <span class="at">data =</span> df_pearson_lee_centered)</span>
<span id="cb86-706"><a href="#cb86-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-707"><a href="#cb86-707" aria-hidden="true" tabindex="-1"></a><span class="co"># compare the models</span></span>
<span id="cb86-708"><a href="#cb86-708" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(fit_raw, fit_centered)</span>
<span id="cb86-709"><a href="#cb86-709" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-710"><a href="#cb86-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-711"><a href="#cb86-711" aria-hidden="true" tabindex="-1"></a>Graph model</span>
<span id="cb86-712"><a href="#cb86-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-715"><a href="#cb86-715" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-716"><a href="#cb86-716" aria-hidden="true" tabindex="-1"></a><span class="co"># graph centred model</span></span>
<span id="cb86-717"><a href="#cb86-717" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb86-718"><a href="#cb86-718" aria-hidden="true" tabindex="-1"></a>  ggeffects<span class="sc">::</span><span class="fu">ggpredict</span>(fit_centered, <span class="at">terms =</span> <span class="st">"mother_height_c"</span>),</span>
<span id="cb86-719"><a href="#cb86-719" aria-hidden="true" tabindex="-1"></a>  <span class="at">add.data =</span> <span class="cn">TRUE</span>,</span>
<span id="cb86-720"><a href="#cb86-720" aria-hidden="true" tabindex="-1"></a>  <span class="at">dot.alpha =</span> .<span class="dv">4</span></span>
<span id="cb86-721"><a href="#cb86-721" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-722"><a href="#cb86-722" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-723"><a href="#cb86-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-724"><a href="#cb86-724" aria-hidden="true" tabindex="-1"></a>Note: when fitting a polynomial or any interaction, it is important to center your indicators. We'll come back to this point in later lectures.</span>
<span id="cb86-725"><a href="#cb86-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-726"><a href="#cb86-726" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model evaluation</span></span>
<span id="cb86-727"><a href="#cb86-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-728"><a href="#cb86-728" aria-hidden="true" tabindex="-1"></a>Reviewers will sometime ask you to assess model fit. </span>
<span id="cb86-729"><a href="#cb86-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-730"><a href="#cb86-730" aria-hidden="true" tabindex="-1"></a>A simple, but flawed way to assess accuracy of your model fit is to compare a model with one covariate with a simple intercept-only model and to assess improvement in either the <span class="in">`AIC`</span> statistic or the <span class="in">`BIC`</span> statistic. The <span class="in">`BIC`</span> is similar to the <span class="in">`AIC`</span> but adds a penalty for extra predictors. An absolute improvement in either statistic of n <span class="sc">\&gt;</span> 10 is considered to be a “better” model.</span>
<span id="cb86-731"><a href="#cb86-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-732"><a href="#cb86-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-733"><a href="#cb86-733" aria-hidden="true" tabindex="-1"></a>We can use the <span class="in">`performance`</span> package to generate a table that compares model fits.</span>
<span id="cb86-734"><a href="#cb86-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-735"><a href="#cb86-735" aria-hidden="true" tabindex="-1"></a><span class="in">```{r code_foldign = FALSE, code_folding =FALSE}</span></span>
<span id="cb86-736"><a href="#cb86-736" aria-hidden="true" tabindex="-1"></a><span class="in"># load library </span></span>
<span id="cb86-737"><a href="#cb86-737" aria-hidden="true" tabindex="-1"></a><span class="in">library(performance)</span></span>
<span id="cb86-738"><a href="#cb86-738" aria-hidden="true" tabindex="-1"></a><span class="in"># intercept only</span></span>
<span id="cb86-739"><a href="#cb86-739" aria-hidden="true" tabindex="-1"></a><span class="in">fig_intercept_only &lt;- lm(daughter_height ~ 1, data = df_pearson_lee)</span></span>
<span id="cb86-740"><a href="#cb86-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-741"><a href="#cb86-741" aria-hidden="true" tabindex="-1"></a><span class="in"># covariate added</span></span>
<span id="cb86-742"><a href="#cb86-742" aria-hidden="true" tabindex="-1"></a><span class="in">fig_covariate &lt;- lm(daughter_height ~ mother_height, data = df_pearson_lee)</span></span>
<span id="cb86-743"><a href="#cb86-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-744"><a href="#cb86-744" aria-hidden="true" tabindex="-1"></a><span class="in"># evaluate</span></span>
<span id="cb86-745"><a href="#cb86-745" aria-hidden="true" tabindex="-1"></a><span class="in">performance::compare_performance(fig_intercept_only, fig_covariate)</span></span>
<span id="cb86-746"><a href="#cb86-746" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-747"><a href="#cb86-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-748"><a href="#cb86-748" aria-hidden="true" tabindex="-1"></a>What was the model "improvement?"</span>
<span id="cb86-749"><a href="#cb86-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-752"><a href="#cb86-752" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-753"><a href="#cb86-753" aria-hidden="true" tabindex="-1"></a><span class="co"># improved fit</span></span>
<span id="cb86-754"><a href="#cb86-754" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(fig_intercept_only) <span class="sc">-</span> <span class="fu">BIC</span>(fig_covariate)</span>
<span id="cb86-755"><a href="#cb86-755" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-756"><a href="#cb86-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-757"><a href="#cb86-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-758"><a href="#cb86-758" aria-hidden="true" tabindex="-1"></a><span class="fu">### Generate a report</span></span>
<span id="cb86-759"><a href="#cb86-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-760"><a href="#cb86-760" aria-hidden="true" tabindex="-1"></a>This is easy with the <span class="in">`report`</span> package</span>
<span id="cb86-761"><a href="#cb86-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-762"><a href="#cb86-762" aria-hidden="true" tabindex="-1"></a>For example:</span>
<span id="cb86-763"><a href="#cb86-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-764"><a href="#cb86-764" aria-hidden="true" tabindex="-1"></a><span class="in">```{r code_folding = FALSE,}</span></span>
<span id="cb86-765"><a href="#cb86-765" aria-hidden="true" tabindex="-1"></a><span class="in">report::report_statistics(fig_covariate)</span></span>
<span id="cb86-766"><a href="#cb86-766" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-767"><a href="#cb86-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-768"><a href="#cb86-768" aria-hidden="true" tabindex="-1"></a>Or, if you want a longer report:</span>
<span id="cb86-769"><a href="#cb86-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-770"><a href="#cb86-770" aria-hidden="true" tabindex="-1"></a><span class="in">```{r code_folding = FALSE, eval=FALSE}</span></span>
<span id="cb86-771"><a href="#cb86-771" aria-hidden="true" tabindex="-1"></a><span class="in">report::report(fig_covariate)</span></span>
<span id="cb86-772"><a href="#cb86-772" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-773"><a href="#cb86-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-774"><a href="#cb86-774" aria-hidden="true" tabindex="-1"></a>Use <span class="in">`statistically significant`</span> in place of <span class="in">`significant`</span>. This will avoid misleading your audience into thinking your result is important when what you intend to communicate is that it is reliable.</span>
<span id="cb86-775"><a href="#cb86-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-776"><a href="#cb86-776" aria-hidden="true" tabindex="-1"></a><span class="fu">## Assumptions of Regression</span></span>
<span id="cb86-777"><a href="#cb86-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-778"><a href="#cb86-778" aria-hidden="true" tabindex="-1"></a>From Gelman and Hill <span class="co">[</span><span class="ot">@gelman2006</span><span class="co">]</span></span>
<span id="cb86-779"><a href="#cb86-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-780"><a href="#cb86-780" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Validity**</span>
<span id="cb86-781"><a href="#cb86-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-782"><a href="#cb86-782" aria-hidden="true" tabindex="-1"></a><span class="at">    &gt; The most important is that the data you are analyzing should map to the research question you are trying to answer </span><span class="co">[</span><span class="ot">@gelman_regression_2020, p.152</span><span class="co">]</span></span>
<span id="cb86-783"><a href="#cb86-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-784"><a href="#cb86-784" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Representativeness**</span>
<span id="cb86-785"><a href="#cb86-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-786"><a href="#cb86-786" aria-hidden="true" tabindex="-1"></a><span class="at">    &gt; A regression model is fit to data and is used to make inferences about a larger population, hence the implicit assumption in interpreting regression coefficients is that the sample is representative of the population. </span><span class="co">[</span><span class="ot">@gelman_regression_2020, p.153</span><span class="co">]</span><span class="at">\</span></span>
<span id="cb86-787"><a href="#cb86-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-788"><a href="#cb86-788" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Linearity**</span>
<span id="cb86-789"><a href="#cb86-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-790"><a href="#cb86-790" aria-hidden="true" tabindex="-1"></a><span class="at">    &gt; The most important mathematical assumption of the linear regression model is that its deterministic component is a linear function of the separate predictors: y = β0 + β1x1 + β2x2 +···. If additivity is violated, it might make sense to transform the data (for example, if y = abc, then log y = log a + log b + log c) or to add interactions. If linearity is violated, perhaps a predictor should be put in as 1/x or log(x) instead of simply linearly. Or a more complicated relationship could be expressed using a nonlinear function such as a spline or Gaussian process, </span><span class="co">[</span><span class="ot">@gelman_regression_2020, p.153</span><span class="co">]</span></span>
<span id="cb86-791"><a href="#cb86-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-792"><a href="#cb86-792" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**Independence of errors**</span>
<span id="cb86-793"><a href="#cb86-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-794"><a href="#cb86-794" aria-hidden="true" tabindex="-1"></a><span class="at">    &gt; The simple regression model assumes that the errors from the prediction line are independent, an assumption that is violated in time series, spatial, and multilevel settings </span><span class="co">[</span><span class="ot">@gelman_regression_2020, p.153</span><span class="co">]</span></span>
<span id="cb86-795"><a href="#cb86-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-796"><a href="#cb86-796" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>**Equal variance of errors**</span>
<span id="cb86-797"><a href="#cb86-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-798"><a href="#cb86-798" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; ...unequal variance does not affect the most important aspect of a regression model, which is the form of the predictors </span><span class="co">[</span><span class="ot">@gelman_regression_2020, p.153</span><span class="co">]</span></span>
<span id="cb86-799"><a href="#cb86-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-800"><a href="#cb86-800" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>**Normality of errors (statistical independence)**</span>
<span id="cb86-801"><a href="#cb86-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-802"><a href="#cb86-802" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The regression assumption that is generally least important is that the errors are normally distributed. In fact, for the purpose of estimating the regression line (as compared to predicting individual data points), the assumption of normality is barely important at all. Thus, in contrast to many regression textbooks, we do not recommend diagnostics of the normality of re-gression residuals. </span><span class="co">[</span><span class="ot">@gelman2006, p. 46</span><span class="co">]</span></span>
<span id="cb86-803"><a href="#cb86-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-804"><a href="#cb86-804" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; A good way to diagnose violations of some of the assumptions just considered (importantly, linearity) is to plot the residuals versus fitted values or simply individual predictors.</span><span class="co">[</span><span class="ot">@gelman2006 p. 46</span><span class="co">]</span></span>
<span id="cb86-805"><a href="#cb86-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-806"><a href="#cb86-806" aria-hidden="true" tabindex="-1"></a><span class="fu">### Common Confusions</span></span>
<span id="cb86-807"><a href="#cb86-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-808"><a href="#cb86-808" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Regressions do not automatically give us “effects”</span></span>
<span id="cb86-809"><a href="#cb86-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-810"><a href="#cb86-810" aria-hidden="true" tabindex="-1"></a>**People use the work "effect", but that is not what regression gives us, by default.**</span>
<span id="cb86-811"><a href="#cb86-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-812"><a href="#cb86-812" aria-hidden="true" tabindex="-1"></a><span class="fu">#### "Normality Assumption"</span></span>
<span id="cb86-813"><a href="#cb86-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-814"><a href="#cb86-814" aria-hidden="true" tabindex="-1"></a>Gelman and Hill note that the "normality" assumption is the least important. The assumption pertains to the normality of residuals.</span>
<span id="cb86-815"><a href="#cb86-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-816"><a href="#cb86-816" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Statistical Independence</span></span>
<span id="cb86-817"><a href="#cb86-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-818"><a href="#cb86-818" aria-hidden="true" tabindex="-1"></a>This is the motivation for doing multi-level modelling: to condition on dependencies in the data. However, multi-level modelling can produce new problems if the error terms in the model are not independent of the outcome. </span>
<span id="cb86-819"><a href="#cb86-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-820"><a href="#cb86-820" aria-hidden="true" tabindex="-1"></a><span class="fu">#### External Validity (wrong population)</span></span>
<span id="cb86-821"><a href="#cb86-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-822"><a href="#cb86-822" aria-hidden="true" tabindex="-1"></a>We sample from undergraduates, but infer about the human population.</span>
<span id="cb86-823"><a href="#cb86-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-824"><a href="#cb86-824" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb86-825"><a href="#cb86-825" aria-hidden="true" tabindex="-1"></a>**NOTE**: The concept of “better model fit” is relative to our interests and purposes.  A better (lower) AIC statistic does not tell us whether a model is better for better causal inference. We must assess whether a model satisfies the assumptions necessary for valid causal inference.</span>
<span id="cb86-826"><a href="#cb86-826" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-827"><a href="#cb86-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-828"><a href="#cb86-828" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simulation Demonstration 1: How Regression Coefficients Mislead</span></span>
<span id="cb86-829"><a href="#cb86-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-830"><a href="#cb86-830" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Methodology</span></span>
<span id="cb86-831"><a href="#cb86-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-832"><a href="#cb86-832" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Data Generation**: we simulate a dataset for 1,000 individuals, where religious service attendance ($A$) affects wealth ($L$), which in turn affects charitable donations ($Y$). The simulation is based on predefined parameters that establish L as a mediator between $A$ and $Y$.</span>
<span id="cb86-833"><a href="#cb86-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-834"><a href="#cb86-834" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Parameter Definitions**:</span>
<span id="cb86-835"><a href="#cb86-835" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The probability of religious service ($A$) is set at 0.5.</span>
<span id="cb86-836"><a href="#cb86-836" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The effect of $A$ on $L$ (wealth) is given by $\beta = 2$.</span>
<span id="cb86-837"><a href="#cb86-837" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The effect of $L$ on $Y$ (charity) is given by $\delta = 1.5$.</span>
<span id="cb86-838"><a href="#cb86-838" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Standard deviations for $L$ and $Y$ are set at 1 and 1.5, respectively.</span>
<span id="cb86-839"><a href="#cb86-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-840"><a href="#cb86-840" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Model Specifications**:</span>
<span id="cb86-841"><a href="#cb86-841" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**Model 1** (Correct Assumption): considerss a linear regression model assuming $L$ as a mediator, including $A$ and $L$ as regressors on $Y$. This model aligns with the data-generating process and correctly identifies L as a mediator. According to the rules of d-separation (last week): **to identify the total effect of $A$ on $Y$ we must not include $L$**</span>
<span id="cb86-842"><a href="#cb86-842" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**Model 2** (Correct model): This fits a linear regression model that includes only $A$ as a regressor on $Y$ and omits the mediator $L$. This model assesses the direct effect of $A$ on $Y$ without accounting for mediation.</span>
<span id="cb86-843"><a href="#cb86-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-844"><a href="#cb86-844" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Analysis and Comparison**: the analysis compares the estimated effects of $A$ on $Y$ under both model specifications. By including $L$ as a predictor in Model 1, we induce mediation bias. Whereas Model 2 correctly excludes $L$ from the model. </span>
<span id="cb86-845"><a href="#cb86-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-846"><a href="#cb86-846" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Presentation**: the results are displayed in a comparative table formatted for publication. The table contrasts the regression coefficients and significance levels obtained under each model.</span>
<span id="cb86-847"><a href="#cb86-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-848"><a href="#cb86-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-851"><a href="#cb86-851" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-852"><a href="#cb86-852" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: simulation_cross_sectional</span></span>
<span id="cb86-853"><a href="#cb86-853" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Code for a simulation of a data generating process in which the effect of exercise (L) fully mediates the effect of greenspace (A) on happiness (Y)."</span></span>
<span id="cb86-854"><a href="#cb86-854" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: 100%</span></span>
<span id="cb86-855"><a href="#cb86-855" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb86-856"><a href="#cb86-856" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb86-857"><a href="#cb86-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-858"><a href="#cb86-858" aria-hidden="true" tabindex="-1"></a><span class="co"># simulation seed</span></span>
<span id="cb86-859"><a href="#cb86-859" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co">#  reproducibility</span></span>
<span id="cb86-860"><a href="#cb86-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-861"><a href="#cb86-861" aria-hidden="true" tabindex="-1"></a><span class="co"># define the parameters </span></span>
<span id="cb86-862"><a href="#cb86-862" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">1000</span> <span class="co"># Number of observations</span></span>
<span id="cb86-863"><a href="#cb86-863" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fl">0.5</span>  <span class="co"># Probability of A = 1 </span></span>
<span id="cb86-864"><a href="#cb86-864" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="dv">0</span> <span class="co"># Intercept for L </span></span>
<span id="cb86-865"><a href="#cb86-865" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">=</span> <span class="dv">2</span>  <span class="co"># Effect of A on L </span></span>
<span id="cb86-866"><a href="#cb86-866" aria-hidden="true" tabindex="-1"></a>gamma <span class="ot">=</span> <span class="dv">1</span> <span class="co"># Intercept for Y </span></span>
<span id="cb86-867"><a href="#cb86-867" aria-hidden="true" tabindex="-1"></a>delta <span class="ot">=</span> <span class="fl">1.5</span> <span class="co"># Effect of L on Y</span></span>
<span id="cb86-868"><a href="#cb86-868" aria-hidden="true" tabindex="-1"></a>sigma_L <span class="ot">=</span> <span class="dv">1</span> <span class="co"># Standard deviation of L</span></span>
<span id="cb86-869"><a href="#cb86-869" aria-hidden="true" tabindex="-1"></a>sigma_Y <span class="ot">=</span> <span class="fl">1.5</span> <span class="co"># Standard deviation of Y</span></span>
<span id="cb86-870"><a href="#cb86-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-871"><a href="#cb86-871" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate the data: fully mediated effect by L</span></span>
<span id="cb86-872"><a href="#cb86-872" aria-hidden="true" tabindex="-1"></a>A <span class="ot">=</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, p) <span class="co"># binary exposure variable</span></span>
<span id="cb86-873"><a href="#cb86-873" aria-hidden="true" tabindex="-1"></a>L <span class="ot">=</span> alpha <span class="sc">+</span> beta<span class="sc">*</span>A <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, sigma_L) <span class="co"># mediator L affect by A</span></span>
<span id="cb86-874"><a href="#cb86-874" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">=</span> gamma <span class="sc">+</span> delta<span class="sc">*</span>L <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, sigma_Y) <span class="co"># Y affected only by L,</span></span>
<span id="cb86-875"><a href="#cb86-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-876"><a href="#cb86-876" aria-hidden="true" tabindex="-1"></a><span class="co"># make the data frame</span></span>
<span id="cb86-877"><a href="#cb86-877" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">A =</span> A, <span class="at">L =</span> L, <span class="at">Y =</span> Y)</span>
<span id="cb86-878"><a href="#cb86-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-879"><a href="#cb86-879" aria-hidden="true" tabindex="-1"></a><span class="co"># fit regression in which L is assumed to be a mediator</span></span>
<span id="cb86-880"><a href="#cb86-880" aria-hidden="true" tabindex="-1"></a><span class="co"># (cross-sectional data is consistent with this model)</span></span>
<span id="cb86-881"><a href="#cb86-881" aria-hidden="true" tabindex="-1"></a>example_fit_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>( Y <span class="sc">~</span> A <span class="sc">+</span> L, <span class="at">data =</span> data)</span>
<span id="cb86-882"><a href="#cb86-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-883"><a href="#cb86-883" aria-hidden="true" tabindex="-1"></a><span class="co"># fit regression in which L is assumed to be a mediator</span></span>
<span id="cb86-884"><a href="#cb86-884" aria-hidden="true" tabindex="-1"></a><span class="co"># (cross-sectional data is also consistent with this model)</span></span>
<span id="cb86-885"><a href="#cb86-885" aria-hidden="true" tabindex="-1"></a>example_fit_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>( Y <span class="sc">~</span> A, <span class="at">data =</span> data)</span>
<span id="cb86-886"><a href="#cb86-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-887"><a href="#cb86-887" aria-hidden="true" tabindex="-1"></a><span class="co"># create gtsummary tables for each regression model</span></span>
<span id="cb86-888"><a href="#cb86-888" aria-hidden="true" tabindex="-1"></a>table1 <span class="ot">&lt;-</span> gtsummary<span class="sc">::</span><span class="fu">tbl_regression</span>(example_fit_1)</span>
<span id="cb86-889"><a href="#cb86-889" aria-hidden="true" tabindex="-1"></a>table2 <span class="ot">&lt;-</span> gtsummary<span class="sc">::</span><span class="fu">tbl_regression</span>(example_fit_2)</span>
<span id="cb86-890"><a href="#cb86-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-891"><a href="#cb86-891" aria-hidden="true" tabindex="-1"></a><span class="co"># merge the tables for comparison</span></span>
<span id="cb86-892"><a href="#cb86-892" aria-hidden="true" tabindex="-1"></a>table_comparison <span class="ot">&lt;-</span> gtsummary<span class="sc">::</span><span class="fu">tbl_merge</span>(</span>
<span id="cb86-893"><a href="#cb86-893" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(table1, table2),</span>
<span id="cb86-894"><a href="#cb86-894" aria-hidden="true" tabindex="-1"></a>  <span class="at">tab_spanner =</span> <span class="fu">c</span>(<span class="st">"Model: Wealth assumed confounder"</span>, </span>
<span id="cb86-895"><a href="#cb86-895" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Model: Wealth assumed to be a mediator"</span>)</span>
<span id="cb86-896"><a href="#cb86-896" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-897"><a href="#cb86-897" aria-hidden="true" tabindex="-1"></a><span class="co"># make latex table (for publication)</span></span>
<span id="cb86-898"><a href="#cb86-898" aria-hidden="true" tabindex="-1"></a>markdown_table_0 <span class="ot">&lt;-</span> <span class="fu">as_kable_extra</span>(table_comparison, </span>
<span id="cb86-899"><a href="#cb86-899" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">format =</span> <span class="st">"markdown"</span>, </span>
<span id="cb86-900"><a href="#cb86-900" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">booktabs =</span> <span class="cn">TRUE</span>)</span>
<span id="cb86-901"><a href="#cb86-901" aria-hidden="true" tabindex="-1"></a><span class="co"># print markdown table (note, you might prefer "latex" or another format)                                </span></span>
<span id="cb86-902"><a href="#cb86-902" aria-hidden="true" tabindex="-1"></a>markdown_table_0</span>
<span id="cb86-903"><a href="#cb86-903" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-904"><a href="#cb86-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-905"><a href="#cb86-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-906"><a href="#cb86-906" aria-hidden="true" tabindex="-1"></a><span class="fu">### Compare model fits</span></span>
<span id="cb86-907"><a href="#cb86-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-908"><a href="#cb86-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-909"><a href="#cb86-909" aria-hidden="true" tabindex="-1"></a><span class="fu">#### By all metrics, model 1 fits better but it is confounded</span></span>
<span id="cb86-912"><a href="#cb86-912" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-913"><a href="#cb86-913" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">compare_performance</span>(example_fit_1, example_fit_2)</span>
<span id="cb86-914"><a href="#cb86-914" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-915"><a href="#cb86-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-916"><a href="#cb86-916" aria-hidden="true" tabindex="-1"></a>Model 1 exhibits mediator bias, but it has a considerably higher $R^2$, and a lower BIC</span>
<span id="cb86-917"><a href="#cb86-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-918"><a href="#cb86-918" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Focussing on the BIC (lower is better) Model 1 fits better, but it is confounded.</span></span>
<span id="cb86-921"><a href="#cb86-921" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-922"><a href="#cb86-922" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(example_fit_1) <span class="sc">-</span> <span class="fu">BIC</span>(example_fit_2)</span>
<span id="cb86-923"><a href="#cb86-923" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-924"><a href="#cb86-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-925"><a href="#cb86-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-926"><a href="#cb86-926" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb86-927"><a href="#cb86-927" aria-hidden="true" tabindex="-1"></a>In this simulation, we discovered that if we assess "effect" by "model fit" we will get the wrong *sign* for the coefficient of interest. The use of model fit perpetuates the *causality crisis* in psychological science <span class="co">[</span><span class="ot">@bulbulia2022</span><span class="co">]</span>. Few are presently aware of this crisis. Causal diagrams show us how we can do better.</span>
<span id="cb86-928"><a href="#cb86-928" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-929"><a href="#cb86-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-930"><a href="#cb86-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-931"><a href="#cb86-931" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simulation Demonstration 2: How Regression Coefficients Mislead</span></span>
<span id="cb86-932"><a href="#cb86-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-933"><a href="#cb86-933" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Methodology</span></span>
<span id="cb86-934"><a href="#cb86-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-935"><a href="#cb86-935" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Data Generation**:  simulate a dataset for 1,000 individuals, where religious service attendance ($A$) affects wealth ($L$),and chartitable donations charitable donations ($Y$) also affects wealth $L$, but $A$ and $Y$ are not causally related</span>
<span id="cb86-936"><a href="#cb86-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-937"><a href="#cb86-937" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Parameter Definitions**:</span>
<span id="cb86-938"><a href="#cb86-938" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The probability of religious service ($A$) is set at 0.5.</span>
<span id="cb86-939"><a href="#cb86-939" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>$Y$ is has a mean $0$ and sd = $1$, and is independent of $A$.</span>
<span id="cb86-940"><a href="#cb86-940" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>$L$ is a linear function of $A$ and $Y$.</span>
<span id="cb86-941"><a href="#cb86-941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-942"><a href="#cb86-942" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Model Specifications**:</span>
<span id="cb86-943"><a href="#cb86-943" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**Model 1** (Correct Assumption): do not control for $L$</span>
<span id="cb86-944"><a href="#cb86-944" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**Model 2** (Correct model): control for $L$</span>
<span id="cb86-945"><a href="#cb86-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-946"><a href="#cb86-946" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Analysis and Comparison**: compare models. </span>
<span id="cb86-947"><a href="#cb86-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-948"><a href="#cb86-948" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Presentation**: a table.</span>
<span id="cb86-949"><a href="#cb86-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-950"><a href="#cb86-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-953"><a href="#cb86-953" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-954"><a href="#cb86-954" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: simulation_cross_sectional_2</span></span>
<span id="cb86-955"><a href="#cb86-955" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "L is a collider of A and Y."</span></span>
<span id="cb86-956"><a href="#cb86-956" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: 100%</span></span>
<span id="cb86-957"><a href="#cb86-957" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb86-958"><a href="#cb86-958" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb86-959"><a href="#cb86-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-960"><a href="#cb86-960" aria-hidden="true" tabindex="-1"></a><span class="co"># simulation seed</span></span>
<span id="cb86-961"><a href="#cb86-961" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co">#  reproducibility</span></span>
<span id="cb86-962"><a href="#cb86-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-963"><a href="#cb86-963" aria-hidden="true" tabindex="-1"></a><span class="co"># define parameters </span></span>
<span id="cb86-964"><a href="#cb86-964" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">1000</span> <span class="co"># Number of observations</span></span>
<span id="cb86-965"><a href="#cb86-965" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fl">0.5</span>  <span class="co"># Probability of A = 1 </span></span>
<span id="cb86-966"><a href="#cb86-966" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="dv">0</span> <span class="co"># Intercept for L</span></span>
<span id="cb86-967"><a href="#cb86-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-968"><a href="#cb86-968" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate the data</span></span>
<span id="cb86-969"><a href="#cb86-969" aria-hidden="true" tabindex="-1"></a>A_1 <span class="ot">=</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, p) <span class="co"># binary exposure variable</span></span>
<span id="cb86-970"><a href="#cb86-970" aria-hidden="true" tabindex="-1"></a>Y_1 <span class="ot">=</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>) <span class="co"># Y affected only by L,</span></span>
<span id="cb86-971"><a href="#cb86-971" aria-hidden="true" tabindex="-1"></a>L_2 <span class="ot">=</span> <span class="fu">rnorm</span>(n, A <span class="sc">+</span> Y)</span>
<span id="cb86-972"><a href="#cb86-972" aria-hidden="true" tabindex="-1"></a><span class="co"># make the data frame</span></span>
<span id="cb86-973"><a href="#cb86-973" aria-hidden="true" tabindex="-1"></a>data_collider <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">A =</span> A_1, <span class="at">L =</span> L_2, <span class="at">Y =</span> Y_1)</span>
<span id="cb86-974"><a href="#cb86-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-975"><a href="#cb86-975" aria-hidden="true" tabindex="-1"></a><span class="co"># fit regression in which L is assumed to be a mediator</span></span>
<span id="cb86-976"><a href="#cb86-976" aria-hidden="true" tabindex="-1"></a><span class="co"># (cross-sectional data is consistent with this model)</span></span>
<span id="cb86-977"><a href="#cb86-977" aria-hidden="true" tabindex="-1"></a>collider_example_fit_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>( Y <span class="sc">~</span> A <span class="sc">+</span> L, <span class="at">data =</span> data_collider)</span>
<span id="cb86-978"><a href="#cb86-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-979"><a href="#cb86-979" aria-hidden="true" tabindex="-1"></a><span class="co"># fit regression in which L is assumed to be a mediator</span></span>
<span id="cb86-980"><a href="#cb86-980" aria-hidden="true" tabindex="-1"></a><span class="co"># (cross-sectional data is also consistent with this model)</span></span>
<span id="cb86-981"><a href="#cb86-981" aria-hidden="true" tabindex="-1"></a>collider_example_fit_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>( Y <span class="sc">~</span> A, <span class="at">data =</span> data_collider)</span>
<span id="cb86-982"><a href="#cb86-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-983"><a href="#cb86-983" aria-hidden="true" tabindex="-1"></a><span class="co"># create gtsummary tables for each regression model</span></span>
<span id="cb86-984"><a href="#cb86-984" aria-hidden="true" tabindex="-1"></a>collider_table1 <span class="ot">&lt;-</span> gtsummary<span class="sc">::</span><span class="fu">tbl_regression</span>(collider_example_fit_1)</span>
<span id="cb86-985"><a href="#cb86-985" aria-hidden="true" tabindex="-1"></a>collider_table2 <span class="ot">&lt;-</span> gtsummary<span class="sc">::</span><span class="fu">tbl_regression</span>(collider_example_fit_2)</span>
<span id="cb86-986"><a href="#cb86-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-987"><a href="#cb86-987" aria-hidden="true" tabindex="-1"></a><span class="co"># merge the tables for comparison</span></span>
<span id="cb86-988"><a href="#cb86-988" aria-hidden="true" tabindex="-1"></a>collider_table_comparison <span class="ot">&lt;-</span> gtsummary<span class="sc">::</span><span class="fu">tbl_merge</span>(</span>
<span id="cb86-989"><a href="#cb86-989" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(collider_table1, collider_table2),</span>
<span id="cb86-990"><a href="#cb86-990" aria-hidden="true" tabindex="-1"></a>  <span class="at">tab_spanner =</span> <span class="fu">c</span>(<span class="st">"Model: Wealth assumed confounder"</span>, </span>
<span id="cb86-991"><a href="#cb86-991" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Model: Wealth not assumed to be a mediator"</span>)</span>
<span id="cb86-992"><a href="#cb86-992" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-993"><a href="#cb86-993" aria-hidden="true" tabindex="-1"></a><span class="co"># make latex table (for publication)</span></span>
<span id="cb86-994"><a href="#cb86-994" aria-hidden="true" tabindex="-1"></a>markdown_table_1 <span class="ot">&lt;-</span> <span class="fu">as_kable_extra</span>(collider_table_comparison, </span>
<span id="cb86-995"><a href="#cb86-995" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">format =</span> <span class="st">"markdown"</span>, </span>
<span id="cb86-996"><a href="#cb86-996" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">booktabs =</span> <span class="cn">TRUE</span>)</span>
<span id="cb86-997"><a href="#cb86-997" aria-hidden="true" tabindex="-1"></a><span class="co"># print markdown table (note, you might prefer "latex" or another format)                                </span></span>
<span id="cb86-998"><a href="#cb86-998" aria-hidden="true" tabindex="-1"></a>collider_table_comparison</span>
<span id="cb86-999"><a href="#cb86-999" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1000"><a href="#cb86-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1001"><a href="#cb86-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1002"><a href="#cb86-1002" aria-hidden="true" tabindex="-1"></a><span class="fu">### Compare model fits</span></span>
<span id="cb86-1003"><a href="#cb86-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1004"><a href="#cb86-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1005"><a href="#cb86-1005" aria-hidden="true" tabindex="-1"></a><span class="fu">#### By all metrics, model 1 fits better but it is confounded. </span></span>
<span id="cb86-1006"><a href="#cb86-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1007"><a href="#cb86-1007" aria-hidden="true" tabindex="-1"></a>$A$ is not causally associated with $Y$. We generated the data so we know.  However, the confounded model shows a better fit, and in this model the coefficient for $A$ is significant (and negative). </span>
<span id="cb86-1008"><a href="#cb86-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1009"><a href="#cb86-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1012"><a href="#cb86-1012" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1013"><a href="#cb86-1013" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">compare_performance</span>(collider_example_fit_1, collider_example_fit_2)</span>
<span id="cb86-1014"><a href="#cb86-1014" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1015"><a href="#cb86-1015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1016"><a href="#cb86-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1017"><a href="#cb86-1017" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Again, the BIC for (lower is better) Model 1 fits better, but it is entirely confounded.</span></span>
<span id="cb86-1018"><a href="#cb86-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1021"><a href="#cb86-1021" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1022"><a href="#cb86-1022" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(collider_example_fit_1) <span class="sc">-</span> <span class="fu">BIC</span>(collider_example_fit_2)</span>
<span id="cb86-1023"><a href="#cb86-1023" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1024"><a href="#cb86-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1025"><a href="#cb86-1025" aria-hidden="true" tabindex="-1"></a>How does collider bias work? If we know that someone is *not* attending church, if they are charitable then we can *predict* they are wealthy. Similarly if we know someone is not wealthy but charitable, we can *predict* they attend religious service. </span>
<span id="cb86-1026"><a href="#cb86-1026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1027"><a href="#cb86-1027" aria-hidden="true" tabindex="-1"></a>However,  in this simulation, we know the religion and wealth are *not* casually associated because we have simulated the data.</span>
<span id="cb86-1028"><a href="#cb86-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1029"><a href="#cb86-1029" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb86-1030"><a href="#cb86-1030" aria-hidden="true" tabindex="-1"></a>In this simulation, we discovered that if we assess "effect" by "model fit", we get the **wrong scientific inference*. The use of model fit perpetuates the *causality crisis* in psychological science <span class="co">[</span><span class="ot">@bulbulia2022</span><span class="co">]</span>. Let's do better. </span>
<span id="cb86-1031"><a href="#cb86-1031" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-1032"><a href="#cb86-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1033"><a href="#cb86-1033" aria-hidden="true" tabindex="-1"></a><span class="fu">## Resources on Regression that Do Not Perpetuate The Causality Crisis</span></span>
<span id="cb86-1034"><a href="#cb86-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1035"><a href="#cb86-1035" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Statistical Rethinking** <span class="co">[</span><span class="ot">@mcelreath2020</span><span class="co">]</span></span>
<span id="cb86-1036"><a href="#cb86-1036" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Regression and Other Stories** <span class="co">[</span><span class="ot">@gelman_regression_2020</span><span class="co">]</span></span>
<span id="cb86-1037"><a href="#cb86-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1038"><a href="#cb86-1038" aria-hidden="true" tabindex="-1"></a><span class="fu">## Setup </span></span>
<span id="cb86-1039"><a href="#cb86-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1040"><a href="#cb86-1040" aria-hidden="true" tabindex="-1"></a><span class="fu">### Libraries</span></span>
<span id="cb86-1043"><a href="#cb86-1043" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1044"><a href="#cb86-1044" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb86-1045"><a href="#cb86-1045" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb86-1046"><a href="#cb86-1046" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb86-1047"><a href="#cb86-1047" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb86-1048"><a href="#cb86-1048" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb86-1049"><a href="#cb86-1049" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1050"><a href="#cb86-1050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1051"><a href="#cb86-1051" aria-hidden="true" tabindex="-1"></a><span class="fu">### Get data</span></span>
<span id="cb86-1052"><a href="#cb86-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1055"><a href="#cb86-1055" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1056"><a href="#cb86-1056" aria-hidden="true" tabindex="-1"></a><span class="co"># package with data</span></span>
<span id="cb86-1057"><a href="#cb86-1057" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(margot)</span>
<span id="cb86-1058"><a href="#cb86-1058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1059"><a href="#cb86-1059" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb86-1060"><a href="#cb86-1060" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"df_nz"</span>)</span>
<span id="cb86-1061"><a href="#cb86-1061" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1062"><a href="#cb86-1062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1063"><a href="#cb86-1063" aria-hidden="true" tabindex="-1"></a><span class="fu">### Import `Pearson and Lee` mother's and daughters data</span></span>
<span id="cb86-1064"><a href="#cb86-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1067"><a href="#cb86-1067" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1068"><a href="#cb86-1068" aria-hidden="true" tabindex="-1"></a>df_pearson_lee <span class="ot">&lt;-</span></span>
<span id="cb86-1069"><a href="#cb86-1069" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="fu">read.table</span>(</span>
<span id="cb86-1070"><a href="#cb86-1070" aria-hidden="true" tabindex="-1"></a>    <span class="fu">url</span>(</span>
<span id="cb86-1071"><a href="#cb86-1071" aria-hidden="true" tabindex="-1"></a>      <span class="st">"https://raw.githubusercontent.com/avehtari/ROS-Examples/master/PearsonLee/data/MotherDaughterHeights.txt"</span></span>
<span id="cb86-1072"><a href="#cb86-1072" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb86-1073"><a href="#cb86-1073" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cn">TRUE</span></span>
<span id="cb86-1074"><a href="#cb86-1074" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb86-1075"><a href="#cb86-1075" aria-hidden="true" tabindex="-1"></a><span class="co"># Center mother's height for later example</span></span>
<span id="cb86-1076"><a href="#cb86-1076" aria-hidden="true" tabindex="-1"></a>df_pearson_lee <span class="ot">&lt;-</span> df_pearson_lee<span class="sc">|&gt;</span></span>
<span id="cb86-1077"><a href="#cb86-1077" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">mother_height_c =</span> <span class="fu">as.numeric</span>(<span class="fu">scale</span>(</span>
<span id="cb86-1078"><a href="#cb86-1078" aria-hidden="true" tabindex="-1"></a>    mother_height, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">FALSE</span></span>
<span id="cb86-1079"><a href="#cb86-1079" aria-hidden="true" tabindex="-1"></a>  )))</span>
<span id="cb86-1080"><a href="#cb86-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1081"><a href="#cb86-1081" aria-hidden="true" tabindex="-1"></a><span class="co"># dplyr::glimpse(df_pearson_lee)</span></span>
<span id="cb86-1082"><a href="#cb86-1082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1083"><a href="#cb86-1083" aria-hidden="true" tabindex="-1"></a><span class="co"># In 1903, Pearson and Lee collected 5,524 observations from mother/daughter height pairs. See lecture 5 for details</span></span>
<span id="cb86-1084"><a href="#cb86-1084" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1085"><a href="#cb86-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1086"><a href="#cb86-1086" aria-hidden="true" tabindex="-1"></a><span class="fu">### Note</span></span>
<span id="cb86-1087"><a href="#cb86-1087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1088"><a href="#cb86-1088" aria-hidden="true" tabindex="-1"></a>**For all exercises below, use only the 2018 wave of the `df_nz` dataset.**</span>
<span id="cb86-1089"><a href="#cb86-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1090"><a href="#cb86-1090" aria-hidden="true" tabindex="-1"></a>colnames(df_nz)</span>
<span id="cb86-1091"><a href="#cb86-1091" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q1. Create a descriptive table and a descriptive graph for the `hlth_weight` and `hlth_height` variables in the `df_nz` dataset</span></span>
<span id="cb86-1092"><a href="#cb86-1092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1093"><a href="#cb86-1093" aria-hidden="true" tabindex="-1"></a>Select <span class="in">`hlth_height`</span>, <span class="in">`hlth_weight`</span> from the nz dataset. </span>
<span id="cb86-1094"><a href="#cb86-1094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1095"><a href="#cb86-1095" aria-hidden="true" tabindex="-1"></a>Filter only the 2018 wave.</span>
<span id="cb86-1096"><a href="#cb86-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1097"><a href="#cb86-1097" aria-hidden="true" tabindex="-1"></a>Create a descriptive table and graph these two variables</span>
<span id="cb86-1098"><a href="#cb86-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1099"><a href="#cb86-1099" aria-hidden="true" tabindex="-1"></a>Annotate your workflow (at each step, describe what you are doing and why).</span>
<span id="cb86-1100"><a href="#cb86-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1101"><a href="#cb86-1101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1102"><a href="#cb86-1102" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q2. Regression height ~ weight and report results</span></span>
<span id="cb86-1103"><a href="#cb86-1103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1104"><a href="#cb86-1104" aria-hidden="true" tabindex="-1"></a>Using the <span class="in">`df_nz`</span> dataset, write a regression model for height as predicted by weight. </span>
<span id="cb86-1105"><a href="#cb86-1105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1106"><a href="#cb86-1106" aria-hidden="true" tabindex="-1"></a>Create a table for your results. </span>
<span id="cb86-1107"><a href="#cb86-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1108"><a href="#cb86-1108" aria-hidden="true" tabindex="-1"></a>Create a graphs/graphs to clarify the results of your regression model. </span>
<span id="cb86-1109"><a href="#cb86-1109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1110"><a href="#cb86-1110" aria-hidden="true" tabindex="-1"></a>Briefly report your results. </span>
<span id="cb86-1111"><a href="#cb86-1111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1112"><a href="#cb86-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1113"><a href="#cb86-1113" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q3. Regress height ~ male and report results</span></span>
<span id="cb86-1114"><a href="#cb86-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1115"><a href="#cb86-1115" aria-hidden="true" tabindex="-1"></a>Using the <span class="in">`df_nz`</span> dataset, write a regression model for height as predicted by <span class="in">`male`</span> </span>
<span id="cb86-1116"><a href="#cb86-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1117"><a href="#cb86-1117" aria-hidden="true" tabindex="-1"></a>Create a table for your results. </span>
<span id="cb86-1118"><a href="#cb86-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1119"><a href="#cb86-1119" aria-hidden="true" tabindex="-1"></a>Create a graphs/graphs to clarify the results of your regression model. </span>
<span id="cb86-1120"><a href="#cb86-1120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1121"><a href="#cb86-1121" aria-hidden="true" tabindex="-1"></a>Briefly report your results. </span>
<span id="cb86-1122"><a href="#cb86-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1123"><a href="#cb86-1123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1124"><a href="#cb86-1124" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q4. Regression to predict</span></span>
<span id="cb86-1125"><a href="#cb86-1125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1126"><a href="#cb86-1126" aria-hidden="true" tabindex="-1"></a>Using the regression coefficients from the Pearson and Lee 1903 dataset, predict the heights of daughters of women in the <span class="in">`df_nz`</span> dataset. </span>
<span id="cb86-1127"><a href="#cb86-1127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1128"><a href="#cb86-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1129"><a href="#cb86-1129" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q5. Bonus</span></span>
<span id="cb86-1130"><a href="#cb86-1130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1131"><a href="#cb86-1131" aria-hidden="true" tabindex="-1"></a>On average, how much taller or shorter are women in New Zealand as sampled in 2019 <span class="in">`df_nz`</span> dataset compared with women in 1903 as sampled in the Pearson and Lee dataset. </span>
<span id="cb86-1132"><a href="#cb86-1132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1133"><a href="#cb86-1133" aria-hidden="true" tabindex="-1"></a>Clarify your inference.</span>
<span id="cb86-1134"><a href="#cb86-1134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1135"><a href="#cb86-1135" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solutions: Set Up</span></span>
<span id="cb86-1136"><a href="#cb86-1136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1137"><a href="#cb86-1137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1138"><a href="#cb86-1138" aria-hidden="true" tabindex="-1"></a><span class="in">```{r  libraries}</span></span>
<span id="cb86-1139"><a href="#cb86-1139" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: libs_for_problemset</span></span>
<span id="cb86-1140"><a href="#cb86-1140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1141"><a href="#cb86-1141" aria-hidden="true" tabindex="-1"></a><span class="in">### libraries</span></span>
<span id="cb86-1142"><a href="#cb86-1142" aria-hidden="true" tabindex="-1"></a><span class="in">library("tidyverse")</span></span>
<span id="cb86-1143"><a href="#cb86-1143" aria-hidden="true" tabindex="-1"></a><span class="in">library("patchwork")</span></span>
<span id="cb86-1144"><a href="#cb86-1144" aria-hidden="true" tabindex="-1"></a><span class="in">library("lubridate")</span></span>
<span id="cb86-1145"><a href="#cb86-1145" aria-hidden="true" tabindex="-1"></a><span class="in">library("kableExtra")</span></span>
<span id="cb86-1146"><a href="#cb86-1146" aria-hidden="true" tabindex="-1"></a><span class="in">library("gtsummary")</span></span>
<span id="cb86-1147"><a href="#cb86-1147" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1148"><a href="#cb86-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1151"><a href="#cb86-1151" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1152"><a href="#cb86-1152" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: problem_set_get_data</span></span>
<span id="cb86-1153"><a href="#cb86-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1154"><a href="#cb86-1154" aria-hidden="true" tabindex="-1"></a><span class="co"># get data</span></span>
<span id="cb86-1155"><a href="#cb86-1155" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"margot"</span>)</span>
<span id="cb86-1156"><a href="#cb86-1156" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"df_nz"</span>)</span>
<span id="cb86-1157"><a href="#cb86-1157" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1160"><a href="#cb86-1160" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1161"><a href="#cb86-1161" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: problem_set_get_pearsonleedata</span></span>
<span id="cb86-1162"><a href="#cb86-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1163"><a href="#cb86-1163" aria-hidden="true" tabindex="-1"></a><span class="co"># Import `Pearson and Lee` mother's and daughters data</span></span>
<span id="cb86-1164"><a href="#cb86-1164" aria-hidden="true" tabindex="-1"></a><span class="co"># In 1903, Pearson and Lee collected 5,524 observations from mother/daughter height pairs. </span></span>
<span id="cb86-1165"><a href="#cb86-1165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1166"><a href="#cb86-1166" aria-hidden="true" tabindex="-1"></a>df_pearson_lee <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">read.table</span>(</span>
<span id="cb86-1167"><a href="#cb86-1167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">url</span>(</span>
<span id="cb86-1168"><a href="#cb86-1168" aria-hidden="true" tabindex="-1"></a>    <span class="st">"https://raw.githubusercontent.com/avehtari/ROS-Examples/master/PearsonLee/data/MotherDaughterHeights.txt"</span></span>
<span id="cb86-1169"><a href="#cb86-1169" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb86-1170"><a href="#cb86-1170" aria-hidden="true" tabindex="-1"></a>  <span class="at">header =</span> <span class="cn">TRUE</span></span>
<span id="cb86-1171"><a href="#cb86-1171" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb86-1172"><a href="#cb86-1172" aria-hidden="true" tabindex="-1"></a><span class="co"># Center mother's height for later example</span></span>
<span id="cb86-1173"><a href="#cb86-1173" aria-hidden="true" tabindex="-1"></a>df_pearson_lee <span class="ot">&lt;-</span> df_pearson_lee<span class="sc">|&gt;</span></span>
<span id="cb86-1174"><a href="#cb86-1174" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">mother_height_c =</span> <span class="fu">as.numeric</span>(<span class="fu">scale</span>(</span>
<span id="cb86-1175"><a href="#cb86-1175" aria-hidden="true" tabindex="-1"></a>    mother_height, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">FALSE</span></span>
<span id="cb86-1176"><a href="#cb86-1176" aria-hidden="true" tabindex="-1"></a>  )))</span>
<span id="cb86-1177"><a href="#cb86-1177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1178"><a href="#cb86-1178" aria-hidden="true" tabindex="-1"></a><span class="co"># dplyr::glimpse(df_pearson_lee)</span></span>
<span id="cb86-1179"><a href="#cb86-1179" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1180"><a href="#cb86-1180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1181"><a href="#cb86-1181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1182"><a href="#cb86-1182" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution Q1 descriptive table</span></span>
<span id="cb86-1183"><a href="#cb86-1183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1184"><a href="#cb86-1184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1187"><a href="#cb86-1187" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1188"><a href="#cb86-1188" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl_tables</span></span>
<span id="cb86-1189"><a href="#cb86-1189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1190"><a href="#cb86-1190" aria-hidden="true" tabindex="-1"></a><span class="co"># required libraries</span></span>
<span id="cb86-1191"><a href="#cb86-1191" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb86-1192"><a href="#cb86-1192" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb86-1193"><a href="#cb86-1193" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(margot)</span>
<span id="cb86-1194"><a href="#cb86-1194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1195"><a href="#cb86-1195" aria-hidden="true" tabindex="-1"></a><span class="co"># select focal variables and rename them for clarity</span></span>
<span id="cb86-1196"><a href="#cb86-1196" aria-hidden="true" tabindex="-1"></a>df_nzdat <span class="ot">&lt;-</span> df_nz  <span class="sc">|&gt;</span></span>
<span id="cb86-1197"><a href="#cb86-1197" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(wave <span class="sc">==</span> <span class="dv">2019</span>) <span class="sc">|&gt;</span></span>
<span id="cb86-1198"><a href="#cb86-1198" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(hlth_weight, hlth_height, male) <span class="sc">|&gt;</span></span>
<span id="cb86-1199"><a href="#cb86-1199" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">weight =</span> hlth_weight,</span>
<span id="cb86-1200"><a href="#cb86-1200" aria-hidden="true" tabindex="-1"></a>                <span class="at">height =</span> hlth_height) <span class="sc">|&gt;</span></span>
<span id="cb86-1201"><a href="#cb86-1201" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(weight, height, male) <span class="sc">|&gt;</span></span>
<span id="cb86-1202"><a href="#cb86-1202" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">weight_c =</span> <span class="fu">as.numeric</span>(<span class="fu">scale</span>(</span>
<span id="cb86-1203"><a href="#cb86-1203" aria-hidden="true" tabindex="-1"></a>    weight, <span class="at">scale =</span> F, <span class="at">center =</span> <span class="cn">TRUE</span></span>
<span id="cb86-1204"><a href="#cb86-1204" aria-hidden="true" tabindex="-1"></a>  )))</span>
<span id="cb86-1205"><a href="#cb86-1205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1206"><a href="#cb86-1206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1207"><a href="#cb86-1207" aria-hidden="true" tabindex="-1"></a><span class="co"># create table</span></span>
<span id="cb86-1208"><a href="#cb86-1208" aria-hidden="true" tabindex="-1"></a>df_nzdat <span class="sc">|&gt;</span> </span>
<span id="cb86-1209"><a href="#cb86-1209" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(weight,</span>
<span id="cb86-1210"><a href="#cb86-1210" aria-hidden="true" tabindex="-1"></a>                height) <span class="sc">|&gt;</span> </span>
<span id="cb86-1211"><a href="#cb86-1211" aria-hidden="true" tabindex="-1"></a>  gtsummary<span class="sc">::</span><span class="fu">tbl_summary</span>(</span>
<span id="cb86-1212"><a href="#cb86-1212" aria-hidden="true" tabindex="-1"></a>    <span class="co">#by = wave,</span></span>
<span id="cb86-1213"><a href="#cb86-1213" aria-hidden="true" tabindex="-1"></a>    <span class="at">statistic =</span> <span class="fu">list</span>(</span>
<span id="cb86-1214"><a href="#cb86-1214" aria-hidden="true" tabindex="-1"></a>      <span class="fu">all_continuous</span>() <span class="sc">~</span> <span class="st">"{mean} ({sd})"</span>,</span>
<span id="cb86-1215"><a href="#cb86-1215" aria-hidden="true" tabindex="-1"></a>      <span class="fu">all_categorical</span>() <span class="sc">~</span> <span class="st">"{n} / {N} ({p}%)"</span></span>
<span id="cb86-1216"><a href="#cb86-1216" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb86-1217"><a href="#cb86-1217" aria-hidden="true" tabindex="-1"></a>    <span class="at">digits =</span> <span class="fu">all_continuous</span>() <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb86-1218"><a href="#cb86-1218" aria-hidden="true" tabindex="-1"></a>    <span class="at">missing_text =</span> <span class="st">"(Missing)"</span></span>
<span id="cb86-1219"><a href="#cb86-1219" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">|&gt;</span></span>
<span id="cb86-1220"><a href="#cb86-1220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_labels</span>() </span>
<span id="cb86-1221"><a href="#cb86-1221" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1222"><a href="#cb86-1222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1223"><a href="#cb86-1223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1224"><a href="#cb86-1224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1225"><a href="#cb86-1225" aria-hidden="true" tabindex="-1"></a>Here's another approach:</span>
<span id="cb86-1226"><a href="#cb86-1226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1227"><a href="#cb86-1227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1230"><a href="#cb86-1230" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1231"><a href="#cb86-1231" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: second_table</span></span>
<span id="cb86-1232"><a href="#cb86-1232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1233"><a href="#cb86-1233" aria-hidden="true" tabindex="-1"></a><span class="co"># libs we need</span></span>
<span id="cb86-1234"><a href="#cb86-1234" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(table1)</span>
<span id="cb86-1235"><a href="#cb86-1235" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb86-1236"><a href="#cb86-1236" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb86-1237"><a href="#cb86-1237" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(margot)</span>
<span id="cb86-1238"><a href="#cb86-1238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1239"><a href="#cb86-1239" aria-hidden="true" tabindex="-1"></a><span class="co"># filter 2019 wave</span></span>
<span id="cb86-1240"><a href="#cb86-1240" aria-hidden="true" tabindex="-1"></a>df_nz_1 <span class="ot">&lt;-</span> df_nz<span class="sc">|&gt;</span></span>
<span id="cb86-1241"><a href="#cb86-1241" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(wave <span class="sc">==</span> <span class="dv">2019</span>)</span>
<span id="cb86-1242"><a href="#cb86-1242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1243"><a href="#cb86-1243" aria-hidden="true" tabindex="-1"></a><span class="co"># nicer labels</span></span>
<span id="cb86-1244"><a href="#cb86-1244" aria-hidden="true" tabindex="-1"></a>table1<span class="sc">::</span><span class="fu">label</span>(df_nz_1<span class="sc">$</span>hlth_weight)     <span class="ot">&lt;-</span> <span class="st">"Weight"</span></span>
<span id="cb86-1245"><a href="#cb86-1245" aria-hidden="true" tabindex="-1"></a>table1<span class="sc">::</span><span class="fu">label</span>(df_nz_1<span class="sc">$</span>hlth_height)     <span class="ot">&lt;-</span> <span class="st">"Height"</span></span>
<span id="cb86-1246"><a href="#cb86-1246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1247"><a href="#cb86-1247" aria-hidden="true" tabindex="-1"></a><span class="co"># table</span></span>
<span id="cb86-1248"><a href="#cb86-1248" aria-hidden="true" tabindex="-1"></a>table1<span class="sc">::</span><span class="fu">table1</span>(<span class="sc">~</span> hlth_weight <span class="sc">+</span> hlth_height, <span class="at">data =</span> df_nz_1)     </span>
<span id="cb86-1249"><a href="#cb86-1249" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1250"><a href="#cb86-1250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1251"><a href="#cb86-1251" aria-hidden="true" tabindex="-1"></a>Create graph</span>
<span id="cb86-1252"><a href="#cb86-1252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1255"><a href="#cb86-1255" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1256"><a href="#cb86-1256" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: shape_data</span></span>
<span id="cb86-1257"><a href="#cb86-1257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1258"><a href="#cb86-1258" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"patchwork"</span>)</span>
<span id="cb86-1259"><a href="#cb86-1259" aria-hidden="true" tabindex="-1"></a><span class="co"># create data set where filtering na vals</span></span>
<span id="cb86-1260"><a href="#cb86-1260" aria-hidden="true" tabindex="-1"></a>df_nzdat1 <span class="ot">&lt;-</span> df_nzdat <span class="sc">|&gt;</span> </span>
<span id="cb86-1261"><a href="#cb86-1261" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(weight),</span>
<span id="cb86-1262"><a href="#cb86-1262" aria-hidden="true" tabindex="-1"></a>                  <span class="sc">!</span><span class="fu">is.na</span>(height),</span>
<span id="cb86-1263"><a href="#cb86-1263" aria-hidden="true" tabindex="-1"></a>                  <span class="sc">!</span><span class="fu">is.na</span>(male)) <span class="co"># filter na's for density plots</span></span>
<span id="cb86-1264"><a href="#cb86-1264" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb86-1265"><a href="#cb86-1265" aria-hidden="true" tabindex="-1"></a>weight_density <span class="ot">&lt;-</span>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> df_nzdat1, <span class="fu">aes</span>(<span class="at">x =</span> weight)) <span class="sc">+</span> <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"chocolate2"</span>) <span class="sc">+</span> </span>
<span id="cb86-1266"><a href="#cb86-1266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Density plot of weight of NZ sample years 2019/2020"</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>()</span>
<span id="cb86-1267"><a href="#cb86-1267" aria-hidden="true" tabindex="-1"></a>weight_density</span>
<span id="cb86-1268"><a href="#cb86-1268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1269"><a href="#cb86-1269" aria-hidden="true" tabindex="-1"></a>height_density <span class="ot">&lt;-</span>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> df_nzdat1, <span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span> <span class="fu">geom_density</span>(<span class="at">fill =</span><span class="st">"blue2"</span>) <span class="sc">+</span> </span>
<span id="cb86-1270"><a href="#cb86-1270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Density plot of height of NZ sample years 2019/2020"</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>()</span>
<span id="cb86-1271"><a href="#cb86-1271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1272"><a href="#cb86-1272" aria-hidden="true" tabindex="-1"></a>height_density</span>
<span id="cb86-1273"><a href="#cb86-1273" aria-hidden="true" tabindex="-1"></a>weight_density <span class="sc">/</span> height_density <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'a'</span>)</span>
<span id="cb86-1274"><a href="#cb86-1274" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1275"><a href="#cb86-1275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1276"><a href="#cb86-1276" aria-hidden="true" tabindex="-1"></a>Here's a density plot:</span>
<span id="cb86-1277"><a href="#cb86-1277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1280"><a href="#cb86-1280" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1281"><a href="#cb86-1281" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: density_plot</span></span>
<span id="cb86-1282"><a href="#cb86-1282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1283"><a href="#cb86-1283" aria-hidden="true" tabindex="-1"></a><span class="co"># library</span></span>
<span id="cb86-1284"><a href="#cb86-1284" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb86-1285"><a href="#cb86-1285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1286"><a href="#cb86-1286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1287"><a href="#cb86-1287" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> df_nzdat1, <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">fill =</span> <span class="fu">as.factor</span>(male))) <span class="sc">+</span></span>
<span id="cb86-1288"><a href="#cb86-1288" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span> </span>
<span id="cb86-1289"><a href="#cb86-1289" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Density plot of weight of NZ sample years 2019/2020"</span>) <span class="sc">+</span></span>
<span id="cb86-1290"><a href="#cb86-1290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb86-1291"><a href="#cb86-1291" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>() <span class="co"># nicer colour</span></span>
<span id="cb86-1292"><a href="#cb86-1292" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1293"><a href="#cb86-1293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1294"><a href="#cb86-1294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1295"><a href="#cb86-1295" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution Q2. Regress height ~ weight and report results</span></span>
<span id="cb86-1296"><a href="#cb86-1296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1297"><a href="#cb86-1297" aria-hidden="true" tabindex="-1"></a>**Using the `nz` dataset, write a regression model for height as predicted by weight.  Create a table for your results.  Create a graphs/graphs to clarify the results of your regression model.  Briefly report your results.**</span>
<span id="cb86-1298"><a href="#cb86-1298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1299"><a href="#cb86-1299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1300"><a href="#cb86-1300" aria-hidden="true" tabindex="-1"></a>Model:</span>
<span id="cb86-1301"><a href="#cb86-1301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1304"><a href="#cb86-1304" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1305"><a href="#cb86-1305" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: regression_height_nz</span></span>
<span id="cb86-1306"><a href="#cb86-1306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1307"><a href="#cb86-1307" aria-hidden="true" tabindex="-1"></a><span class="co"># regression of height ~ weight</span></span>
<span id="cb86-1308"><a href="#cb86-1308" aria-hidden="true" tabindex="-1"></a>fit_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(height <span class="sc">~</span> weight_c, <span class="at">data =</span> df_nzdat)</span>
<span id="cb86-1309"><a href="#cb86-1309" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1310"><a href="#cb86-1310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1311"><a href="#cb86-1311" aria-hidden="true" tabindex="-1"></a>Table:</span>
<span id="cb86-1312"><a href="#cb86-1312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1315"><a href="#cb86-1315" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1316"><a href="#cb86-1316" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: regression_height_nz_table</span></span>
<span id="cb86-1317"><a href="#cb86-1317" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters)</span>
<span id="cb86-1318"><a href="#cb86-1318" aria-hidden="true" tabindex="-1"></a><span class="co">#table of model</span></span>
<span id="cb86-1319"><a href="#cb86-1319" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">model_parameters</span>( fit_1) <span class="sc">|&gt;</span> </span>
<span id="cb86-1320"><a href="#cb86-1320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print_html</span>(  <span class="at">digits =</span> <span class="dv">2</span>,  <span class="co"># options</span></span>
<span id="cb86-1321"><a href="#cb86-1321" aria-hidden="true" tabindex="-1"></a>               <span class="at">select =</span> <span class="st">"{coef}{stars}|({ci})"</span>,</span>
<span id="cb86-1322"><a href="#cb86-1322" aria-hidden="true" tabindex="-1"></a>               <span class="at">column_labels =</span> <span class="fu">c</span>(<span class="st">"Estimate"</span>, <span class="st">"95% CI"</span>)</span>
<span id="cb86-1323"><a href="#cb86-1323" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb86-1324"><a href="#cb86-1324" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1325"><a href="#cb86-1325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1326"><a href="#cb86-1326" aria-hidden="true" tabindex="-1"></a>Prediction:</span>
<span id="cb86-1327"><a href="#cb86-1327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1330"><a href="#cb86-1330" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1331"><a href="#cb86-1331" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: regression_height_nz_prediction</span></span>
<span id="cb86-1332"><a href="#cb86-1332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1333"><a href="#cb86-1333" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure necessary libraries are loaded</span></span>
<span id="cb86-1334"><a href="#cb86-1334" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb86-1335"><a href="#cb86-1335" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb86-1336"><a href="#cb86-1336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1337"><a href="#cb86-1337" aria-hidden="true" tabindex="-1"></a><span class="co"># generate the plot with adjusted y-scale</span></span>
<span id="cb86-1338"><a href="#cb86-1338" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ggeffects<span class="sc">::</span><span class="fu">ggpredict</span>(fit_1, <span class="at">terms =</span> <span class="st">"weight_c"</span>)) </span>
<span id="cb86-1339"><a href="#cb86-1339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1340"><a href="#cb86-1340" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1341"><a href="#cb86-1341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1342"><a href="#cb86-1342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1343"><a href="#cb86-1343" aria-hidden="true" tabindex="-1"></a>Briefly report your results. (note: please replace "significant" with "statistically significant.)</span>
<span id="cb86-1344"><a href="#cb86-1344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1347"><a href="#cb86-1347" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1348"><a href="#cb86-1348" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: regression_height_nz_report</span></span>
<span id="cb86-1349"><a href="#cb86-1349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1350"><a href="#cb86-1350" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(fit_1)</span>
<span id="cb86-1351"><a href="#cb86-1351" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1352"><a href="#cb86-1352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1353"><a href="#cb86-1353" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution Q3. Regress height ~ male and report results</span></span>
<span id="cb86-1354"><a href="#cb86-1354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1355"><a href="#cb86-1355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1356"><a href="#cb86-1356" aria-hidden="true" tabindex="-1"></a>**Using the `df_nz` dataset, write a regression model for height as predicted by `male`  Create a table for your results.  Create a graph/graphs to clarify the results of your regression model. Briefly report your results.**</span>
<span id="cb86-1357"><a href="#cb86-1357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1358"><a href="#cb86-1358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1359"><a href="#cb86-1359" aria-hidden="true" tabindex="-1"></a>Model and table:</span>
<span id="cb86-1360"><a href="#cb86-1360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1363"><a href="#cb86-1363" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1364"><a href="#cb86-1364" aria-hidden="true" tabindex="-1"></a><span class="co"># regression of height ~ weight</span></span>
<span id="cb86-1365"><a href="#cb86-1365" aria-hidden="true" tabindex="-1"></a>fit_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(height <span class="sc">~</span> male, <span class="at">data =</span> df_nzdat)</span>
<span id="cb86-1366"><a href="#cb86-1366" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(fit_2)</span>
<span id="cb86-1367"><a href="#cb86-1367" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1368"><a href="#cb86-1368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1369"><a href="#cb86-1369" aria-hidden="true" tabindex="-1"></a>Graph:</span>
<span id="cb86-1370"><a href="#cb86-1370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1373"><a href="#cb86-1373" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1374"><a href="#cb86-1374" aria-hidden="true" tabindex="-1"></a><span class="co"># plot over the range of the data</span></span>
<span id="cb86-1375"><a href="#cb86-1375" aria-hidden="true" tabindex="-1"></a>plot_fit_2 <span class="ot">&lt;-</span> <span class="fu">plot</span>(</span>
<span id="cb86-1376"><a href="#cb86-1376" aria-hidden="true" tabindex="-1"></a>  ggeffects<span class="sc">::</span><span class="fu">ggpredict</span>(fit_2, <span class="at">terms =</span> <span class="st">"male [all]"</span>),</span>
<span id="cb86-1377"><a href="#cb86-1377" aria-hidden="true" tabindex="-1"></a>  <span class="at">add.data =</span> <span class="cn">TRUE</span>,</span>
<span id="cb86-1378"><a href="#cb86-1378" aria-hidden="true" tabindex="-1"></a>  <span class="at">dot.alpha =</span> .<span class="dv">2</span>,</span>
<span id="cb86-1379"><a href="#cb86-1379" aria-hidden="true" tabindex="-1"></a>  <span class="at">jitter =</span> .<span class="dv">1</span></span>
<span id="cb86-1380"><a href="#cb86-1380" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb86-1381"><a href="#cb86-1381" aria-hidden="true" tabindex="-1"></a>plot_fit_2 <span class="sc">+</span> </span>
<span id="cb86-1382"><a href="#cb86-1382" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">1.2</span>, <span class="fl">2.1</span>))</span>
<span id="cb86-1383"><a href="#cb86-1383" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1384"><a href="#cb86-1384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1385"><a href="#cb86-1385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1386"><a href="#cb86-1386" aria-hidden="true" tabindex="-1"></a>Report</span>
<span id="cb86-1387"><a href="#cb86-1387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1390"><a href="#cb86-1390" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1391"><a href="#cb86-1391" aria-hidden="true" tabindex="-1"></a><span class="co"># report</span></span>
<span id="cb86-1392"><a href="#cb86-1392" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(fit_2)</span>
<span id="cb86-1393"><a href="#cb86-1393" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1394"><a href="#cb86-1394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1395"><a href="#cb86-1395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1396"><a href="#cb86-1396" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution Q4. Regression to predict</span></span>
<span id="cb86-1397"><a href="#cb86-1397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1398"><a href="#cb86-1398" aria-hidden="true" tabindex="-1"></a>**Using the regression coefficients from the Pearson and Lee 1903 dataset, predict the heights of daughters of women in the `nz` dataset.** </span>
<span id="cb86-1401"><a href="#cb86-1401" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1402"><a href="#cb86-1402" aria-hidden="true" tabindex="-1"></a><span class="co"># model for daughter height from mother height</span></span>
<span id="cb86-1403"><a href="#cb86-1403" aria-hidden="true" tabindex="-1"></a>fit_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(daughter_height <span class="sc">~</span> mother_height, <span class="at">data =</span> df_pearson_lee)</span>
<span id="cb86-1404"><a href="#cb86-1404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1405"><a href="#cb86-1405" aria-hidden="true" tabindex="-1"></a><span class="co"># create data frame of not_male's in 2019</span></span>
<span id="cb86-1406"><a href="#cb86-1406" aria-hidden="true" tabindex="-1"></a><span class="co"># notice problem. not_male != woman</span></span>
<span id="cb86-1407"><a href="#cb86-1407" aria-hidden="true" tabindex="-1"></a><span class="co"># additionally, woman != mother!</span></span>
<span id="cb86-1408"><a href="#cb86-1408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1409"><a href="#cb86-1409" aria-hidden="true" tabindex="-1"></a>df_nz_2 <span class="ot">&lt;-</span> df_nzdat<span class="sc">|&gt;</span></span>
<span id="cb86-1410"><a href="#cb86-1410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(male <span class="sc">==</span> <span class="dv">1</span>)<span class="sc">|&gt;</span> <span class="co"># not_males</span></span>
<span id="cb86-1411"><a href="#cb86-1411" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(height)<span class="sc">|&gt;</span> <span class="co"># variable of interest</span></span>
<span id="cb86-1412"><a href="#cb86-1412" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">mother_height =</span> height <span class="sc">*</span> <span class="fl">39.36</span>)<span class="sc">|&gt;</span> <span class="co"># Convert meters to inches</span></span>
<span id="cb86-1413"><a href="#cb86-1413" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(mother_height)<span class="sc">|&gt;</span></span>
<span id="cb86-1414"><a href="#cb86-1414" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>((mother_height))</span>
<span id="cb86-1415"><a href="#cb86-1415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1416"><a href="#cb86-1416" aria-hidden="true" tabindex="-1"></a><span class="co"># find min and max heights, store as objects</span></span>
<span id="cb86-1417"><a href="#cb86-1417" aria-hidden="true" tabindex="-1"></a>min_mother_height <span class="ot">&lt;-</span> <span class="fu">min</span>(df_nz_2<span class="sc">$</span>mother_height, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb86-1418"><a href="#cb86-1418" aria-hidden="true" tabindex="-1"></a>max_mother_height <span class="ot">&lt;-</span> <span class="fu">max</span>(df_nz_2<span class="sc">$</span>mother_height, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb86-1419"><a href="#cb86-1419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1420"><a href="#cb86-1420" aria-hidden="true" tabindex="-1"></a><span class="co"># expand grid, use stored objects to define boundaries.</span></span>
<span id="cb86-1421"><a href="#cb86-1421" aria-hidden="true" tabindex="-1"></a>df_expand_grid_nz_2 <span class="ot">&lt;-</span></span>
<span id="cb86-1422"><a href="#cb86-1422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand.grid</span>(<span class="at">mother_height =</span> <span class="fu">seq</span>(</span>
<span id="cb86-1423"><a href="#cb86-1423" aria-hidden="true" tabindex="-1"></a>    <span class="at">from =</span> min_mother_height,</span>
<span id="cb86-1424"><a href="#cb86-1424" aria-hidden="true" tabindex="-1"></a>    <span class="at">to =</span> max_mother_height,</span>
<span id="cb86-1425"><a href="#cb86-1425" aria-hidden="true" tabindex="-1"></a>    <span class="at">length.out =</span> <span class="dv">200</span></span>
<span id="cb86-1426"><a href="#cb86-1426" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb86-1427"><a href="#cb86-1427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1428"><a href="#cb86-1428" aria-hidden="true" tabindex="-1"></a><span class="co"># use the `predict` function to create a new response using the pearson and fox regression model</span></span>
<span id="cb86-1429"><a href="#cb86-1429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1430"><a href="#cb86-1430" aria-hidden="true" tabindex="-1"></a>predict_fit_3 <span class="ot">&lt;-</span></span>
<span id="cb86-1431"><a href="#cb86-1431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(fit_3,</span>
<span id="cb86-1432"><a href="#cb86-1432" aria-hidden="true" tabindex="-1"></a>          <span class="at">type =</span> <span class="st">"response"</span>,</span>
<span id="cb86-1433"><a href="#cb86-1433" aria-hidden="true" tabindex="-1"></a>          <span class="at">interval =</span> <span class="st">"confidence"</span>,</span>
<span id="cb86-1434"><a href="#cb86-1434" aria-hidden="true" tabindex="-1"></a>          <span class="at">newdata =</span> df_expand_grid_nz_2)</span>
<span id="cb86-1435"><a href="#cb86-1435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1436"><a href="#cb86-1436" aria-hidden="true" tabindex="-1"></a><span class="co"># create a new dataframe for the response variables, following the method in lecture 5</span></span>
<span id="cb86-1437"><a href="#cb86-1437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1438"><a href="#cb86-1438" aria-hidden="true" tabindex="-1"></a><span class="co"># combine variables into a data frame</span></span>
<span id="cb86-1439"><a href="#cb86-1439" aria-hidden="true" tabindex="-1"></a>df_expand_grid_nz_2_predict_fit_3 <span class="ot">&lt;-</span></span>
<span id="cb86-1440"><a href="#cb86-1440" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(df_expand_grid_nz_2, predict_fit_3)</span>
<span id="cb86-1441"><a href="#cb86-1441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1442"><a href="#cb86-1442" aria-hidden="true" tabindex="-1"></a><span class="co"># graph the expected average hypothetical heights of "daughters"</span></span>
<span id="cb86-1443"><a href="#cb86-1443" aria-hidden="true" tabindex="-1"></a>predplot2 <span class="ot">&lt;-</span></span>
<span id="cb86-1444"><a href="#cb86-1444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> df_expand_grid_nz_2_predict_fit_3,</span>
<span id="cb86-1445"><a href="#cb86-1445" aria-hidden="true" tabindex="-1"></a>         <span class="fu">aes</span>(<span class="at">x =</span> mother_height,</span>
<span id="cb86-1446"><a href="#cb86-1446" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> fit))  <span class="sc">+</span></span>
<span id="cb86-1447"><a href="#cb86-1447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">colour =</span> <span class="st">"cadetblue"</span>)  <span class="sc">+</span>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lwr, <span class="at">ymax =</span> upr), <span class="at">width =</span> .<span class="dv">1</span>) <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">75</span>)) <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">75</span>)) <span class="sc">+</span> <span class="fu">theme_classic</span>()  <span class="sc">+</span></span>
<span id="cb86-1448"><a href="#cb86-1448" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"NZ 2019 female population"</span>) <span class="sc">+</span></span>
<span id="cb86-1449"><a href="#cb86-1449" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"predicted daughter heights in inches"</span>) <span class="sc">+</span></span>
<span id="cb86-1450"><a href="#cb86-1450" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Regression prediction for hypothetical daughter heights of NZ population in 2019 "</span>)</span>
<span id="cb86-1451"><a href="#cb86-1451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1452"><a href="#cb86-1452" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb86-1453"><a href="#cb86-1453" aria-hidden="true" tabindex="-1"></a>predplot2</span>
<span id="cb86-1454"><a href="#cb86-1454" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1455"><a href="#cb86-1455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1456"><a href="#cb86-1456" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution Q6. Bonus</span></span>
<span id="cb86-1457"><a href="#cb86-1457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1458"><a href="#cb86-1458" aria-hidden="true" tabindex="-1"></a>**On average, how much taller or shorter are women in New Zealand as sampled in 2019 `nz` dataset compared with women in 1903 as sampled in the Pearson and Lee dataset.**</span>
<span id="cb86-1459"><a href="#cb86-1459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1460"><a href="#cb86-1460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1463"><a href="#cb86-1463" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1464"><a href="#cb86-1464" aria-hidden="true" tabindex="-1"></a><span class="co"># create var for 1903 dataset</span></span>
<span id="cb86-1465"><a href="#cb86-1465" aria-hidden="true" tabindex="-1"></a><span class="co"># For the historical dataset (assuming year 1903 for df_pearson_lee_2)</span></span>
<span id="cb86-1466"><a href="#cb86-1466" aria-hidden="true" tabindex="-1"></a>df_pearson_lee_2 <span class="ot">&lt;-</span> df_pearson_lee <span class="sc">|&gt;</span></span>
<span id="cb86-1467"><a href="#cb86-1467" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(mother_height, daughter_height) <span class="sc">|&gt;</span></span>
<span id="cb86-1468"><a href="#cb86-1468" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"relation"</span>, <span class="at">values_to =</span> <span class="st">"f_height"</span>) <span class="sc">|&gt;</span></span>
<span id="cb86-1469"><a href="#cb86-1469" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">year_is =</span> <span class="fu">factor</span>(<span class="st">"1903"</span>))</span>
<span id="cb86-1470"><a href="#cb86-1470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1471"><a href="#cb86-1471" aria-hidden="true" tabindex="-1"></a><span class="co"># create var the 2019 dataset</span></span>
<span id="cb86-1472"><a href="#cb86-1472" aria-hidden="true" tabindex="-1"></a>df_nz_combine_pearson_lee <span class="ot">&lt;-</span> df_nz_2 <span class="sc">|&gt;</span></span>
<span id="cb86-1473"><a href="#cb86-1473" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">f_height =</span> mother_height) <span class="sc">|&gt;</span></span>
<span id="cb86-1474"><a href="#cb86-1474" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">year_is =</span> <span class="fu">factor</span>(<span class="st">"2019"</span>),</span>
<span id="cb86-1475"><a href="#cb86-1475" aria-hidden="true" tabindex="-1"></a>                <span class="at">relation =</span> <span class="fu">factor</span>(<span class="st">"mother"</span>))</span>
<span id="cb86-1476"><a href="#cb86-1476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1477"><a href="#cb86-1477" aria-hidden="true" tabindex="-1"></a><span class="co"># both dataframes have the `year_is` column but with different factor levels</span></span>
<span id="cb86-1478"><a href="#cb86-1478" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb86-1479"><a href="#cb86-1479" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_nz_combine_pearson_lee)</span>
<span id="cb86-1480"><a href="#cb86-1480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1481"><a href="#cb86-1481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1482"><a href="#cb86-1482" aria-hidden="true" tabindex="-1"></a><span class="co"># combine data frames row-wise</span></span>
<span id="cb86-1483"><a href="#cb86-1483" aria-hidden="true" tabindex="-1"></a>df_nz_combine_pearson_lee_1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df_pearson_lee_2, df_nz_combine_pearson_lee)</span>
<span id="cb86-1484"><a href="#cb86-1484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1485"><a href="#cb86-1485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1486"><a href="#cb86-1486" aria-hidden="true" tabindex="-1"></a><span class="co"># look at data structure</span></span>
<span id="cb86-1487"><a href="#cb86-1487" aria-hidden="true" tabindex="-1"></a><span class="co">#dplyr::glimpse(df_nz_combine_pearson_lee_1)</span></span>
<span id="cb86-1488"><a href="#cb86-1488" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1489"><a href="#cb86-1489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1490"><a href="#cb86-1490" aria-hidden="true" tabindex="-1"></a>Look at heights in sample </span>
<span id="cb86-1491"><a href="#cb86-1491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1494"><a href="#cb86-1494" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1495"><a href="#cb86-1495" aria-hidden="true" tabindex="-1"></a><span class="co"># get min and max heights for graph range</span></span>
<span id="cb86-1496"><a href="#cb86-1496" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df_nz_combine_pearson_lee_1<span class="sc">$</span>year_is)</span>
<span id="cb86-1497"><a href="#cb86-1497" aria-hidden="true" tabindex="-1"></a><span class="co"># box plot</span></span>
<span id="cb86-1498"><a href="#cb86-1498" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span></span>
<span id="cb86-1499"><a href="#cb86-1499" aria-hidden="true" tabindex="-1"></a>                  df_nz_combine_pearson_lee_1,</span>
<span id="cb86-1500"><a href="#cb86-1500" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> year_is, <span class="at">y =</span> f_height, <span class="at">fill =</span> year_is)) <span class="sc">+</span></span>
<span id="cb86-1501"><a href="#cb86-1501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">notch =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb86-1502"><a href="#cb86-1502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Comparison of female height 1903/2019"</span>) <span class="sc">+</span></span>
<span id="cb86-1503"><a href="#cb86-1503" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">scale_fill_viridis_d</span>()</span>
<span id="cb86-1504"><a href="#cb86-1504" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1505"><a href="#cb86-1505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1506"><a href="#cb86-1506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1507"><a href="#cb86-1507" aria-hidden="true" tabindex="-1"></a>Predict heights out of sample</span>
<span id="cb86-1508"><a href="#cb86-1508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1511"><a href="#cb86-1511" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1512"><a href="#cb86-1512" aria-hidden="true" tabindex="-1"></a><span class="co"># regression model</span></span>
<span id="cb86-1513"><a href="#cb86-1513" aria-hidden="true" tabindex="-1"></a>fit_4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(f_height <span class="sc">~</span> year_is, <span class="at">data =</span> df_nz_combine_pearson_lee_1)</span>
<span id="cb86-1514"><a href="#cb86-1514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1515"><a href="#cb86-1515" aria-hidden="true" tabindex="-1"></a><span class="co"># table</span></span>
<span id="cb86-1516"><a href="#cb86-1516" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(fit_4)</span>
<span id="cb86-1517"><a href="#cb86-1517" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1518"><a href="#cb86-1518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1519"><a href="#cb86-1519" aria-hidden="true" tabindex="-1"></a>Women in 2019 are taller</span>
<span id="cb86-1520"><a href="#cb86-1520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1523"><a href="#cb86-1523" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1524"><a href="#cb86-1524" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(fit_4)</span>
<span id="cb86-1525"><a href="#cb86-1525" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1526"><a href="#cb86-1526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1527"><a href="#cb86-1527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1528"><a href="#cb86-1528" aria-hidden="true" tabindex="-1"></a>Graph:</span>
<span id="cb86-1529"><a href="#cb86-1529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1532"><a href="#cb86-1532" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1533"><a href="#cb86-1533" aria-hidden="true" tabindex="-1"></a><span class="co"># get meaningful values for the y access range</span></span>
<span id="cb86-1534"><a href="#cb86-1534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1535"><a href="#cb86-1535" aria-hidden="true" tabindex="-1"></a><span class="co"># min</span></span>
<span id="cb86-1536"><a href="#cb86-1536" aria-hidden="true" tabindex="-1"></a>min_mother_height_for_range <span class="ot">&lt;-</span> <span class="fu">min</span>(df_nz_combine_pearson_lee_1<span class="sc">$</span>f_height, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb86-1537"><a href="#cb86-1537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1538"><a href="#cb86-1538" aria-hidden="true" tabindex="-1"></a><span class="co"># max</span></span>
<span id="cb86-1539"><a href="#cb86-1539" aria-hidden="true" tabindex="-1"></a>max_mother_height_for_range <span class="ot">&lt;-</span> <span class="fu">max</span>(df_nz_combine_pearson_lee_1<span class="sc">$</span>f_height, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb86-1540"><a href="#cb86-1540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1541"><a href="#cb86-1541" aria-hidden="true" tabindex="-1"></a><span class="co"># make graph </span></span>
<span id="cb86-1542"><a href="#cb86-1542" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb86-1543"><a href="#cb86-1543" aria-hidden="true" tabindex="-1"></a>  ggeffects<span class="sc">::</span><span class="fu">ggpredict</span>(fit_4, <span class="at">terms =</span> <span class="st">"year_is"</span>),</span>
<span id="cb86-1544"><a href="#cb86-1544" aria-hidden="true" tabindex="-1"></a>  <span class="at">add.data =</span> F,</span>
<span id="cb86-1545"><a href="#cb86-1545" aria-hidden="true" tabindex="-1"></a>  <span class="at">dot.alpha =</span> .<span class="dv">2</span></span>
<span id="cb86-1546"><a href="#cb86-1546" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Predicted difference in female heights 1903/2019"</span>) <span class="sc">+</span> </span>
<span id="cb86-1547"><a href="#cb86-1547" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Study year"</span>) <span class="sc">+</span> </span>
<span id="cb86-1548"><a href="#cb86-1548" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span> (<span class="st">"Predicted femal height (inches)"</span>) <span class="sc">+</span>   <span class="fu">scale_y_continuous</span>(</span>
<span id="cb86-1549"><a href="#cb86-1549" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(min_mother_height_for_range,max_mother_height_for_range))</span>
<span id="cb86-1550"><a href="#cb86-1550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1551"><a href="#cb86-1551" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1552"><a href="#cb86-1552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1553"><a href="#cb86-1553" aria-hidden="true" tabindex="-1"></a>Graph with predicted points:</span>
<span id="cb86-1554"><a href="#cb86-1554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1557"><a href="#cb86-1557" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1558"><a href="#cb86-1558" aria-hidden="true" tabindex="-1"></a>ggeffects<span class="sc">::</span><span class="fu">ggpredict</span>(fit_4, <span class="at">terms =</span> <span class="st">"year_is"</span>)</span>
<span id="cb86-1559"><a href="#cb86-1559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1560"><a href="#cb86-1560" aria-hidden="true" tabindex="-1"></a><span class="co"># graph with predicted values based on the model</span></span>
<span id="cb86-1561"><a href="#cb86-1561" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb86-1562"><a href="#cb86-1562" aria-hidden="true" tabindex="-1"></a>  ggeffects<span class="sc">::</span><span class="fu">ggpredict</span>(fit_4, <span class="at">terms =</span> <span class="st">"year_is"</span>),</span>
<span id="cb86-1563"><a href="#cb86-1563" aria-hidden="true" tabindex="-1"></a>  <span class="at">add.data =</span> <span class="cn">TRUE</span>,</span>
<span id="cb86-1564"><a href="#cb86-1564" aria-hidden="true" tabindex="-1"></a>  <span class="at">dot.alpha =</span> .<span class="dv">01</span>,</span>
<span id="cb86-1565"><a href="#cb86-1565" aria-hidden="true" tabindex="-1"></a>   <span class="at">colors =</span> <span class="st">"us"</span>, <span class="co"># see colour pallet options </span></span>
<span id="cb86-1566"><a href="#cb86-1566" aria-hidden="true" tabindex="-1"></a>  <span class="at">jitter =</span>.<span class="dv">5</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Predicted difference in female heights 1903/2019"</span>) <span class="sc">+</span></span>
<span id="cb86-1567"><a href="#cb86-1567" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Study year"</span>) <span class="sc">+</span></span>
<span id="cb86-1568"><a href="#cb86-1568" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span> (<span class="st">"Predicted femal height (inches)"</span>) <span class="sc">+</span></span>
<span id="cb86-1569"><a href="#cb86-1569" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(min_mother_height_for_range, max_mother_height_for_range))</span>
<span id="cb86-1570"><a href="#cb86-1570" aria-hidden="true" tabindex="-1"></a>fit_4</span>
<span id="cb86-1571"><a href="#cb86-1571" aria-hidden="true" tabindex="-1"></a><span class="co"># show all color palettes</span></span>
<span id="cb86-1572"><a href="#cb86-1572" aria-hidden="true" tabindex="-1"></a><span class="co">#show_pals()</span></span>
<span id="cb86-1573"><a href="#cb86-1573" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1574"><a href="#cb86-1574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1575"><a href="#cb86-1575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1576"><a href="#cb86-1576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1577"><a href="#cb86-1577" aria-hidden="true" tabindex="-1"></a><span class="fu">## Appendix 1 Conceptual Background</span></span>
<span id="cb86-1578"><a href="#cb86-1578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1579"><a href="#cb86-1579" aria-hidden="true" tabindex="-1"></a>Some preliminaries about science.</span>
<span id="cb86-1580"><a href="#cb86-1580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1581"><a href="#cb86-1581" aria-hidden="true" tabindex="-1"></a><span class="fu">### Science begins with a question</span></span>
<span id="cb86-1582"><a href="#cb86-1582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1583"><a href="#cb86-1583" aria-hidden="true" tabindex="-1"></a>Science begins with a question about the world. The first step in science, then, is to clarify what you want to know.</span>
<span id="cb86-1584"><a href="#cb86-1584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1585"><a href="#cb86-1585" aria-hidden="true" tabindex="-1"></a>Because science is a social practice, you will also need to clarify why your question is interesting: so what?</span>
<span id="cb86-1586"><a href="#cb86-1586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1587"><a href="#cb86-1587" aria-hidden="true" tabindex="-1"></a>In short, know your question.</span>
<span id="cb86-1588"><a href="#cb86-1588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1589"><a href="#cb86-1589" aria-hidden="true" tabindex="-1"></a><span class="fu">### Scientific model (or theory)</span></span>
<span id="cb86-1590"><a href="#cb86-1590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1591"><a href="#cb86-1591" aria-hidden="true" tabindex="-1"></a>Sometimes, scientists are interested in specific features of the world: how did virus x originate? Such a question might have a forensic interest: what constellation of events gave rise to a novel infectious disease?</span>
<span id="cb86-1592"><a href="#cb86-1592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1593"><a href="#cb86-1593" aria-hidden="true" tabindex="-1"></a>Scientists typically seek generalisations. How do infectious diseases evolve? How do biological organisms evolve? Such questions have applied interests. How can we better prevent infectious diseases? How did life originate?</span>
<span id="cb86-1594"><a href="#cb86-1594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1595"><a href="#cb86-1595" aria-hidden="true" tabindex="-1"></a>A scientific model proposes how nature is structured (and unstructured). For example, the theory of evolution by natural selection proposes that life emerges from variation, inheritance, and differential reproduction/survival.</span>
<span id="cb86-1596"><a href="#cb86-1596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1597"><a href="#cb86-1597" aria-hidden="true" tabindex="-1"></a>To evaluate a scientific model, scientists must make generalisations beyond individual cases. This is where statistics shines.</span>
<span id="cb86-1598"><a href="#cb86-1598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1599"><a href="#cb86-1599" aria-hidden="true" tabindex="-1"></a><span class="fu">### What is statistics?</span></span>
<span id="cb86-1600"><a href="#cb86-1600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1601"><a href="#cb86-1601" aria-hidden="true" tabindex="-1"></a>Mathematics is a logic of certainty.</span>
<span id="cb86-1602"><a href="#cb86-1602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1603"><a href="#cb86-1603" aria-hidden="true" tabindex="-1"></a>Statistics is a logic of uncertainty.</span>
<span id="cb86-1604"><a href="#cb86-1604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1605"><a href="#cb86-1605" aria-hidden="true" tabindex="-1"></a>A statistical model uses the logic of probability to make better guesses.</span>
<span id="cb86-1606"><a href="#cb86-1606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1607"><a href="#cb86-1607" aria-hidden="true" tabindex="-1"></a><span class="fu">### Applications of statistical models in science</span></span>
<span id="cb86-1608"><a href="#cb86-1608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1609"><a href="#cb86-1609" aria-hidden="true" tabindex="-1"></a>Scientific models seek to explain how nature is structured. Where scientific models conflict, we can combine statistical models with data collection to evaluate the credibility of of one theoretical model over others. To do this, a scientific model must make distinct, non-trivial predictions about the world.</span>
<span id="cb86-1610"><a href="#cb86-1610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1611"><a href="#cb86-1611" aria-hidden="true" tabindex="-1"></a>If the predictions are not distinct, the observations will not enable a shift in credibility for one theory over another. Consider the theory that predicts any observation. Such a theory would be better classified as a conspiracy theory; it is compatible with any evidence.</span>
<span id="cb86-1612"><a href="#cb86-1612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1613"><a href="#cb86-1613" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Sometimes the processes of empirical testing is called "hypothesis testing." In the weeks ahead, we will distinguish the intellectually excellent concept of "hypothesis testing" from "Null Hypothesis Significance Testing (NHST)." Although there is is nothing inherently flawed with NHST, it's misunderstandings have been an abomination. --&gt;</span></span>
<span id="cb86-1614"><a href="#cb86-1614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1615"><a href="#cb86-1615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1616"><a href="#cb86-1616" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>
{
  "hash": "8780bccf9f0ad8ebbd1e8c68518656f6",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Causal Inference: Average (Marginal) Treatment Effects\"\ndate: \"2023-MAR-28\"\nbibliography: /Users/joseph/GIT/templates/bib/references.bib\neditor_options: \n  chunk_output_type: console\nformat:\n  html:\n    warnings: FALSE\n    error: FALSE\n    messages: FALSE\n    code-overflow: scroll\n    highlight-style: oblivion\n    code-tools:\n      source: true\n      toggle: FALSE\nhtml-math-method: katex\nreference-location: margin\ncitation-location: margin\ncap-location: margin\ncode-block-border-left: true\n---\n\n::: {.cell}\n\n:::\n\n\n\n\n::: {.callout-note}\n**Required**\n- [@hernan2024WHATIF] Chapters 1-3 [link](https://www.dropbox.com/scl/fi/9hy6xw1g1o4yz94ip8cvd/hernanrobins_WhatIf_2jan24.pdf?rlkey=8eaw6lqhmes7ddepuriwk5xk9&dl=0)\n\n\n**Optional**\n- [@neal2020introduction] Chapter 1-2 [link](https://www.dropbox.com/scl/fi/9hy6xw1g1o4yz94ip8cvd/hernanrobins_WhatIf_2jan24.pdf?rlkey=8eaw6lqhmes7ddepuriwk5xk9&dl=0)\n:::\n\n::: {.callout-important}\n## Key concepts for the test(s):\n  - **The Fundamental Problem of Causal Inference**\n  - **Causal Inference in Randomised Experiments**\n  - **Causal Inference in Observational Studies - Average (Marginal) Treatment Effects**\n  - **Three Fundamental Assumptions for Causal Inference**\n:::\n\n::: {.callout-important}\n## For the lab, copy and paste code chunks following the \"LAB 6\" section.\n:::\n\n\n# Seminar\n\n## Learning Outcomes\n\n- You will understand why causation is never directly observed.\n\n- You will understand how experiments address this \"causal gap.\"\n\n- You will understand how the application of three principles from experimental research allow human scientists to close this \"causal gap\" when making inferences about a population as whole -- that is, inferences about \"marginal effects.\"\n\n\n## Opening \n\n\nRobert Frost writes, \n\n> Two roads diverged in a yellow wood,\nAnd sorry I could not travel both\nAnd be one traveler, long I stood\nAnd looked down one as far as I could\nTo where it bent in the undergrowth;\n\n>Then took the other, as just as fair,\nAnd having perhaps the better claim,\nBecause it was grassy and wanted wear;\nThough as for that the passing there\nHad worn them really about the same,\n\n>And both that morning equally lay\nIn leaves no step had trodden black.\nOh, I kept the first for another day!\nYet knowing how way leads on to way,\nI doubted if I should ever come back.\n\n>I shall be telling this with a sigh\nSomewhere ages and ages hence:\nTwo roads diverged in a wood, and I—\nI took the one less traveled by,\nAnd that has made all the difference. \n-- The Road Not Taken\n\n\nAt the heart of Frost's poem is the sad poignancy:\n\n**“And sorry I could not travel both. And be one traveller$\\dots$”**  \n\n\n## Introduction: Motivating Example\n\nConsider the following cross-cultural question: \n\n> Does bilingualism improve cognitive abilities in children? \n\nThere is evidence that bilingual children perform better oat cognitive tasks, but is learning more than one language a confounding factor? \n\nHow can we know?  Each child might respond as the traveller in Frost's poem:\n\n\"And sorry I could not travel both. And be one traveller$\\dots$\"\n\n\n## Part 1: The Fundamental Problem of Causal Inference as a Missing Data Problem \n\nHumans think in images, words, and songs -- sometimes dance. I believe that every inclination to write out ideas in math should be presumed guilty until proven innocent.\n\nHowever, I have found that a little mathematical notation helps to clarify the concepts.\n\nTo understand the fundamental problem of causal inference, we first define two potential outcomes for each individual in our study:\n\nLet $Y$ and $A$ denote random variables. Mathmatically, we formulate a causal question by asking whether assigment to treatment $A = a$ will lead to a difference to the outcome $Y$.  \n\nLet $A = 1$ denote getting the \"bilingual\" treatment, and $A = 0$ denote getting the monolingual treatment. Assume these are the only two treatments of interest. \n\n- $Y_i(a = 1)$ The cognitive ability of child $i$ if they were bilingual. This is the counterfactual outcome when treatement $A = (a  =  1)$.\n\n- $Y_i(a = 0)$:: The cognitive ability of child $i$ if they were monolingual. This is the counterfactual outcome when $A = (a = 0)$.\n\nUsing this notation, we may define a quantitative causal effect of bilingualism on cognitive ability for individual $i$ as the difference between these potential outcomes:\n\n\n$$\n\\text{Causal Effect}_i = Y_i(1) - Y_i(0)\n$$\n\nWe say there is a causal effect if: \n\n$$\nY_i(1) - Y_i(0)  \\neq 0\n$$\n\nWriting out our contrast of interest this way makes it clear that we cannot compute this contrast directly from any data we may observe because individuals experience only **one** treatment condition:\n\n$$\nY_i|A_i = 1 \\implies Y_i(0)|A_i = 1~ \\text{is counterfactual}\n$$\nand:\n\n\n$$\nY_i|A_i = 0 \\implies Y_i(1)|A_i = 1~ \\text{is counterfactual}\n$$\n\n\n::: footer\n\"**And sorry I could not travel both. And be one traveller, long I stood** $\\dots$\"\n:::\n\n\n\n### Average Treatment Effect in randomised controlled experiments work from assumptions\n\n\n\n$$\n\\text{Average Treatment Effect} = \\left[ \\begin{aligned}\n&\\left( \\underbrace{\\mathbb{E}[Y(1)|A = 1]}_{\\text{observed}} + \\textcolor{cyan}{\\underbrace{\\mathbb{E}[Y(1)|A = 0]}_{\\text{unobserved}}} \\right) \\\\\n&- \\left( \\underbrace{\\mathbb{E}[Y(0)|A = 0]}_{\\text{observed}} + \\textcolor{cyan}{\\underbrace{\\mathbb{E}[Y(0)|A = 1]}_{\\text{unobserved}}} \\right)\n\\end{aligned} \\right]\n$$\n\n\nIn this expression, $\\mathbb{E}[Y(1)|A = 1]$ represents the average outcome when the treatment is given, which is observable. However, $\\mathbb{E}[Y(1)|A = 0]$ represents the average outcome if the treatment had been given to those who were untreated, which remains unobservable. Similarly, the quantity $\\mathbb{E}[Y(0)|A = 1]$ also remains unobservable.  Note that the problem isn't merely one of statistical analysis on the data. **The problem is that the relevant data to identify individual causal effects are missing.** Thus, it is evident that the fundamental problem of causal inference is an ever-present concern even in experiments!\n\nAll the data we require for invidual causal inferences are missing, nevertheless, because the treatments have been randomised, the data we observe from randomised controlled experiments can allow us to infer what would happen, **on average** if the treatment were applied to the population from which the participants were sampled. \n\nWe may call this causal affect the \"Average Treatment Effect\" or equivalently, the \"Marginal Effect of the Treatment.\" \n\n\n### How do We Obtain Average Treatment Effects From Non-Randomised Observational Data?\n\nUnder stronger assumptions, we may sometimes infer causal effects from associations in data, even if the treatment variable $A$ has not been randomised. \n\n\n$$\n\\text{ATE} = \\sum_{l} \\left( \\mathbb{E}[Y|A=1, \\textcolor{cyan}{L=l}] - \\mathbb{E}[Y|A=0, \\textcolor{cyan}{L=l}] \\right) \\times \\textcolor{cyan}{\\Pr(L=l)}\n$$\n\nWhere $L$ denotes the set of measured covariates such that $A\\coprod Y(a)|L$\n\n\n\n\n\n#### Focus\n- Application of regression and simulation in R for ATE estimation\n\n\n  \n## Overview\n  \n  \n  \n## Notes\n\nConsider that in the causal inference literature, we may write this contrast two potential outcomes under treatment as:\n\n\n$$\n\\text{Causal Effect}_i = Y_i^{a=1} - Y_i^{a=0} \n$$\n\nor\n\n$$\n\\text{Causal Effect}_i = Y_i^{1} - Y_i^{0} \n$$\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}